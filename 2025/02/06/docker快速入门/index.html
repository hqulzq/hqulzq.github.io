<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"hqulzq.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Docker概述Docker为什么出现 一款产品从开发到上线，从操作系统，到运行环境，再到应用配置。作为开发+运维之间的协作我们需要关心很多东西，这也是很多互联网公司都不得不面对的问题，特别是各种版本的迭代之后，不同版本环境的兼容，对运维人员是极大的考验！环境配置如此麻烦，换一台机器，就要重来一次，费力费时。很多人想到，能不能从根本上解决问题，软件可以带环境安装？也就是说，安装的时候，把原始环境一">
<meta property="og:type" content="article">
<meta property="og:title" content="docker快速入门">
<meta property="og:url" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/index.html">
<meta property="og:site_name" content="Lzq&#39;s blog">
<meta property="og:description" content="Docker概述Docker为什么出现 一款产品从开发到上线，从操作系统，到运行环境，再到应用配置。作为开发+运维之间的协作我们需要关心很多东西，这也是很多互联网公司都不得不面对的问题，特别是各种版本的迭代之后，不同版本环境的兼容，对运维人员是极大的考验！环境配置如此麻烦，换一台机器，就要重来一次，费力费时。很多人想到，能不能从根本上解决问题，软件可以带环境安装？也就是说，安装的时候，把原始环境一">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719141143.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719141816.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719141955.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719142742.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719144333.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719144512.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719144738.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719144822.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719145020.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719165346.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719172742.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719173804.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719173821.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719173908.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719174045.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719174107.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719174629.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719175444.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719175635.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719180003.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719180119.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719181004.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719181033.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719181118.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719181842.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719182127.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720092847.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720092859.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720093327.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720094253.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720094323.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720094815.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720095101.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720095139.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720095244.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720100037.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720100126.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720101049.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720101217.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720101259.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720101311.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720101427.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720101724.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720101741.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720101802.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720101824.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720101845.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720101953.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720102036.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720102953.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720103853.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720104149.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720104443.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720104548.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720104920.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720105221.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720105609.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720110400.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720110711.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210720110736.png">
<meta property="article:published_time" content="2025-02-06T02:21:28.000Z">
<meta property="article:modified_time" content="2025-02-27T02:37:03.561Z">
<meta property="article:author" content="Zongqing Li">
<meta property="article:tag" content="快速入门">
<meta property="article:tag" content="docker">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/QQ%E6%88%AA%E5%9B%BE20210719141143.png">

<link rel="canonical" href="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>docker快速入门 | Lzq's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Lzq's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">31</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">12</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">41</span></a>

  </li>
        <li class="menu-item menu-item-book">

    <a href="/book" rel="section"><i class="fas fa-book fa-fw"></i>Book</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://hqulzq.github.io/2025/02/06/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://github.com/hqulzq/hqulzq.github.io/blob/main/images/userimg.jpg?raw=true">
      <meta itemprop="name" content="Zongqing Li">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lzq's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          docker快速入门
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-02-06 10:21:28" itemprop="dateCreated datePublished" datetime="2025-02-06T10:21:28+08:00">2025-02-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-02-27 10:37:03" itemprop="dateModified" datetime="2025-02-27T10:37:03+08:00">2025-02-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AE%B9%E5%99%A8/" itemprop="url" rel="index"><span itemprop="name">容器</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="Docker概述"><a href="#Docker概述" class="headerlink" title="Docker概述"></a>Docker概述</h1><h2 id="Docker为什么出现"><a href="#Docker为什么出现" class="headerlink" title="Docker为什么出现"></a>Docker为什么出现</h2><blockquote>
<p>一款产品从开发到上线，从操作系统，到运行环境，再到应用配置。作为开发+运维之间的协作我们需要关心很多东西，这也是很多互联网公司都不得不面对的问题，特别是各种版本的迭代之后，不同版本环境的兼容，对运维人员是极大的考验！<br>环境配置如此麻烦，换一台机器，就要重来一次，费力费时。很多人想到，能不能从根本上解决问题，软件可以带环境安装？也就是说，安装的时候，把原始环境一模一样地复制过来。解决开发人员说的“ 在我的机器上可正常工作”的问题。<br>之前在服务器配置一个应用的运行环境，要安装各种软件，就拿一个基本的工程项目的环境来说吧，Java/Tomcat/MySQL/JDBC驱动包等。安装和配置这些东西有多麻烦就不说了，它还不能跨平台。假如我们是在 Windows 上安装的这些环境，到了 Linux 又得重新装。况且就算不跨操作系统，换另一台同<br>样操作系统的服务器，要移植应用也是非常麻烦的。<br>传统上认为，软件编码开发/测试结束后，所产出的成果即是程序或是能够编译执行的二进制字节码文件等（Java为例）。而为了让这些程序可以顺利执行，开发团队也得准备完整的部署文件，让维运团队得以部署应用程式，开发需要清楚的告诉运维部署团队，用的全部配置文件+所有软件环境。不过，即便如此，仍然常常发生部署失败的状况。<br>Docker之所以发展如此迅速，也是因为它对此给出了一个标准化的解决方案。Docker镜像的设计，使得Docker得以打破过去「程序即应用」的观念。通过Docker镜像 ( images ) 将应用程序所需要的系统环境，由下而上打包，达到应用程序跨平台间的无缝接轨运作。<br><span id="more"></span><br><img src="QQ截图20210719141143.png" alt="输入图片说明"></p>
<p>Docker的思想来自于集装箱，集装箱解决了什么问题？在一艘大船上，可以把货物规整的摆放起来。并且各种各样的货物被集装箱标准化了，集装箱和集装箱之间不会互相影响。那么我就不需要专门运送水果的船和专门运送化学品的船了。只要这些货物在集装箱里封装的好好的，那我就可以用一艘大船把他们都运走。</p>
</blockquote>
<h3 id="历史"><a href="#历史" class="headerlink" title="历史"></a>历史</h3><blockquote>
<p>2010年，几个搞IT的年轻人，在美国旧金山成立了一家名叫“dotCloud”的公司。这家公司主要提供基于PaaS的云计算技术服务。具体来说，是和LXC有关的容器技术。后来，dotCloud公司将自己的容器技术进行了简化和标准化，并命名为——Docker。Docker技术诞生之后，并没有引起行业的关注。而dotCloud公司，作为一家小型创业企业，在激烈的竞争之下，也步履维艰。正当他们快要坚持不下去的时候，脑子里蹦出了“开源”的想法。<br>什么是“开源”？开源，就是开放源代码。也就是将原来内部保密的程序源代码开放给所有人，然后让大家一起参与进来，贡献代码和意见。有的软件是一开始就开源的。也有的软件，是混不下去，创造者又不想放弃，所以选择开源。自己养不活，就吃“百家饭”嘛。<br>2013年3月，dotCloud公司的创始人之一，Docker之父，28岁的Solomon Hykes正式决定，将Docker项目开源。不开则已，一开惊人。越来越多的IT工程师发现了Docker的优点，然后蜂拥而至，加入Docker开源社区。Docker的人气迅速攀升，速度之快，令人瞠目结舌。<br>开源当月，Docker 0.1 版本发布。此后的每一个月，Docker都会发布一个版本。到2014年6月9日，Docker 1.0 版本正式发布。此时的Docker，已经成为行业里人气最火爆的开源技术，没有之一。甚至像Google、微软、Amazon、VMware这样的巨头，都对它青睐有加，表示将全力支持。<br>Docker和容器技术为什么会这么火爆？说白了，就是因为它“轻”。在容器技术之前，业界的网红是虚拟机。虚拟机技术的代表，是VMWare和OpenStack。相信很多人都用过虚拟机。虚拟机，就是在你的操作系统里面，装一个软件，然后通过这个软件，再模拟一台甚至多台“子电脑”出来。在“子电脑”里，你可以和正常电脑一样运行程序，例如开QQ。如果你愿意，你可以变出好几个“子电脑”，里面都开上QQ。“子电脑”和“子电脑”之间，是相互隔离的，互不影响。虚拟机属于虚拟化技术。而Docker这样的容器技术，也是虚拟化技术，属于轻量级的虚拟化。虚拟机虽然可以隔离出很多“子电脑”，但占用空间更大，启动更慢，虚拟机软件可能还要花钱（例如VMWare）。而容器技术恰好没有这些缺点。它不需要虚拟出整个操作系统，只需要虚拟一个小规模的环境（类似“沙 箱”）。它启动时间很快，几秒钟就能完成。而且，它对资源的利用率很高（一台主机可以同时运行几千个<br>Docker容器）。此外，它占的空间很小，虚拟机一般要几GB到几十GB的空间，而容器只需要MB级甚至KB级。<br>正因为如此，容器技术受到了热烈的欢迎和追捧，发展迅速。</p>
</blockquote>
<h3 id="docker-理念"><a href="#docker-理念" class="headerlink" title="docker 理念"></a>docker 理念</h3><blockquote>
<p>Docker是基于Go语言实现的云开源项目。<br>Docker的主要目标是“Build，Ship and Run Any App , Anywhere”，也就是通过对应用组件的封装、分发、部署、运行等生命周期的管理，使用户的APP（可以是一个WEB应用或数据库应用等等）及其运行环境能够做到“一次封装，到处运行”。<br>Linux 容器技术的出现就解决了这样一个问题，而 Docker 就是在它的基础上发展过来的。将应用运行在Docker 容器上面，而 Docker 容器在任何操作系统上都是一致的，这就实现了跨平台、跨服务器。只需要一次配置好环境，换到别的机子上就可以一键部署好，大大简化了操作。</p>
</blockquote>
<h2 id="Docker能干嘛"><a href="#Docker能干嘛" class="headerlink" title="Docker能干嘛"></a>Docker能干嘛</h2><h3 id="之前的虚拟机技术"><a href="#之前的虚拟机技术" class="headerlink" title="之前的虚拟机技术"></a>之前的虚拟机技术</h3><blockquote>
<p>虚拟机（virtual machine）就是带环境安装的一种解决方案。它可以在一种操作系统里面运行另一种操作系统，比如在Windows 系统里面运行Linux 系统。应用程序对此毫无感知，因为虚拟机看上去跟真实系统一模一样，而对于底层系统来说，虚拟机就是一个普通文件，不需要了就删掉，对其他部分毫无影响。这类虚拟机完美的运行了另一套系统，能够使应用程序，操作系统和硬件三者之间的逻辑不变。</p>
</blockquote>
<p>  <img src="QQ截图20210719141816.png" alt="输入图片说明"></p>
<ul>
<li>虚拟机的缺点：<ul>
<li>1 、资源占用多</li>
<li>2 、冗余步骤多</li>
<li>3 、启动慢</li>
</ul>
</li>
</ul>
<h3 id="容器虚拟化技术"><a href="#容器虚拟化技术" class="headerlink" title="容器虚拟化技术"></a>容器虚拟化技术</h3><blockquote>
<p>由于前面虚拟机存在这些缺点，Linux 发展出了另一种虚拟化技术：Linux 容器（Linux Containers，缩写为 LXC）。<br>Linux 容器不是模拟一个完整的操作系统，而是对进程进行隔离。有了容器，就可以将软件运行所需的所有资源打包到一个隔离的容器中。容器与虚拟机不同，不需要捆绑一整套操作系统，只需要软件工作所需的库资源和设置。系统因此而变得高效轻量并保证部署在任何环境中的软件都能始终如一地运行。<br><br>  <img src="QQ截图20210719141955.png" alt="输入图片说明"><br></p>
</blockquote>
<p>比较了 Docker 和传统虚拟化方式的不同之处：<br>&gt;</p>
<blockquote>
<ul>
<li>传统虚拟机技术是虚拟出一套硬件后，在其上运行一个完整操作系统，在该系统上再运行所需应用进程；</li>
<li>而容器内的应用进程直接运行于宿主的内核，容器内没有自己的内核，而且也没有进行硬件虚拟。因此容器要比传统虚拟机更为轻便。</li>
<li>每个容器之间互相隔离，每个容器有自己的文件系统 ，容器之间进程不会相互影响，能区分计算资源。</li>
</ul>
</blockquote>
<h3 id="开发-运维（DevOps）"><a href="#开发-运维（DevOps）" class="headerlink" title="开发/运维（DevOps）"></a>开发/运维（DevOps）</h3><h4 id="更快速的应用交付和部署"><a href="#更快速的应用交付和部署" class="headerlink" title="更快速的应用交付和部署"></a>更快速的应用交付和部署</h4><p>&gt;</p>
<blockquote>
<p>传统的应用开发完成后，需要提供一堆安装程序和配置说明文档，安装部署后需根据配置文档进行繁杂的配置才能正常运行。Docker化之后只需要交付少量容器镜像文件，在正式生产环境加载镜像并运行即可，应用安装配置在镜像里已经内置好，大大节省部署配置和测试验证时间。</p>
</blockquote>
<h4 id="更便捷的升级和扩缩容"><a href="#更便捷的升级和扩缩容" class="headerlink" title="更便捷的升级和扩缩容"></a>更便捷的升级和扩缩容</h4><p>&gt;</p>
<blockquote>
<p>随着微服务架构和Docker的发展，大量的应用会通过微服务方式架构，应用的开发构建将变成搭乐高积木一样，每个Docker容器将变成一块“积木”，应用的升级将变得非常容易。当现有的容器不足以支撑业务处理时，可通过镜像运行新的容器进行快速扩容，使应用系统的扩容从原先的天级变成分钟级甚至秒级。</p>
</blockquote>
<h4 id="更简单的系统运维"><a href="#更简单的系统运维" class="headerlink" title="更简单的系统运维"></a>更简单的系统运维</h4><p>&gt;</p>
<blockquote>
<p>应用容器化运行后，生产环境运行的应用可与开发、测试环境的应用高度一致，容器会将应用程序相关的环境和状态完全封装起来，不会因为底层基础架构和操作系统的不一致性给应用带来影响，产生新的BUG。当出现程序异常时，也可以通过测试环境的相同容器进行快速定位和修复。</p>
</blockquote>
<h4 id="更高效的计算资源利用"><a href="#更高效的计算资源利用" class="headerlink" title="更高效的计算资源利用"></a>更高效的计算资源利用</h4><p>&gt;</p>
<blockquote>
<p>Docker是内核级虚拟化，其不像传统的虚拟化技术一样需要额外的Hypervisor [管理程序] 支持，所以在一台物理机上可以运行很多个容器实例，可大大提升物理服务器的CPU和内存的利用率。</p>
</blockquote>
<h3 id="学习途径"><a href="#学习途径" class="headerlink" title="学习途径"></a>学习途径</h3><p>Docker官网：<a target="_blank" rel="noopener" href="http://www.docker.com">http://www.docker.com</a></p>
<p>Docker中文网站：<a target="_blank" rel="noopener" href="https://www.docker-cn.com">https://www.docker-cn.com</a></p>
<p>Docker Hub官网：<a target="_blank" rel="noopener" href="https://hub.docker.com">https://hub.docker.com</a> （仓库）</p>
<p>还是我那句话，只要学不死，就往死里学！</p>
<h1 id="Docker安装"><a href="#Docker安装" class="headerlink" title="Docker安装"></a>Docker安装</h1><h2 id="Docker的基本组成"><a href="#Docker的基本组成" class="headerlink" title="Docker的基本组成"></a>Docker的基本组成</h2><h3 id="Docker的架构图"><a href="#Docker的架构图" class="headerlink" title="Docker的架构图"></a>Docker的架构图</h3><p>  <img src="QQ截图20210719142742.png" alt="输入图片说明"></p>
<h3 id="镜像（image）"><a href="#镜像（image）" class="headerlink" title="镜像（image）"></a>镜像（image）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Docker 镜像（Image）就是一个只读的模板。镜像可以用来创建 Docker 容器，一个镜像可以创建很 多容器。 就好似 Java 中的 类和对象，类就是镜像，容器就是对象！</span><br></pre></td></tr></table></figure>
<h3 id="容器（container）"><a href="#容器（container）" class="headerlink" title="容器（container）"></a>容器（container）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Docker 利用容器（Container）独立运行的一个或一组应用。容器是用镜像创建的运行实例。 </span><br><span class="line">它可以被启动、开始、停止、删除。每个容器都是相互隔离的，保证安全的平台。 </span><br><span class="line">可以把容器看做是一个简易版的 Linux 环境（包括root用户权限、进程空间、用户空间和网络空间等） 和运行在其中的应用程序。。 </span><br><span class="line">容器的定义和镜像几乎一模一样，也是一堆层的统一视角，唯一区别在于容器的最上面那一层是可读可写 的。</span><br></pre></td></tr></table></figure>
<h3 id="仓库（repository）"><a href="#仓库（repository）" class="headerlink" title="仓库（repository）"></a>仓库（repository）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">仓库（Repository）是集中存放镜像文件的场所。 </span><br><span class="line">仓库(Repository)和仓库注册服务器（Registry）是有区别的。仓库注册服务器上往往存放着多个仓 库，每个仓库中又包含了多个镜像，每个镜像有不同的标签（tag）。 </span><br><span class="line">仓库分为公开仓库（Public）和私有仓库（Private）两种形式。 </span><br><span class="line">最大的公开仓库是 Docker Hub(https://hub.docker.com/)，存放了数量庞大的镜像供用户下载。 </span><br><span class="line">国内的公开仓库包括阿里云 、网易云 等 12345678</span><br></pre></td></tr></table></figure>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><ul>
<li>Docker 本身是一个容器运行载体或称之为管理引擎。我们把应用程序和配置依赖打包好形成一个<br>可交付的运行环境，这个打包好的运行环境就似乎 image镜像文件。只有通过这个镜像文件才能生<br>成 Docker 容器。image 文件可以看作是容器的模板。Docker 根据 image 文件生成容器的实例。<br>同一个 image 文件，可以生成多个同时运行的容器实例。</li>
<li>image 文件生成的容器实例，本身也是一个文件，称为镜像文件。</li>
<li>一个容器运行一种服务，当我们需要的时候，就可以通过docker客户端创建一个对应的运行实例，<br>也就是我们的容器</li>
<li>至于仓库，就是放了一堆镜像的地方，我们可以把镜像发布到仓库中，需要的时候从仓库中拉下来<br>就可以了。</li>
</ul>
<h2 id="环境说明"><a href="#环境说明" class="headerlink" title="环境说明"></a>环境说明</h2><blockquote>
<p>我们使用的是 CentOS 7 (64-bit)<br>目前，CentOS 仅发行版本中的内核支持 Docker。<br>Docker 运行在 CentOS 7 上，要求系统为64位、系统内核版本为 3.10 以上。</p>
</blockquote>
<h3 id="查看自己的内核"><a href="#查看自己的内核" class="headerlink" title="查看自己的内核"></a>查看自己的内核</h3><p>uname -r 命令用于打印当前系统相关信息（内核版本号、硬件架构、主机名称和操作系统类型</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@kuangshen ~]# uname -r </span><br><span class="line">3.10.0-1062.12.1.el7.x86_64</span><br></pre></td></tr></table></figure>
<h3 id="查看版本信息"><a href="#查看版本信息" class="headerlink" title="查看版本信息"></a>查看版本信息</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/os-release</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@kuangshen ~]# cat /etc/os-release </span><br><span class="line">NAME=&quot;CentOS Linux&quot; </span><br><span class="line">VERSION=&quot;7 (Core)&quot; </span><br><span class="line">ID=&quot;centos&quot; </span><br><span class="line">ID_LIKE=&quot;rhel fedora&quot; </span><br><span class="line">VERSION_ID=&quot;7&quot; </span><br><span class="line">PRETTY_NAME=&quot;CentOS Linux 7 (Core)&quot; </span><br><span class="line">ANSI_COLOR=&quot;0;31&quot; </span><br><span class="line">CPE_NAME=&quot;cpe:/o:centos:centos:7&quot; </span><br><span class="line">HOME_URL=&quot;https://www.centos.org/&quot; </span><br><span class="line">BUG_REPORT_URL=&quot;https://bugs.centos.org/&quot; </span><br><span class="line">CENTOS_MANTISBT_PROJECT=&quot;CentOS-7&quot; </span><br><span class="line">CENTOS_MANTISBT_PROJECT_VERSION=&quot;7&quot; </span><br><span class="line">REDHAT_SUPPORT_PRODUCT=&quot;centos&quot; </span><br><span class="line">REDHAT_SUPPORT_PRODUCT_VERSION=&quot;7&quot;</span><br></pre></td></tr></table></figure>
<h2 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h2><h3 id="1、官网安装参考手册：https-docs-docker-com-engine-install-centos"><a href="#1、官网安装参考手册：https-docs-docker-com-engine-install-centos" class="headerlink" title="1、官网安装参考手册：https://docs.docker.com/engine/install/centos/ "></a>1、官网安装参考手册：<a target="_blank" rel="noopener" href="https://docs.docker.com/engine/install/centos/">https://docs.docker.com/engine/install/centos/</a> <br></h3><h3 id="2、确定你是CentOS7及以上版本，我们已经做过了"><a href="#2、确定你是CentOS7及以上版本，我们已经做过了" class="headerlink" title="2、确定你是CentOS7及以上版本，我们已经做过了"></a>2、确定你是CentOS7及以上版本，我们已经做过了<br></h3><h3 id="3、yum安装gcc相关环境（需要确保-虚拟机可以上外网-）"><a href="#3、yum安装gcc相关环境（需要确保-虚拟机可以上外网-）" class="headerlink" title="3、yum安装gcc相关环境（需要确保 虚拟机可以上外网 ）"></a>3、yum安装gcc相关环境（需要确保 虚拟机可以上外网 ）<br></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc </span><br><span class="line">yum -y install gcc-c++</span><br></pre></td></tr></table></figure>
<h3 id="4-、卸载旧版本"><a href="#4-、卸载旧版本" class="headerlink" title="4 、卸载旧版本"></a>4 、卸载旧版本</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">yum remove docker \</span><br><span class="line">                docker-client \ </span><br><span class="line">                docker-client-latest \ </span><br><span class="line">                docker-common \ </span><br><span class="line">                docker-latest \ </span><br><span class="line">                docker-latest-logrotate \ </span><br><span class="line">                docker-logrotate \ </span><br><span class="line">                docker-engine</span><br></pre></td></tr></table></figure>
<h3 id="5-、安装需要的软件包"><a href="#5-、安装需要的软件包" class="headerlink" title="5 、安装需要的软件包"></a>5 、安装需要的软件包</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y yum-utils</span><br></pre></td></tr></table></figure>
<h3 id="6-、设置镜像仓库"><a href="#6-、设置镜像仓库" class="headerlink" title="6 、设置镜像仓库"></a>6 、设置镜像仓库</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 错误 </span><br><span class="line">yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo </span><br><span class="line">## 报错 </span><br><span class="line">[Errno 14] curl#35 - TCP connection reset by peer </span><br><span class="line">[Errno 12] curl#35 - Timeout </span><br><span class="line"></span><br><span class="line"># 正确推荐使用国内的 </span><br><span class="line">yum-config-manager --add-repo http://mirrors.aliyun.com/docker- ce/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure>
<h3 id="7-、更新yum软件包索引"><a href="#7-、更新yum软件包索引" class="headerlink" title="7 、更新yum软件包索引"></a>7 、更新yum软件包索引</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum makecache fast</span><br></pre></td></tr></table></figure>
<h3 id="8-、安装-Docker-CE"><a href="#8-、安装-Docker-CE" class="headerlink" title="8 、安装 Docker CE"></a>8 、安装 Docker CE</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure>
<h3 id="9-、启动-Docker"><a href="#9-、启动-Docker" class="headerlink" title="9 、启动 Docker"></a>9 、启动 Docker</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start docker</span><br></pre></td></tr></table></figure>
<h3 id="10-、测试命令"><a href="#10-、测试命令" class="headerlink" title="10 、测试命令"></a>10 、测试命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker version </span><br><span class="line">docker run hello-world </span><br><span class="line">docker images</span><br></pre></td></tr></table></figure>
<p>  <img src="QQ截图20210719144333.png" alt="输入图片说明"></p>
<h3 id="11-、卸载"><a href="#11-、卸载" class="headerlink" title="11 、卸载"></a>11 、卸载</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop docker </span><br><span class="line">yum -y remove docker-ce docker-ce-cli containerd.io </span><br><span class="line">rm -rf /var/lib/docker</span><br></pre></td></tr></table></figure>
<h2 id="阿里云镜像加速"><a href="#阿里云镜像加速" class="headerlink" title="阿里云镜像加速"></a>阿里云镜像加速</h2><h3 id="1-、介绍：https-www-aliyun-com-product-acr"><a href="#1-、介绍：https-www-aliyun-com-product-acr" class="headerlink" title="1 、介绍：https://www.aliyun.com/product/acr"></a>1 、介绍：<a target="_blank" rel="noopener" href="https://www.aliyun.com/product/acr">https://www.aliyun.com/product/acr</a></h3><h3 id="2-、注册一个属于自己的阿里云账户-可复用淘宝账号"><a href="#2-、注册一个属于自己的阿里云账户-可复用淘宝账号" class="headerlink" title="2 、注册一个属于自己的阿里云账户(可复用淘宝账号)"></a>2 、注册一个属于自己的阿里云账户(可复用淘宝账号)</h3><h3 id="3-、进入管理控制台设置密码，开通"><a href="#3-、进入管理控制台设置密码，开通" class="headerlink" title="3 、进入管理控制台设置密码，开通"></a>3 、进入管理控制台设置密码，开通</h3><h3 id="4-、查看镜像加速器自己的"><a href="#4-、查看镜像加速器自己的" class="headerlink" title="4 、查看镜像加速器自己的"></a>4 、查看镜像加速器自己的</h3><p>  <img src="QQ截图20210719144512.png" alt="输入图片说明"></p>
<h3 id="5-、配置镜像加速"><a href="#5-、配置镜像加速" class="headerlink" title="5 、配置镜像加速"></a>5 、配置镜像加速</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir -p /etc/docker </span><br><span class="line">sudo tee /etc/docker/daemon.json &lt;&lt;-&#x27;EOF&#x27; </span><br><span class="line">&#123; </span><br><span class="line">    &quot;registry-mirrors&quot;: [&quot;https://qiyb9988.mirror.aliyuncs.com&quot;] </span><br><span class="line">&#125;</span><br><span class="line">EOF </span><br><span class="line"></span><br><span class="line">sudo systemctl daemon-reload </span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure>
<h3 id="测试-HelloWorld"><a href="#测试-HelloWorld" class="headerlink" title="测试 HelloWorld"></a>测试 HelloWorld</h3><h3 id="1-、启动hello-world"><a href="#1-、启动hello-world" class="headerlink" title="1 、启动hello-world"></a>1 、启动hello-world</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run hello-world</span><br></pre></td></tr></table></figure>
<h3 id="2-、run干了什么？"><a href="#2-、run干了什么？" class="headerlink" title="2 、run干了什么？"></a>2 、run干了什么？</h3><p>  <img src="QQ截图20210719144738.png" alt="输入图片说明"></p>
<h2 id="底层原理"><a href="#底层原理" class="headerlink" title="底层原理"></a>底层原理</h2><h3 id="Docker是怎么工作的"><a href="#Docker是怎么工作的" class="headerlink" title="Docker是怎么工作的"></a>Docker是怎么工作的</h3><blockquote>
<p>Docker是一个Client-Server结构的系统，Docker守护进程运行在主机上， 然后通过Socket连接从客户<br>端访问，守护进程从客户端接受命令并管理运行在主机上的容器。 容器，是一个运行时环境，就是我们<br>前面说到的集装箱。</p>
</blockquote>
<p>  <img src="QQ截图20210719144822.png" alt="输入图片说明"></p>
<h3 id="为什么Docker比较-VM-快"><a href="#为什么Docker比较-VM-快" class="headerlink" title="为什么Docker比较 VM 快"></a>为什么Docker比较 VM 快</h3><p>1、docker有着比虚拟机更少的抽象层。由亍docker不需要Hypervisor实现硬件资源虚拟化,运行在<br>docker容器上的程序直接使用的都是实际物理机的硬件资源。因此在CPU、内存利用率上docker将会在<br>效率上有明显优势。</p>
<p>2、docker利用的是宿主机的内核,而不需要Guest OS。因此,当新建一个容器时,docker不需要和虚拟机<br>一样重新加载一个操作系统内核。仍而避免引寻、加载操作系统内核返个比较费时费资源的过程,当新建<br>一个虚拟机时,虚拟机软件需要加载Guest OS,返个新建过程是分钟级别的。而docker由于直接利用宿主<br>机的操作系统,则省略了返个过程,因此新建一个docker容器只需要几秒钟。<br>  <img src="QQ截图20210719145020.png" alt="输入图片说明"></p>
<h1 id="Docker常用命令"><a href="#Docker常用命令" class="headerlink" title="Docker常用命令"></a>Docker常用命令</h1><h2 id="帮助命令"><a href="#帮助命令" class="headerlink" title="帮助命令"></a>帮助命令</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker version # 显示 Docker 版本信息。</span><br><span class="line">docker info  # 显示 Docker 系统信息，包括镜像和容器数。。</span><br><span class="line">docker --help # 帮助</span><br></pre></td></tr></table></figure>
<h2 id="镜像命令"><a href="#镜像命令" class="headerlink" title="镜像命令"></a>镜像命令</h2><h3 id="docker-images"><a href="#docker-images" class="headerlink" title="docker images"></a>docker images</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">列出本地主机上的镜像</span> </span><br><span class="line">[root@kuangshen ~]# docker images </span><br><span class="line">REPOSITORY   TAG     IMAGE ID      CREATED SIZE </span><br><span class="line">hello-world latest bf756fb1ae65 4 months ago 13.3kB </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">解释</span> </span><br><span class="line">REPOSITORY 镜像的仓库源 </span><br><span class="line">TAG 镜像的标签 </span><br><span class="line">IMAGE ID 镜像的ID </span><br><span class="line">CREATED 镜像创建时间 </span><br><span class="line">SIZE 镜像大小 </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">同一个仓库源可以有多个 TAG，代表这个仓库源的不同版本，我们使用REPOSITORY：TAG 定义不同 的镜像，如果你不定义镜像的标签版本，docker将默认使用 lastest 镜像！</span> </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">可选项</span> </span><br><span class="line">-a： 列出本地所有镜像 </span><br><span class="line">-q： 只显示镜像id </span><br><span class="line">--digests： 显示镜像的摘要信息</span><br></pre></td></tr></table></figure>
<h3 id="docker-search"><a href="#docker-search" class="headerlink" title="docker search"></a>docker search</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 搜索镜像 </span><br><span class="line">[root@kuangshen ~]# docker search mysql </span><br><span class="line">NAME     DESCRIPTION                                       STARS       OFFICIAL </span><br><span class="line">mysql     MySQL is a widely used, open-source relation…     9484        [OK] </span><br><span class="line"># docker search 某个镜像的名称 对应DockerHub仓库中的镜像 </span><br><span class="line"># 可选项 </span><br><span class="line">--filter=stars=50 ： 列出收藏数不小于指定值的镜像。</span><br></pre></td></tr></table></figure>
<h3 id="docker-pull"><a href="#docker-pull" class="headerlink" title="docker pull"></a>docker pull</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># 下载镜像 </span><br><span class="line">[root@kuangshen ~]# </span><br><span class="line">docker pull mysql </span><br><span class="line">Using default tag: latest # 不写tag，默认是latest </span><br><span class="line">latest: Pulling from library/mysql </span><br><span class="line">54fec2fa59d0: Already exists # 分层下载 </span><br><span class="line">bcc6c6145912: Already exists </span><br><span class="line">951c3d959c9d: Already exists </span><br><span class="line">05de4d0e206e: Already exists </span><br><span class="line">319f0394ef42: Already exists </span><br><span class="line">d9185034607b: Already exists </span><br><span class="line">013a9c64dadc: Already exists </span><br><span class="line">42f3f7d10903: Pull complete </span><br><span class="line">c4a3851d9207: Pull complete</span><br><span class="line">82a1cc65c182: Pull complete </span><br><span class="line">a0a6b01efa55: Pull complete </span><br><span class="line">bca5ce71f9ea: Pull complete </span><br><span class="line">Digest: </span><br><span class="line">sha256:61a2a33f4b8b4bc93b7b6b9e65e64044aaec594809f818aeffbff69a893d1944 # 签名</span><br><span class="line">Status: Downloaded newer image for mysql:latest </span><br><span class="line">docker.io/library/mysql:latest # 真实位置 </span><br><span class="line"># 指定版本下载 </span><br><span class="line">[root@kuangshen ~]# docker pull mysql:5.7</span><br></pre></td></tr></table></figure>
<h3 id="docker-rmi"><a href="#docker-rmi" class="headerlink" title="docker rmi"></a>docker rmi</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker rmi -f 镜像id # 删除单个</span><br><span class="line">docker rmi -f 镜像名:tag 镜像名:tag # 删除多个</span><br><span class="line">docker rmi -f $(docker images -qa) # 删除全部</span><br></pre></td></tr></table></figure>
<h2 id="容器命令"><a href="#容器命令" class="headerlink" title="容器命令"></a>容器命令</h2><h3 id="说明：有镜像才能创建容器，我们这里使用-centos-的镜像来测试，就是虚拟一个-centos"><a href="#说明：有镜像才能创建容器，我们这里使用-centos-的镜像来测试，就是虚拟一个-centos" class="headerlink" title="说明：有镜像才能创建容器，我们这里使用 centos 的镜像来测试，就是虚拟一个 centos"></a>说明：有镜像才能创建容器，我们这里使用 centos 的镜像来测试，就是虚拟一个 centos</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull centos</span><br></pre></td></tr></table></figure>
<h3 id="新建容器并启动"><a href="#新建容器并启动" class="headerlink" title="新建容器并启动"></a>新建容器并启动</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run [OPTIONS] IMAGE [COMMAND][ARG...]</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 常用参数说明</span><br><span class="line">--name=&quot;Name&quot; # 给容器指定一个名字</span><br><span class="line">-d # 后台方式运行容器，并返回容器的id！</span><br><span class="line">-i # 以交互模式运行容器，通过和 -t 一起使用</span><br><span class="line">-t # 给容器重新分配一个终端，通常和 -i 一起使用</span><br><span class="line">-P # 随机端口映射（大写）</span><br><span class="line">-p # 指定端口映射（小结），一般可以有四种写法</span><br><span class="line">    ip:hostPort:containerPort</span><br><span class="line">    ip::containerPort</span><br><span class="line">    hostPort:containerPort (常用)</span><br><span class="line">    containerPort</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 测试</span><br><span class="line">[root@kuangshen ~]# docker images</span><br><span class="line">REPOSITORY TAG IMAGE ID       CREATED    SIZE</span><br><span class="line">centos latest 470671670cac 3 months ago 237MB</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 使用centos进行用交互模式启动容器，在容器内执行/bin/bash命令！</span><br><span class="line">[root@kuangshen ~]# docker run -it centos /bin/bash</span><br><span class="line">[root@dc8f24dd06d0 /]# ls # 注意地址，已经切换到容器内部了！</span><br><span class="line">bin etc lib lost+found mnt proc run srv tmp var</span><br><span class="line">dev home lib64 media opt root sbin sys usr</span><br><span class="line"></span><br><span class="line">[root@dc8f24dd06d0 /]# exit # 使用 exit 退出容器 </span><br><span class="line">exit </span><br><span class="line">[root@kuangshen ~]#</span><br></pre></td></tr></table></figure>
<h3 id="列出所有运行的容器"><a href="#列出所有运行的容器" class="headerlink" title="列出所有运行的容器"></a>列出所有运行的容器</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 命令 </span><br><span class="line">docker ps [OPTIONS] </span><br><span class="line"></span><br><span class="line"># 常用参数说明 </span><br><span class="line">-a # 列出当前所有正在运行的容器 + 历史运行过的容器 </span><br><span class="line">-l # 显示最近创建的容器 </span><br><span class="line">-n=? # 显示最近n个创建的容器 </span><br><span class="line">-q # 静默模式，只显示容器编号。</span><br></pre></td></tr></table></figure>
<h3 id="退出容器"><a href="#退出容器" class="headerlink" title="退出容器"></a>退出容器</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">exit # 容器停止退出 </span><br><span class="line">ctrl+P+Q # 容器不停止退出</span><br></pre></td></tr></table></figure>
<h3 id="启动停止容器"><a href="#启动停止容器" class="headerlink" title="启动停止容器"></a>启动停止容器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker start (容器id or 容器名) # 启动容器 </span><br><span class="line">docker restart (容器id or 容器名) # 重启容器 </span><br><span class="line">docker stop (容器id or 容器名) # 停止容器 </span><br><span class="line">docker kill (容器id or 容器名) # 强制停止容器</span><br></pre></td></tr></table></figure>
<h3 id="删除容器"><a href="#删除容器" class="headerlink" title="删除容器"></a>删除容器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker rm 容器id # 删除指定容器 </span><br><span class="line">docker rm -f $(docker ps -a -q) # 删除所有容器 </span><br><span class="line">docker ps -a -q|xargs docker rm # 删除所有容器</span><br></pre></td></tr></table></figure>
<h2 id="常用其他命令"><a href="#常用其他命令" class="headerlink" title="常用其他命令"></a>常用其他命令</h2><h3 id="后台启动容器"><a href="#后台启动容器" class="headerlink" title="后台启动容器"></a>后台启动容器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">命令</span> </span><br><span class="line">docker run -d 容器名 </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">例子</span> </span><br><span class="line">docker run -d centos # 启动centos，使用后台方式启动 </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">问题： 使用docker ps 查看，发现容器已经退出了！</span> </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">解释：Docker容器后台运行，就必须有一个前台进程，容器运行的命令如果不是那些一直挂起的命 令，就会自动退出。</span> </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">比如，你运行了nginx服务，但是docker前台没有运行应用，这种情况下，容器启动后，会立即自 杀，因为他觉得没有程序了，所以最好的情况是，将你的应用使用前台进程的方式运行启动。</span></span><br></pre></td></tr></table></figure>
<h3 id="查看日志"><a href="#查看日志" class="headerlink" title="查看日志"></a>查看日志</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">命令</span> </span><br><span class="line">docker logs -f -t --tail 容器id </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">例子：我们启动 centos，并编写一段脚本来测试玩玩！最后查看日志</span></span><br><span class="line">[root@kuangshen ~]# docker run -d centos /bin/sh -c &quot;while true;do echo kuangshen;sleep 1;done&quot; </span><br><span class="line">[root@kuangshen ~]# docker ps </span><br><span class="line">CONTAINER ID      IMAGE </span><br><span class="line">c8530dbbe3b4      centos </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-t 显示时间戳</span> </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-f 打印最新的日志</span> </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">--<span class="built_in">tail</span> 数字 显示多少条！</span> </span><br><span class="line">[root@kuangshen ~]# docker logs -tf --tail 10 c8530dbbe3b4 </span><br><span class="line">2020-05-11T08:46:40.656901941Z kuangshen </span><br><span class="line">2020-05-11T08:46:41.658765018Z kuangshen </span><br><span class="line">2020-05-11T08:46:42.661015375Z kuangshen </span><br><span class="line">2020-05-11T08:46:43.662865628Z kuangshen </span><br><span class="line">2020-05-11T08:46:44.664571547Z kuangshen </span><br><span class="line">2020-05-11T08:46:45.666718583Z kuangshen </span><br><span class="line">2020-05-11T08:46:46.668556725Z kuangshen </span><br><span class="line">2020-05-11T08:46:47.670424699Z kuangshen </span><br><span class="line">2020-05-11T08:46:48.672324512Z kuangshen </span><br><span class="line">2020-05-11T08:46:49.674092766Z kuangshen</span><br></pre></td></tr></table></figure>
<h3 id="查看容器中运行的进程信息，支持-ps-命令参数"><a href="#查看容器中运行的进程信息，支持-ps-命令参数" class="headerlink" title="查看容器中运行的进程信息，支持 ps 命令参数"></a>查看容器中运行的进程信息，支持 ps 命令参数</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">命令</span> </span><br><span class="line">docker top 容器id </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">测试</span> </span><br><span class="line">[root@kuangshen ~]# docker top c8530dbbe3b4 </span><br><span class="line">UID     PID    PPID C STIME TTY TIME    CMD </span><br><span class="line">root    27437 27421 0 16:43 ? 00:00:00 /bin/sh -c ....</span><br></pre></td></tr></table></figure>
<h3 id="查看容器-镜像的元数据"><a href="#查看容器-镜像的元数据" class="headerlink" title="查看容器/镜像的元数据"></a>查看容器/镜像的元数据</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">命令</span> </span><br><span class="line">docker inspect 容器id </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">测试</span> </span><br><span class="line">[root@kuangshen ~]# docker inspect c8530dbbe3b4 </span><br><span class="line">[ </span><br><span class="line">    &#123; # 完整的id，有意思啊，这里上面的容器id，就是截取的这个id前几位！ </span><br><span class="line">    &quot;Id&quot;: &quot;c8530dbbe3b44a0c873f2566442df6543ed653c1319753e34b400efa05f77cf8&quot;, </span><br><span class="line">    &quot;Created&quot;: &quot;2020-05-11T08:43:45.096892382Z&quot;, </span><br><span class="line">    &quot;Path&quot;: &quot;/bin/sh&quot;, </span><br><span class="line">    &quot;Args&quot;: [ </span><br><span class="line">        &quot;-c&quot;, </span><br><span class="line">        &quot;while true;do echo kuangshen;sleep 1;done&quot; </span><br><span class="line">    ],</span><br><span class="line">    # 状态 </span><br><span class="line">    &quot;State&quot;: &#123; </span><br><span class="line">        &quot;Status&quot;: &quot;running&quot;, </span><br><span class="line">        &quot;Running&quot;: true, </span><br><span class="line">        &quot;Paused&quot;: false, </span><br><span class="line">        &quot;Restarting&quot;: false, </span><br><span class="line">        &quot;OOMKilled&quot;: false, </span><br><span class="line">        &quot;Dead&quot;: false,</span><br><span class="line">        &quot;Pid&quot;: 27437, </span><br><span class="line">        &quot;ExitCode&quot;: 0, </span><br><span class="line">        &quot;Error&quot;: &quot;&quot;, </span><br><span class="line">        &quot;StartedAt&quot;: &quot;2020-05-11T08:43:45.324474622Z&quot;, </span><br><span class="line">        &quot;FinishedAt&quot;: &quot;0001-01-01T00:00:00Z&quot; </span><br><span class="line">        &#125;, </span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h3 id="进入正在运行的容器"><a href="#进入正在运行的容器" class="headerlink" title="进入正在运行的容器"></a>进入正在运行的容器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">命令1</span> </span><br><span class="line">docker exec -it 容器id bashShell </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">测试1</span> </span><br><span class="line">[root@kuangshen ~]# docker ps </span><br><span class="line">CONTAINER ID IMAGE      COMMAND             CREATED         STATUS PORTS NAMES </span><br><span class="line">c8530dbbe3b4 centos &quot;/bin/sh -c &#x27;while t…&quot; 12 minutes ago Up 12 minutes happy_chaum </span><br><span class="line">[root@kuangshen ~]# docker exec -it c8530dbbe3b4 /bin/bash </span><br><span class="line">[root@c8530dbbe3b4 /]# ps -ef</span><br><span class="line">    UID PID PPID C STIME TTY TIME CMD </span><br><span class="line">    root 1 0 0 08:43 ? 00:00:00 /bin/sh -c while true;do echo kuangshen;sleep </span><br><span class="line">    root 751 0 0 08:56 pts/0 00:00:00 /bin/bash </span><br><span class="line">    root 769 1 0 08:56 ? 00:00:00 /usr/bin/coreutils -- coreutils-prog-shebang=s </span><br><span class="line">    root 770 751 0 08:56 pts/0 00:00:00 ps -ef </span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"> # </span><span class="language-bash">命令2</span> </span><br><span class="line"> docker attach 容器id </span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"> # </span><span class="language-bash">测试2</span> </span><br><span class="line"> [root@kuangshen ~]# docker exec -it c8530dbbe3b4 /bin/bash </span><br><span class="line"> [root@c8530dbbe3b4 /]# ps -ef </span><br><span class="line"> UID PID PPID C STIME TTY TIME CMD </span><br><span class="line"> root 1 0 0 08:43 ? 00:00:00 /bin/sh -c while true;do echo kuangshen;sleep </span><br><span class="line"> root 856 0 0 08:57 pts/0 00:00:00 /bin/bash </span><br><span class="line"> root 874 1 0 08:57 ? 00:00:00 /usr/bin/coreutils -- coreutils-prog-shebang=s </span><br><span class="line"> root 875 856 0 08:57 pts/0 00:00:00 ps -ef </span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"> # </span><span class="language-bash">区别</span> </span><br><span class="line"><span class="meta prompt_"> # </span><span class="language-bash"><span class="built_in">exec</span> 是在容器中打开新的终端，并且可以启动新的进程</span> </span><br><span class="line"><span class="meta prompt_"> # </span><span class="language-bash">attach 直接进入容器启动命令的终端，不会启动新的进程</span></span><br></pre></td></tr></table></figure>
<h3 id="从容器内拷贝文件到主机上"><a href="#从容器内拷贝文件到主机上" class="headerlink" title="从容器内拷贝文件到主机上"></a>从容器内拷贝文件到主机上</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">命令</span> </span><br><span class="line">docker cp 容器id:容器内路径 目的主机路径 </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">测试</span> </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">容器内执行，创建一个文件测试</span> </span><br><span class="line">[root@c8530dbbe3b4 /]# cd /home </span><br><span class="line">[root@c8530dbbe3b4 home]# touch f1 </span><br><span class="line">[root@c8530dbbe3b4 home]# ls</span><br><span class="line">f1</span><br><span class="line">[root@c8530dbbe3b4 home]# exit exit </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">linux复制查看，是否复制成功</span> </span><br><span class="line">[root@kuangshen ~]# docker cp c8530dbbe3b4:/home/f1 /home </span><br><span class="line">[root@kuangshen ~]# cd /home </span><br><span class="line">[root@kuangshen home]# ls </span><br><span class="line">f1</span><br></pre></td></tr></table></figure>
<h2 id="小结-1"><a href="#小结-1" class="headerlink" title="小结"></a>小结</h2><p>  <img src="QQ截图20210719165346.png" alt="输入图片说明"></p>
<h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">attach Attach to a running container # 当前 shell 下 </span><br><span class="line">attach 连接指定运行镜像 build Build an image from a Dockerfile # 通过 Dockerfile 定 制镜像 </span><br><span class="line">commit Create a new image from a container changes # 提交当前容器为新的镜像 </span><br><span class="line">cp Copy files/folders from the containers filesystem to the host path #从容器中拷贝指定文件或者目录到宿主机中 </span><br><span class="line">create Create a new container # 创建一个新的容器，同 run，但不启动容器 </span><br><span class="line">diff Inspect changes on a container&#x27;s filesystem # 查看 docker 容器变化 </span><br><span class="line">events Get real time events from the server # 从 docker 服务获取容 器实时事件 </span><br><span class="line">exec Run a command in an existing container # 在已存在的容器上运行命 令</span><br><span class="line">export Stream the contents of a container as a tar archive # 导出容器的内 容流作为一个 tar 归档文件[对应 import ] </span><br><span class="line">history Show the history of an image # 展示一个镜像形成历史 </span><br><span class="line">images List images # 列出系统当前镜像</span><br><span class="line">import Create a new filesystem image from the contents of a tarball # 从 tar包中的内容创建一个新的文件系统映像[对应export] </span><br><span class="line">info Display system-wide information # 显示系统相关信息 </span><br><span class="line">inspect Return low-level information on a container # 查看容器详细信息 </span><br><span class="line">kill Kill a running container # kill 指定 docker 容 器</span><br><span class="line">load Load an image from a tar archive # 从一个 tar 包中加载一 个镜像[对应 save] </span><br><span class="line">login Register or Login to the docker registry server # 注册或者登陆一个 docker 源服务器 </span><br><span class="line">logout Log out from a Docker registry server # 从当前 Docker registry 退出 </span><br><span class="line">logs Fetch the logs of a container # 输出当前容器日志信息 </span><br><span class="line">port Lookup the public-facing port which is NAT-ed to PRIVATE_PORT # 查看映射端口对应的容器内部源端口 </span><br><span class="line">pause Pause all processes within a container # 暂停容器 </span><br><span class="line">ps List containers # 列出容器列表 </span><br><span class="line">pull Pull an image or a repository from the docker registry server # 从docker镜像源服务器拉取指定镜像或者库镜像 </span><br><span class="line">push Push an image or a repository to the docker registry server # 推送指定镜像或者库镜像至docker源服务器 </span><br><span class="line">restart Restart a running container # 重启运行的容器 </span><br><span class="line">rm Remove one or more containers # 移除一个或者多个容器 </span><br><span class="line">rmi Remove one or more images # 移除一个或多个镜像[无容器使用该 镜像才可删除，否则需删除相关容器才可继续或 -f 强制删除] </span><br><span class="line">run Run a command in a new container # 创建一个新的容器并运行 一个命令 </span><br><span class="line">save Save an image to a tar archive # 保存一个镜像为一个 tar 包[对应 load] </span><br><span class="line">search Search for an image on the Docker Hub # 在 docker hub 中搜 索镜像 </span><br><span class="line">start Start a stopped containers # 启动容器 </span><br><span class="line">stop Stop a running containers # 停止容器 </span><br><span class="line">tag Tag an image into a repository # 给源中镜像打标签 </span><br><span class="line">top Lookup the running processes of a container # 查看容器中运行的进程信 息</span><br><span class="line">unpause Unpause a paused container # 取消暂停容器 </span><br><span class="line">version Show the docker version information # 查看 docker 版本号 </span><br><span class="line">wait Block until a container stops, then print its exit code # 截取容 器停止时的退出状态值</span><br></pre></td></tr></table></figure>
<h2 id="作业练习"><a href="#作业练习" class="headerlink" title="作业练习"></a>作业练习</h2><h3 id="使用Docker-安装-Nginx"><a href="#使用Docker-安装-Nginx" class="headerlink" title="使用Docker 安装 Nginx"></a>使用Docker 安装 Nginx</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1、搜索镜像 </span></span><br><span class="line">[root@kuangshen ~]<span class="comment"># docker search nginx </span></span><br><span class="line">NAME  DESCRIPTION              STARS OFFICIAL </span><br><span class="line">nginx Official build of Nginx. 13159 [OK] </span><br><span class="line"><span class="comment"># 2、拉取镜像 </span></span><br><span class="line">[root@kuangshen ~]<span class="comment"># docker pull nginx </span></span><br><span class="line">Using default tag: latest</span><br><span class="line">latest: Pulling from library/nginx </span><br><span class="line">54fec2fa59d0: Pull complete </span><br><span class="line">4ede6f09aefe: Pull complete </span><br><span class="line">f9dc69acb465: Pull complete </span><br><span class="line">Digest: </span><br><span class="line">sha256:86ae264c3f4acb99b2dee4d0098c40cb8c46dcf9e1148f05d3a51c4df6758c12 </span><br><span class="line">Status: Downloaded newer image <span class="keyword">for</span> nginx:latest </span><br><span class="line">docker.io/library/nginx:latest </span><br><span class="line"></span><br><span class="line"><span class="comment"># 3、启动容器 </span></span><br><span class="line">[root@kuangshen ~]<span class="comment"># docker images </span></span><br><span class="line">REPOSITORY TAG    IMAGE ID    CREATED      SIZE </span><br><span class="line">diytomcat latest ffdf6529937d 3 hours ago 636MB </span><br><span class="line">nginx     latest 602e111c06b6 2 weeks ago 127MB </span><br><span class="line">centos    latest 470671670cac 3 months ago 237MB </span><br><span class="line">[root@kuangshen ~]<span class="comment"># docker run -d --name mynginx -p 3500:80 nginx </span></span><br><span class="line">a95d5f2f057fc609082cfa0de906bd690f95c43a26d38420d081f0e255b232ec </span><br><span class="line">[root@kuangshen ~]<span class="comment"># docker ps </span></span><br><span class="line">CONTAINER ID IMAGE PORTS                NAMES </span><br><span class="line">a95d5f2f057f nginx 0.0.0.0:3500-&gt;80/tcp mynginx </span><br><span class="line"></span><br><span class="line"><span class="comment"># 4、测试访问 </span></span><br><span class="line">[root@kuangshen ~]<span class="comment"># curl localhost:3500 </span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;title&gt;Welcome to nginx!&lt;/title&gt; <span class="comment"># ok .... </span></span><br><span class="line">&lt;/html&gt; </span><br><span class="line"></span><br><span class="line"><span class="comment"># 5、进入容器 </span></span><br><span class="line">[root@kuangshen ~]<span class="comment"># docker exec -it mynginx /bin/bash </span></span><br><span class="line">root@a95d5f2f057f:/<span class="comment"># whereis nginx # 寻找nginx </span></span><br><span class="line">nginx: /usr/sbin/nginx /usr/lib/nginx /etc/nginx /usr/share/nginx </span><br><span class="line">root@a95d5f2f057f:/<span class="comment"># cd /usr/share/nginx # nginx 的路径 </span></span><br><span class="line">root@a95d5f2f057f:/usr/share/nginx<span class="comment"># ls </span></span><br><span class="line">html </span><br><span class="line">root@a95d5f2f057f:/usr/share/nginx<span class="comment"># cd html # 首页的位置 </span></span><br><span class="line">root@a95d5f2f057f:/usr/share/nginx/html<span class="comment"># ls </span></span><br><span class="line">50x.html index.html </span><br><span class="line">root@a95d5f2f057f:/usr/share/nginx/html<span class="comment"># cat index.html </span></span><br><span class="line">&lt;!DOCTYPE html&gt; </span><br><span class="line">&lt;html&gt; </span><br><span class="line">&lt;<span class="built_in">head</span>&gt; </span><br><span class="line">&lt;title&gt;Welcome to nginx!&lt;/title&gt; </span><br><span class="line">&lt;style&gt; </span><br><span class="line">body &#123;</span><br><span class="line">    width: 35em; </span><br><span class="line">    margin: 0 auto; </span><br><span class="line">    font-family: Tahoma, Verdana, Arial, sans-serif; </span><br><span class="line">    &#125; </span><br><span class="line">&lt;/style&gt; </span><br><span class="line">&lt;/head&gt; </span><br><span class="line">&lt;body&gt; </span><br><span class="line">&lt;h1&gt;Welcome to nginx!&lt;/h1&gt; </span><br><span class="line">&lt;/body&gt; </span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h3 id="使用docker安装-tomcat"><a href="#使用docker安装-tomcat" class="headerlink" title="使用docker安装 tomcat"></a>使用docker安装 tomcat</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">官方文档解释</span> </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-it ：交互模式</span> </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">--<span class="built_in">rm</span>：容器启动成功并退出以后容器就自动移除，一般在测试情况下使用！</span> </span><br><span class="line">docker run -it --rm tomcat:9.0 </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1、下载tomcat镜像</span> </span><br><span class="line">docker pull tomcat </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2、启动</span> </span><br><span class="line">docker run -d -p 8080:8080 --name tomcat9 tomcat </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3、进入tomcat</span> </span><br><span class="line">docker exec -it tomcat9 /bin/bash </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">4、思考：我们以后要部署项目，还需要进入容器中，是不是十分麻烦，要是有一种技术，可以将容器</span> </span><br><span class="line">内和我们Linux进行映射挂载就好了？我们后面会将数据卷技术来进行挂载操作，也是一个核心内容，这 </span><br><span class="line">里大家先听听名词就好，我们很快就会讲到！</span><br></pre></td></tr></table></figure>
<h3 id="使用docker-部署-es-kibana"><a href="#使用docker-部署-es-kibana" class="headerlink" title="使用docker 部署 es + kibana"></a>使用docker 部署 es + kibana</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">我们启动es这种容器需要考虑几个问题</span> </span><br><span class="line">1、端口暴露问题 9200、9300 </span><br><span class="line">2、数据卷的挂载问题 data、plugins、conf </span><br><span class="line">3、吃内存 - &quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot; </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">扩展命令</span> </span><br><span class="line">docker stats 容器id # 查看容器的cpu内存和网络状态 </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1、启动es测试</span> </span><br><span class="line">docker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; elasticsearch:7.6.2 </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2、启动之后很卡，使用 docker stats 容器<span class="built_in">id</span> 查看下cpu状态 ，发现占用的很大</span> </span><br><span class="line">CONTAINER ID NAME          CPU % MEM USAGE / LIMIT   MEM % </span><br><span class="line">249ae46da625 elasticsearch 0.00% 1.036GiB / 1.716GiB 60.37% </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3、测试访问</span> </span><br><span class="line">[root@kuangshen data]# curl localhost:9200 </span><br><span class="line">&#123; </span><br><span class="line">    &quot;name&quot; : &quot;249ae46da625&quot;, </span><br><span class="line">    &quot;cluster_name&quot; : &quot;docker-cluster&quot;, </span><br><span class="line">    &quot;cluster_uuid&quot; : &quot;_Ho_i4fOTUesNc_II35sSA&quot;, </span><br><span class="line">    &quot;version&quot; : &#123; </span><br><span class="line">        &quot;number&quot; : &quot;7.6.2&quot;, </span><br><span class="line">        &quot;build_flavor&quot; : &quot;default&quot;, </span><br><span class="line">        &quot;build_type&quot; : &quot;docker&quot;, </span><br><span class="line">        &quot;build_hash&quot; : &quot;ef48eb35cf30adf4db14086e8aabd07ef6fb113f&quot;, </span><br><span class="line">        &quot;build_date&quot; : &quot;2020-03-26T06:34:37.794943Z&quot;,</span><br><span class="line">        &quot;build_snapshot&quot; : false, </span><br><span class="line">        &quot;lucene_version&quot; : &quot;8.4.0&quot;, </span><br><span class="line">        &quot;minimum_wire_compatibility_version&quot; : &quot;6.8.0&quot;, </span><br><span class="line">        &quot;minimum_index_compatibility_version&quot; : &quot;6.0.0-beta1&quot; </span><br><span class="line">        &#125;,</span><br><span class="line">    &quot;tagline&quot; : &quot;You Know, for Search&quot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">4、增加上内存限制启动</span> </span><br><span class="line">docker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; -e ES_JAVA_OPTS=&quot;-Xms64m -Xmx512m&quot; elasticsearch:7.6.2 </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">5、启动之后，使用 docker stats 查看下cpu状态</span> </span><br><span class="line">CONTAINER ID NAME          CPU % MEM USAGE / LIMIT MEM % </span><br><span class="line">d2860684e7e4 elasticsearch 0.24% 358.3MiB / 1.716GiB 20.40% </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">6、测试访问，效果一样，ok！</span> </span><br><span class="line">[root@kuangshen data]# curl localhost:9200 </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">思考：如果我们要使用 kibana , 如果配置连接上我们的es呢？网络该如何配置呢？</span></span><br></pre></td></tr></table></figure>
<p>  <img src="QQ截图20210719172742.png" alt="输入图片说明"></p>
<h2 id="可视化"><a href="#可视化" class="headerlink" title="可视化"></a>可视化</h2><h3 id="Portainer（先用这个）"><a href="#Portainer（先用这个）" class="headerlink" title="Portainer（先用这个）"></a>Portainer（先用这个）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 8088:9000 \ --restart=always -v /var/run/docker.sock:/var/run/docker.sock -- privileged=true portainer/portainer</span><br></pre></td></tr></table></figure>
<h3 id="Rancher（CI-CD再用这个）"><a href="#Rancher（CI-CD再用这个）" class="headerlink" title="Rancher（CI/CD再用这个）"></a>Rancher（CI/CD再用这个）</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">安装rancher-server</span> </span><br><span class="line">docker run --name rancher-server -p 8000:8080 -v /etc/localtime:/etc/localtime:ro -d rancher/server </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">安装agent</span> </span><br><span class="line">docker run --rm --privileged -v /var/run/docker.sock:/var/run/docker.sock -v /var/lib/rancher:/var/lib/rancher rancher/agent:v1.2.11 </span><br><span class="line">http://39.101.191.131:8000/v1/scripts/D3DBD43F263109BB881F:1577750400000:7M0y BzCw4XSxJklD7TpysYIpI</span><br></pre></td></tr></table></figure>
<h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>&gt;</p>
<blockquote>
<p>Portainer是Docker的图形化管理工具，提供状态显示面板、应用模板快速部署、容器镜像网络数据卷<br>的基本操作（包括上传下载镜像，创建容器等操作）、事件日志显示、容器控制台操作、Swarm集群和<br>服务等集中管理和操作、登录用户管理和控制等功能。功能十分全面，基本能满足中小型单位对容器管<br>理的全部需求。<br>如果仅有一个docker宿主机，则可使用单机版运行，Portainer单机版运行十分简单，只需要一条语句即<br>可启动容器，来管理该机器上的docker镜像、容器等数据。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 8088:9000 \ --restart=always -v /var/run/docker.sock:/var/run/docker.sock -- privileged=true portainer/portainer</span><br></pre></td></tr></table></figure>
<h3 id="访问方式：http-IP-8088"><a href="#访问方式：http-IP-8088" class="headerlink" title="访问方式：http://IP:8088"></a>访问方式：<a target="_blank" rel="noopener" href="http://IP:8088">http://IP:8088</a></h3><h3 id="首次登陆需要注册用户，给admin用户设置密码"><a href="#首次登陆需要注册用户，给admin用户设置密码" class="headerlink" title="首次登陆需要注册用户，给admin用户设置密码"></a>首次登陆需要注册用户，给admin用户设置密码</h3><p>  <img src="QQ截图20210719173804.png" alt="输入图片说明"></p>
<h3 id="单机版这里选择local即可，选择完毕，点击Connect即可连接到本地docker"><a href="#单机版这里选择local即可，选择完毕，点击Connect即可连接到本地docker" class="headerlink" title="单机版这里选择local即可，选择完毕，点击Connect即可连接到本地docker"></a>单机版这里选择local即可，选择完毕，点击Connect即可连接到本地docker</h3><p>  <img src="QQ截图20210719173821.png" alt="输入图片说明"></p>
<h3 id="登录成功"><a href="#登录成功" class="headerlink" title="登录成功"></a>登录成功</h3><p>  <img src="QQ截图20210719173908.png" alt="输入图片说明"></p>
<h3 id="我们可以点击可视化界面来玩玩"><a href="#我们可以点击可视化界面来玩玩" class="headerlink" title="我们可以点击可视化界面来玩玩"></a>我们可以点击可视化界面来玩玩</h3><h1 id="Docker镜像讲解"><a href="#Docker镜像讲解" class="headerlink" title="Docker镜像讲解"></a>Docker镜像讲解</h1><h2 id="镜像是什么"><a href="#镜像是什么" class="headerlink" title="镜像是什么"></a>镜像是什么</h2><blockquote>
<p>镜像是一种轻量级、可执行的独立软件包，用来打包软件运行环境和基于运行环境开发的软件，它包含<br>运行某个软件所需的所有内容，包括代码、运行时、库、环境变量和配置文件。</p>
</blockquote>
<h2 id="Docker镜像加载原理"><a href="#Docker镜像加载原理" class="headerlink" title="Docker镜像加载原理"></a>Docker镜像加载原理</h2><h3 id="UnionFS-（联合文件系统）"><a href="#UnionFS-（联合文件系统）" class="headerlink" title="UnionFS （联合文件系统）"></a>UnionFS （联合文件系统）</h3><blockquote>
<p>UnionFS（联合文件系统）：Union文件系统（UnionFS）是一种分层、轻量级并且高性能的文件系统，<br>它支持对文件系统的修改作为一次提交来一层层的叠加，同时可以将不同目录挂载到同一个虚拟文件系<br>统下(unite several directories into a single virtual filesystem)。Union 文件系统是 Docker 镜像的基<br>础。镜像可以通过分层来进行继承，基于基础镜像（没有父镜像），可以制作各种具体的应用镜像。<br>特性：一次同时加载多个文件系统，但从外面看起来，只能看到一个文件系统，联合加载会把各层文件<br>系统叠加起来，这样最终的文件系统会包含所有底层的文件和目录</p>
</blockquote>
<h3 id="Docker镜像加载原理-1"><a href="#Docker镜像加载原理-1" class="headerlink" title="Docker镜像加载原理"></a>Docker镜像加载原理</h3><blockquote>
<p>docker的镜像实际上由一层一层的文件系统组成，这种层级的文件系统UnionFS。<br><br>bootfs(boot file system)主要包含bootloader和kernel, bootloader主要是引导加载kernel, Linux刚启<br><br>动时会加载bootfs文件系统，在Docker镜像的最底层是bootfs。这一层与我们典型的Linux/Unix系统是<br><br>一样的，包含boot加载器和内核。当boot加载完成之后整个内核就都在内存中了，此时内存的使用权已<br><br>由bootfs转交给内核，此时系统也会卸载bootfs。 rootfs (root file system) ，在bootfs之上。包含的就是典型 Linux 系统中的 /dev, /proc, /bin, /etc 等标<br><br>准目录和文件。rootfs就是各种不同的操作系统发行版，比如Ubuntu，Centos等等。</p>
</blockquote>
<p><img src="QQ截图20210719174045.png" alt="输入图片说明"></p>
<h3 id="平时我们安装进虚拟机的CentOS都是好几个G，为什么Docker这里才200M？"><a href="#平时我们安装进虚拟机的CentOS都是好几个G，为什么Docker这里才200M？" class="headerlink" title="平时我们安装进虚拟机的CentOS都是好几个G，为什么Docker这里才200M？"></a>平时我们安装进虚拟机的CentOS都是好几个G，为什么Docker这里才200M？</h3><p><img src="QQ截图20210719174107.png" alt="输入图片说明"></p>
<p>对于一个精简的OS，rootfs 可以很小，只需要包含最基本的命令，工具和程序库就可以了，因为底层直<br>接用Host的kernel，自己只需要提供rootfs就可以了。由此可见对于不同的linux发行版, bootfs基本是一<br>致的, rootfs会有差别, 因此不同的发行版可以公用bootfs。</p>
<h2 id="分层理解"><a href="#分层理解" class="headerlink" title="分层理解"></a>分层理解</h2><h3 id="分层的镜像"><a href="#分层的镜像" class="headerlink" title="分层的镜像"></a>分层的镜像</h3><blockquote>
<p>我们可以去下载一个镜像，注意观察下载的日志输出，可以看到是一层一层的在下载！</p>
</blockquote>
<p><img src="QQ截图20210719174629.png" alt="输入图片说明"></p>
<blockquote>
<p>思考：为什么Docker镜像要采用这种分层的结构呢？<br><br>最大的好处，我觉得莫过于是资源共享了！比如有多个镜像都从相同的Base镜像构建而来，那么宿主机<br><br>只需在磁盘上保留一份base镜像，同时内存中也只需要加载一份base镜像，这样就可以为所有的容器服<br><br>务了，而且镜像的每一层都可以被共享。<br><br>查看镜像分层的方式可以通过 docker image inspect 命令！</p>
</blockquote>
<h3 id="理解"><a href="#理解" class="headerlink" title="理解"></a>理解</h3><blockquote>
<p>所有的 Docker 镜像都起始于一个基础镜像层，当进行修改或增加新的内容时，就会在当前镜像层之<br><br>上，创建新的镜像层。<br><br>举一个简单的例子，假如基于 Ubuntu Linux 16.04 创建一个新的镜像，这就是新镜像的第一层；如果<br><br>在该镜像中添加 Python包，就会在基础镜像层之上创建第二个镜像层；如果继续添加一个安全补丁，就<br><br>会创建第三个镜像层。<br><br>该镜像当前已经包含 3 个镜像层，如下图所示（这只是一个用于演示的很简单的例子）。<br></p>
</blockquote>
<p><img src="QQ截图20210719175444.png" alt="输入图片说明"></p>
<blockquote>
<p>在添加额外的镜像层的同时，镜像始终保持是当前所有镜像的组合，理解这一点非常重要。下图中举了<br><br>一个简单的例子，每个镜像层包含 3 个文件，而镜像包含了来自两个镜像层的 6 个文件。<br></p>
</blockquote>
<p><img src="QQ截图20210719175635.png" alt="输入图片说明"></p>
<blockquote>
<p>上图中的镜像层跟之前图中的略有区别，主要目的是便于展示文件。<br><br>下图中展示了一个稍微复杂的三层镜像，在外部看来整个镜像只有 6 个文件，这是因为最上层中的文件<br><br>7 是文件 5 的一个更新版本。</p>
</blockquote>
<p><img src="QQ截图20210719180003.png" alt="输入图片说明"></p>
<blockquote>
<p>这种情况下，上层镜像层中的文件覆盖了底层镜像层中的文件。这样就使得文件的更新版本作为一个新<br><br>镜像层添加到镜像当中。<br><br>Docker 通过存储引擎（新版本采用快照机制）的方式来实现镜像层堆栈，并保证多镜像层对外展示为统<br><br>一的文件系统。<br><br>Linux 上可用的存储引擎有 AUFS、Overlay2、Device Mapper、Btrfs 以及 ZFS。顾名思义，每种存储<br><br>引擎都基于 Linux 中对应的文件系统或者块设备技术，并且每种存储引擎都有其独有的性能特点。<br><br>Docker 在 Windows 上仅支持 windowsfilter 一种存储引擎，该引擎基于 NTFS 文件系统之上实现了分<br><br>层和 CoW[1]。<br><br>下图展示了与系统显示相同的三层镜像。所有镜像层堆叠并合并，对外提供统一的视图。<br></p>
</blockquote>
<p><img src="QQ截图20210719180119.png" alt="输入图片说明"></p>
<h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><blockquote>
<p>Docker镜像都是只读的，当容器启动时，一个新的可写层被加载到镜像的顶部！<br><br>这一层就是我们通常说的容器层，容器之下的都叫镜像层！</p>
</blockquote>
<h2 id="镜像Commit"><a href="#镜像Commit" class="headerlink" title="镜像Commit"></a>镜像Commit</h2><h3 id="docker-commit-从容器创建一个新的镜像"><a href="#docker-commit-从容器创建一个新的镜像" class="headerlink" title="docker commit 从容器创建一个新的镜像"></a>docker commit 从容器创建一个新的镜像</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker commit 提交容器副本使之成为一个新的镜像！ </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">语法</span> </span><br><span class="line">docker commit -m=&quot;提交的描述信息&quot; -a=&quot;作者&quot; 容器id 要创建的目标镜像名:[标签名]</span><br></pre></td></tr></table></figure>
<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1、从Docker Hub 下载tomcat镜像到本地并运行 -it 交互终端 -p 端口映射</span></span><br><span class="line">docker run -it -p 8080 :8080 tomcat</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">注意：坑爹：docker启动官方tomcat镜像的容器，发现 404 是因为使用了加速器，而加速器里的tomcat的webapps下没有root等文件！</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">下载tomcat官方镜像，就是这个镜像（阿里云里的tomcat的webapps下没有任何文件）</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">进入tomcat查看<span class="built_in">cd</span>到webapps下发现全部空的，反而有个webapps.dist里有对应文件，<span class="built_in">cp</span> -r到webapps下！</span></span><br><span class="line">root@aba865b53114:/usr/local/tomcat# cp -r webapps.dist/* webapps</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2、删除上一步镜像产生的tomcat容器的文档</span></span><br><span class="line">docker ps # 查看容器id</span><br><span class="line">docker exec -it 容器id /bin/bash</span><br><span class="line">/usr/local/tomcat # ce webapps/</span><br><span class="line">/usr/local/tomcat/webapps # ls -l # 查看是否存在 docs文件夹</span><br><span class="line">/usr/local/tomcat/webapps # curl localhost:8080/docs/ # 可以看到 docs 返回的内容</span><br><span class="line">/usr/local/tomcat/webapps # rm -rf docs # 删除它</span><br><span class="line">/usr/local/tomcat/webapps # curl localhost:8080/docs/ # 再次访问返回 404</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3、当前运行的tomcat实例就是一个没有docs的容器，我们使用它为模板commit一个没有docs的tomcat新镜像， tomcat02</span></span><br><span class="line"></span><br><span class="line">docker ps -l # 查看容器的id</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">注意：commit的时候，容器的名字不能有大写，否则报错：invalid reference format</span></span><br><span class="line">docker commit -a=&quot;kuangshen&quot; -m=&quot;no tomcat docs&quot; 1e98a2f815b0 tomcat02:1.1</span><br><span class="line">sha256:cdccd4674f93ad34bf73d9db577a20f027a6d03fd1944dc0e628ee4bf17ec748</span><br><span class="line">[root@kuangshen /]# docker images # 查看，我们自己提交的镜像已经OK了！</span><br><span class="line">REPOSITORY TAG IMAGE ID CREATED</span><br><span class="line">SIZE</span><br><span class="line">tomcat02 1 .1 cdccd4674f93 About a minute</span><br><span class="line">ago 649MB</span><br><span class="line">redis latest f9b990972689 9 days ago</span><br><span class="line">104MB</span><br><span class="line">tomcat latest 927899a31456 2 weeks ago</span><br><span class="line">647MB</span><br><span class="line">centos latest 470671670cac 3 months ago</span><br><span class="line">237MB</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">4、这个时候，我们的镜像都是可以使用的，大家可以启动原来的tomcat，和我们新的tomcat02来 测试看看！</span></span><br><span class="line">[root@kuangshen ~]# docker run -it -p 8080:8080 tomcat02:1.1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">如果你想要保存你当前的状态，可以通过commit，来提交镜像，方便使用，类似于 VM 中的快照！</span></span><br></pre></td></tr></table></figure>
<h1 id="容器数据卷"><a href="#容器数据卷" class="headerlink" title="容器数据卷"></a>容器数据卷</h1><h2 id="什么是容器数据卷"><a href="#什么是容器数据卷" class="headerlink" title="什么是容器数据卷"></a>什么是容器数据卷</h2><h3 id="docker的理念回顾"><a href="#docker的理念回顾" class="headerlink" title="docker的理念回顾"></a>docker的理念回顾</h3><blockquote>
<p>将应用和运行的环境打包形成容器运行，运行可以伴随着容器，但是我们对于数据的要求，是希望能够<br><br>持久化的！<br><br>就好比，你安装一个MySQL，结果你把容器删了，就相当于删库跑路了，这TM也太扯了吧！<br><br>所以我们希望容器之间有可能可以共享数据，Docker容器产生的数据，如果不通过docker commit 生成<br><br>新的镜像，使得数据作为镜像的一部分保存下来，那么当容器删除后，数据自然也就没有了！这样是行<br><br>不通的！<br><br>为了能保存数据在Docker中我们就可以使用卷！让数据挂载到我们本地！这样数据就不会因为容器删除<br><br>而丢失了！<br></p>
<h3 id="作用："><a href="#作用：" class="headerlink" title="作用："></a>作用：<br></h3></blockquote>
<p>卷就是目录或者文件，存在一个或者多个容器中，由docker挂载到容器，但不属于联合文件系统，因此<br><br>能够绕过 Union File System ， 提供一些用于持续存储或共享数据的特性：<br><br>卷的设计目的就是数据的持久化，完全独立于容器的生存周期，因此Docker不会在容器删除时删除其挂<br>载的数据卷。<br></p>
<h3 id="特点-1"><a href="#特点-1" class="headerlink" title="特点"></a>特点</h3><ul>
<li>1、数据卷可在容器之间共享或重用数据</li>
<li>2、卷中的更改可以直接生效</li>
<li>3、数据卷中的更改不会包含在镜像的更新中</li>
<li>4、数据卷的生命周期一直持续到没有容器使用它为止</li>
</ul>
<h3 id="所以：总结一句话：-就是容器的持久化，以及容器间的继承和数据共享"><a href="#所以：总结一句话：-就是容器的持久化，以及容器间的继承和数据共享" class="headerlink" title="所以：总结一句话： 就是容器的持久化，以及容器间的继承和数据共享"></a>所以：总结一句话： 就是容器的持久化，以及容器间的继承和数据共享</h3><h2 id="使用数据卷"><a href="#使用数据卷" class="headerlink" title="使用数据卷"></a>使用数据卷</h2><h3 id="方式一：容器中直接使用命令来添加"><a href="#方式一：容器中直接使用命令来添加" class="headerlink" title="方式一：容器中直接使用命令来添加"></a>方式一：容器中直接使用命令来添加</h3><h3 id="挂载"><a href="#挂载" class="headerlink" title="挂载"></a>挂载</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">命令</span> </span><br><span class="line">docker run -it -v 宿主机绝对路径目录:容器内目录 镜像名 </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">测试</span> </span><br><span class="line">[root@kuangshen ~]# docker run -it -v /home/ceshi:/home centos /bin/bash</span><br></pre></td></tr></table></figure>
<h3 id="查看数据卷是否挂载成功-docker-inspect-容器id"><a href="#查看数据卷是否挂载成功-docker-inspect-容器id" class="headerlink" title="查看数据卷是否挂载成功 docker inspect 容器id"></a>查看数据卷是否挂载成功 docker inspect 容器id</h3><p><img src="QQ截图20210719181004.png" alt="输入图片说明"></p>
<h3 id="测试容器和宿主机之间数据共享：可以发现，在容器中，创建的会在宿主机中看到"><a href="#测试容器和宿主机之间数据共享：可以发现，在容器中，创建的会在宿主机中看到" class="headerlink" title="测试容器和宿主机之间数据共享：可以发现，在容器中，创建的会在宿主机中看到"></a>测试容器和宿主机之间数据共享：可以发现，在容器中，创建的会在宿主机中看到</h3><p><img src="QQ截图20210719181033.png" alt="输入图片说明"></p>
<h3 id="测试容器停止退出后，主机修改数据是否会同步"><a href="#测试容器停止退出后，主机修改数据是否会同步" class="headerlink" title="测试容器停止退出后，主机修改数据是否会同步"></a>测试容器停止退出后，主机修改数据是否会同步</h3><ul>
<li><ol>
<li>停止容器</li>
</ol>
</li>
<li><ol>
<li>在宿主机上修改文件，增加些内容</li>
</ol>
</li>
<li><ol>
<li>启动刚才停止的容器</li>
</ol>
</li>
<li><ol>
<li>然后查看对应的文件，发现数据依旧同步！ok</li>
</ol>
</li>
</ul>
<p><img src="QQ截图20210719181118.png" alt="输入图片说明"></p>
<h3 id="使用-docker-安装-mysql"><a href="#使用-docker-安装-mysql" class="headerlink" title="使用 docker 安装 mysql"></a>使用 docker 安装 mysql</h3><h3 id="思考：mysql-数据持久化的问题"><a href="#思考：mysql-数据持久化的问题" class="headerlink" title="思考：mysql 数据持久化的问题"></a>思考：mysql 数据持久化的问题</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1、搜索镜像</span></span><br><span class="line">[root@kuangshen ~]# docker search mysql</span><br><span class="line">NAME DESCRIPTION</span><br><span class="line">STARS</span><br><span class="line">mysql MySQL is a widely used, open-source</span><br><span class="line">relation... 9488</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2、拉取镜像</span></span><br><span class="line">[root@kuangshen ~]# docker pull mysql:5.7</span><br><span class="line">5 .7: Pulling from library/mysql</span><br><span class="line">54fec2fa59d0: Already exists</span><br><span class="line">bcc6c6145912: Pull complete</span><br><span class="line">951c3d959c9d: Pull complete</span><br><span class="line">05de4d0e206e: Pull complete</span><br><span class="line">319f0394ef42: Pull complete</span><br><span class="line">d9185034607b: Pull complete</span><br><span class="line">013a9c64dadc: Pull complete</span><br><span class="line">e745b3361626: Pull complete</span><br><span class="line">03145d87b451: Pull complete</span><br><span class="line">3991a6b182ee: Pull complete</span><br><span class="line">62335de06f7d: Pull complete</span><br><span class="line">Digest:</span><br><span class="line">sha256:e821ca8cc7a44d354486f30c6a193ec6b70a4eed8c8362aeede4e9b8d74b8ebb</span><br><span class="line">Status: Downloaded newer image for mysql:5.7</span><br><span class="line">docker.io/library/mysql:5.7</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3、启动容器 -e 环境变量！</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">注意： mysql的数据应该不丢失！先体验下 -v 挂载卷！ 参考官方文档</span></span><br><span class="line">[root@kuangshen home]# docker run -d -p 3310:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysql01 mysql:5.7</span><br><span class="line">4763fa5c68c4323688102f57938fb10996a0fb902d2812349286529f9378f16c</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">4、使用本地的sqlyog连接测试一下 3310</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">5、查看本地的 /home/mysql 目录</span></span><br><span class="line">[root@kuangshen data]# pwd</span><br><span class="line">/home/mysql/data</span><br><span class="line">[root@kuangshen data]# ls</span><br><span class="line">.. .... test  # 可以看到我们刚刚建立的mysql数据库在本地存储着</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">6、删除mysql容器</span></span><br><span class="line">[root@kuangshen data]# docker rm -f mysql01 # 删除容器，然后发现远程连接失败！</span><br><span class="line">mysql01</span><br><span class="line">[root@kuangshen data]# ls</span><br><span class="line">.. .... test # 可以看到我们刚刚建立的mysql数据库在本地存储着</span><br></pre></td></tr></table></figure>
<h3 id="通过Docker-File-来添加（了解）"><a href="#通过Docker-File-来添加（了解）" class="headerlink" title="通过Docker File 来添加（了解）"></a>通过Docker File 来添加（了解）</h3><blockquote>
<p>DockerFile 是用来构建Docker镜像的构建文件，是由一些列命令和参数构成的脚本。<br>我们在这里，先体验下，后面我们会详细讲解 DockerFile ！</p>
</blockquote>
<p>测试：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1、我们在宿主机 /home 目录下新建一个 docker-test-volume文件夹</span></span><br><span class="line">[root@kuangshen home]# mkdir docker-test-volume</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">说明：在编写DockerFile文件中使用 VOLUME 指令来给镜像添加一个或多个数据卷</span></span><br><span class="line">VOLUME[&quot;/dataVolumeContainer1&quot;,&quot;/dataVolumeContainer2&quot;,&quot;/dataVolumeContainer3&quot;]</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">出于可移植和分享的考虑，我们之前使用的 -v 主机目录:容器目录 这种方式不能够直接在DockerFile中实现。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">由于宿主机目录是依赖于特定宿主机的，并不能够保证在所有宿主机上都存在这样的特定目录.</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2、编写DockerFile文件</span></span><br><span class="line">[root@kuangshen docker-test-volume]# pwd</span><br><span class="line">/home/docker-test-volume</span><br><span class="line">[root@kuangshen docker-test-volume]# vim dockerfile1</span><br><span class="line">[root@kuangshen docker-test-volume]# cat dockerfile1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">volume <span class="built_in">test</span></span></span><br><span class="line">FROM centos</span><br><span class="line">VOLUME [&quot;/dataVolumeContainer1&quot;,&quot;/dataVolumeContainer2&quot;]</span><br><span class="line">CMD echo &quot;-------end------&quot;</span><br><span class="line">CMD /bin/bash</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3、build后生成镜像，获得一个新镜像 kuangshen/centos</span></span><br><span class="line"></span><br><span class="line">docker build -f /home/docker-test-volume/dockerfile1 -t kuangshen/centos. #注意最后有个.</span><br></pre></td></tr></table></figure>
<p><img src="QQ截图20210719181842.png" alt="输入图片说明"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">4、启动容器</span></span><br><span class="line">[root@kuangshen docker-test-volume]# docker run -it 0e97e1891a3d /bin/bash #启动容器</span><br><span class="line"></span><br><span class="line">[root@f5824970eefc /]# ls -l</span><br><span class="line">total 56</span><br><span class="line">lrwxrwxrwx 1 root root 7 May 11  2019 bin -&gt; usr/bin</span><br><span class="line">drwxr-xr-x 2 root root 4096 May 11 11 :55 dataVolumeContainer1 # 数据卷目录</span><br><span class="line">drwxr-xr-x 2 root root 4096 May 11 11 :55 dataVolumeContainer2 # 数据卷目录</span><br><span class="line">drwxr-xr-x 5 root root 360 May 11 11 :55 dev</span><br><span class="line">drwxr-xr-x 1 root root 4096 May 11 11 :55 etc</span><br><span class="line">drwxr-xr-x 2 root root 4096 May 11  2019 home</span><br><span class="line">.....</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">问题:通过上述步骤，容器内的卷目录地址就已经知道了，但是对应的主机目录地址在哪里呢？</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">5、我们在数据卷中新建一个文件</span></span><br><span class="line">[root@f5824970eefc dataVolumeContainer1]# pwd</span><br><span class="line">/dataVolumeContainer1</span><br><span class="line">[root@f5824970eefc dataVolumeContainer1]# touch container.txt</span><br><span class="line">[root@f5824970eefc dataVolumeContainer1]# ls -l</span><br><span class="line">total 0</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 11 :58 container.txt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">6、查看下这个容器的信息</span></span><br><span class="line">[root@kuangshen ~]# docker inspect 0e97e1891a3d</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看输出的Volumes</span></span><br><span class="line">&quot;Volumes&quot;: &#123;</span><br><span class="line">&quot;/dataVolumeContainer1&quot;: &#123;&#125;,</span><br><span class="line">&quot;/dataVolumeContainer2&quot;: &#123;&#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">7、这个卷在主机对应的默认位置</span></span><br></pre></td></tr></table></figure>
<p><img src="QQ截图20210719182127.png" alt="输入图片说明"></p>
<blockquote>
<p>注意：如果访问出现了 cannot open directory: Permission denied<br>解决办法：在挂载目录后多加一个 —privileged=true参数即可</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">匿名挂载 -v 容器内路径</span> </span><br><span class="line">docker run -d -P --name nginx01 -v /etc/nginx nginx </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">匿名挂载的缺点，就是不好维护，通常使用命令 docker volume维护</span> </span><br><span class="line">docker volume ls </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">具名挂载 -v 卷名:/容器内路径</span> </span><br><span class="line">docker run -d -P --name nginx02 -v nginxconfig:/etc/nginx nginx </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看挂载的路径</span> </span><br><span class="line">[root@kuangshen ~]# docker volume inspect nginxconfig </span><br><span class="line">[ </span><br><span class="line">    &#123; &quot;CreatedAt&quot;: &quot;2020-05-13T17:23:00+08:00&quot;, </span><br><span class="line">    &quot;Driver&quot;: &quot;local&quot;, </span><br><span class="line">    &quot;Labels&quot;: null, </span><br><span class="line">    &quot;Mountpoint&quot;: &quot;/var/lib/docker/volumes/nginxconfig/_data&quot;, </span><br><span class="line">    &quot;Name&quot;: &quot;nginxconfig&quot;, </span><br><span class="line">    &quot;Options&quot;: null, </span><br><span class="line">    &quot;Scope&quot;: &quot;local&quot; </span><br><span class="line">    &#125; </span><br><span class="line">]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">怎么判断挂载的是卷名而不是本机目录名？ 不是/开始就是卷名，是/开始就是目录名</span> </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">改变文件的读写权限</span> </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ro: <span class="built_in">readonly</span></span> </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">rw: readwrite</span> </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">指定容器对我们挂载出来的内容的读写权限</span> </span><br><span class="line">docker run -d -P --name nginx02 -v nginxconfig:/etc/nginx:ro nginx </span><br><span class="line">docker run -d -P --name nginx02 -v nginxconfig:/etc/nginx:rw nginx</span><br></pre></td></tr></table></figure>
<h2 id="数据卷容器"><a href="#数据卷容器" class="headerlink" title="数据卷容器"></a>数据卷容器</h2><p>&gt;</p>
<blockquote>
<p>命名的容器挂载数据卷，其他容器通过挂载这个（父容器）实现数据共享，挂载数据卷的容器，称之为<br>数据卷容器。<br><br>我们使用上一步的镜像：kuangshen/centos 为模板，运行容器 docker01，docker02，docker03，他<br><br>们都会具有容器卷</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;/dataVolumeContainer1&quot; </span><br><span class="line">&quot;/dataVolumeContainer2&quot;</span><br></pre></td></tr></table></figure>
<p>我们来测试下，容器间传递共享</p>
<h3 id="1-、先启动一个父容器docker01，然后在dataVolumeContainer2新增文件"><a href="#1-、先启动一个父容器docker01，然后在dataVolumeContainer2新增文件" class="headerlink" title="1 、先启动一个父容器docker01，然后在dataVolumeContainer2新增文件"></a>1 、先启动一个父容器docker01，然后在dataVolumeContainer2新增文件</h3><p><img src="QQ截图20210720092847.png" alt="输入图片说明"></p>
<p><img src="QQ截图20210720092859.png" alt="输入图片说明"></p>
<h3 id="退出不停止：ctrl-P-Q"><a href="#退出不停止：ctrl-P-Q" class="headerlink" title="退出不停止：ctrl+P+Q"></a>退出不停止：ctrl+P+Q</h3><h3 id="2-、创建docker02，docker03-让他们继承docker01-—volumes-from"><a href="#2-、创建docker02，docker03-让他们继承docker01-—volumes-from" class="headerlink" title="2 、创建docker02，docker03 让他们继承docker01 —volumes-from"></a>2 、创建docker02，docker03 让他们继承docker01 —volumes-from</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@kuangshen docker-test-volume]# docker run -it --name docker02 --volumes-from docker01 kuangshen/centos</span><br><span class="line">[root@ea4c82779077 /]# cd /dataVolumeContainer2</span><br><span class="line">[root@ea4c82779077 dataVolumeContainer2]# ls</span><br><span class="line">docker01.txt</span><br><span class="line">[root@95164598b306 dataVolumeContainer2]# touch docker02.txt</span><br><span class="line">[root@95164598b306 dataVolumeContainer2]# ls</span><br><span class="line">docker01.txt docker02.txt</span><br><span class="line"></span><br><span class="line">[root@kuangshen docker-test-volume]# docker run -it --name docker03 --volumes-from docker01 kuangshen/centos</span><br><span class="line">[root@ea4c82779077 /]# cd /dataVolumeContainer2</span><br><span class="line">[root@ea4c82779077 dataVolumeContainer2]# ls</span><br><span class="line">docker01.txt docker02.txt</span><br><span class="line">[root@95164598b306 dataVolumeContainer2]# touch docker03.txt</span><br><span class="line">[root@95164598b306 dataVolumeContainer2]# ls</span><br><span class="line">docker01.txt docker02.txt docker03.txt</span><br></pre></td></tr></table></figure>
<h3 id="3-、回到docker01发现可以看到-02-和-03-添加的共享文件"><a href="#3-、回到docker01发现可以看到-02-和-03-添加的共享文件" class="headerlink" title="3 、回到docker01发现可以看到 02 和 03 添加的共享文件"></a>3 、回到docker01发现可以看到 02 和 03 添加的共享文件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@kuangshen docker-test-volume]# docker attach docker01</span><br><span class="line">[root@799b6ea5db7c dataVolumeContainer2]# ls -l</span><br><span class="line">total 0</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 13 :20 docker01.txt</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 13 :22 docker02.txt</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 13 :24 docker03.txt</span><br></pre></td></tr></table></figure>
<h3 id="4-、删除docker01，docker02-修改后docker03还能不能访问"><a href="#4-、删除docker01，docker02-修改后docker03还能不能访问" class="headerlink" title="4 、删除docker01，docker02 修改后docker03还能不能访问"></a>4 、删除docker01，docker02 修改后docker03还能不能访问</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@kuangshen docker-test-volume]# docker rm -f docker01</span><br><span class="line">docker01</span><br><span class="line">[root@kuangshen docker-test-volume]# docker attach docker02</span><br><span class="line">[root@ea4c82779077 dataVolumeContainer2]# ls -l</span><br><span class="line">total 0</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 13 :20 docker01.txt</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 13 :22 docker02.txt</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 13 :24 docker03.txt</span><br><span class="line">[root@ea4c82779077 dataVolumeContainer2]# touch docker02-update.txt</span><br><span class="line">[root@ea4c82779077 dataVolumeContainer2]# ls -a</span><br><span class="line">. .. docker01.txt docker02.txt docker02-update.txt docker03.txt</span><br><span class="line">[root@ea4c82779077 dataVolumeContainer2]# Ctrl+P+Q 退出容器</span><br><span class="line">[root@kuangshen docker-test-volume]# docker attach docker03</span><br><span class="line">[root@95164598b306 dataVolumeContainer2]# ls -l</span><br><span class="line">total 0</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 13 :20 docker01.txt</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 13 :22 docker02.txt</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 13 :29 docker02-update.txt</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 13 :24 docker03.txt</span><br></pre></td></tr></table></figure>
<h3 id="5-、删除docker02-，docker03还能不能访问"><a href="#5-、删除docker02-，docker03还能不能访问" class="headerlink" title="5 、删除docker02 ，docker03还能不能访问"></a>5 、删除docker02 ，docker03还能不能访问</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@kuangshen docker-test-volume]<span class="comment"># docker ps</span></span><br><span class="line">CONTAINER ID IMAGE</span><br><span class="line">95164598b306 kuangshen/centos</span><br><span class="line">ea4c82779077 kuangshen/centos</span><br><span class="line">[root@kuangshen docker-test-volume]<span class="comment"># docker rm -f docker02</span></span><br><span class="line">docker02</span><br><span class="line">[root@kuangshen docker-test-volume]<span class="comment"># docker attach docker03</span></span><br><span class="line">[root@95164598b306 dataVolumeContainer2]<span class="comment"># ls -l</span></span><br><span class="line">total 0</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 13 :20 docker01.txt</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 13 :22 docker02.txt</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 13 :29 docker02-update.txt</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 13 :24 docker03.txt</span><br><span class="line">[root@95164598b306 dataVolumeContainer2]<span class="comment"># touch docker03-update.txt</span></span><br></pre></td></tr></table></figure>
<h3 id="6-、新建docker04继承docker03，然后再删除docker03，看下是否可以访问"><a href="#6-、新建docker04继承docker03，然后再删除docker03，看下是否可以访问" class="headerlink" title="6 、新建docker04继承docker03，然后再删除docker03，看下是否可以访问"></a>6 、新建docker04继承docker03，然后再删除docker03，看下是否可以访问</h3><p><img src="QQ截图20210720093327.png" alt="输入图片说明"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@2119f4f23a92 /]# cd dataVolumeContainer2</span><br><span class="line">[root@2119f4f23a92 dataVolumeContainer2]# ls -l</span><br><span class="line">total 0</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 13 :20 docker01.txt</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 13 :22 docker02.txt</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 13 :29 docker02-update.txt</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 13 :32 docker03-update.txt</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 13 :24 docker03.txt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看当前运行的容器</span></span><br><span class="line">[root@kuangshen docker-test-volume]# docker ps</span><br><span class="line">CONTAINER ID IMAGE NAMES</span><br><span class="line">2119f4f23a92 kuangshen/centos docker04</span><br><span class="line">95164598b306 kuangshen/centos docker03</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">继续删除docker03</span></span><br><span class="line">[root@kuangshen docker-test-volume]# docker rm -f docker03</span><br><span class="line">docker03</span><br><span class="line">[root@kuangshen docker-test-volume]# docker attach docker04</span><br><span class="line">[root@2119f4f23a92 dataVolumeContainer2]# ls -l</span><br><span class="line">total 0</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 13 :20 docker01.txt</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 13 :22 docker02.txt</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 13 :29 docker02-update.txt</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 13 :32 docker03-update.txt</span><br><span class="line">-rw-r--r-- 1 root root 0 May 11 13 :24 docker03.txt</span><br></pre></td></tr></table></figure>
<h3 id="得出结论"><a href="#得出结论" class="headerlink" title="得出结论"></a>得出结论</h3><blockquote>
<p>容器之间配置信息的传递，数据卷的生命周期一直持续到没有容器使用它为止。<br><br>存储在本机的文件则会一直保留！</p>
</blockquote>
<h1 id="DockerFile"><a href="#DockerFile" class="headerlink" title="DockerFile"></a>DockerFile</h1><blockquote>
<p>大家想想，Nginx，tomcat，mysql 这些镜像都是哪里来的？官方能写，我们不能写吗？<br><br>我们要研究自己如何做一个镜像，而且我们写的微服务项目以及springboot打包上云部署，Docker就是<br><br>最方便的。<br><br>微服务打包成镜像，任何装了Docker的地方，都可以下载使用，极其的方便。<br><br>流程：开发应用=&gt;DockerFile=&gt;打包为镜像=&gt;上传到仓库（私有仓库，公有仓库）=&gt; 下载镜像 =&gt; 启动<br><br>运行。<br><br>还可以方便移植！<br></p>
</blockquote>
<h2 id="什么是DockerFile"><a href="#什么是DockerFile" class="headerlink" title="什么是DockerFile"></a>什么是DockerFile</h2><p>dockerfile是用来构建Docker镜像的构建文件，是由一系列命令和参数构成的脚本。<br><br>构建步骤：<br></p>
<ul>
<li>1、编写DockerFile文件</li>
<li>2、docker build 构建镜像</li>
<li>3、docker run<br>dockerfile文件我们刚才已经编写过了一次，这里我们继续使用 centos 来看！<br><br>地址：<a target="_blank" rel="noopener" href="https://hub.docker.com/_/centos">https://hub.docker.com/_/centos</a><br><br><img src="QQ截图20210720094253.png" alt="输入图片说明"></li>
</ul>
<p><img src="QQ截图20210720094323.png" alt="输入图片说明"></p>
<h2 id="DockerFile构建过程"><a href="#DockerFile构建过程" class="headerlink" title="DockerFile构建过程"></a>DockerFile构建过程</h2><h3 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h3><ul>
<li>1、每条保留字指令都必须为大写字母且后面要跟随至少一个参数</li>
<li>2、指令按照从上到下，顺序执行</li>
<li>3、# 表示注释</li>
<li>4、每条指令都会创建一个新的镜像层，并对镜像进行提交</li>
</ul>
<h3 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h3><ul>
<li>1、docker从基础镜像运行一个容器</li>
<li>2、执行一条指令并对容器做出修改</li>
<li>3、执行类似 docker commit 的操作提交一个新的镜像层</li>
<li>4、Docker再基于刚提交的镜像运行一个新容器</li>
<li>5、执行dockerfile中的下一条指令直到所有指令都执行完成！</li>
</ul>
<h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><p>&gt;</p>
<blockquote>
<p>从应用软件的角度来看，DockerFile，docker镜像与docker容器分别代表软件的三个不同阶段。<br></p>
</blockquote>
<ul>
<li>DockerFile 是软件的原材料 （代码）<br></li>
<li>Docker 镜像则是软件的交付品 （.apk）<br></li>
<li>Docker 容器则是软件的运行状态 （客户下载安装执行）<br><br>DockerFile 面向开发，Docker镜像成为交付标准，Docker容器则涉及部署与运维，三者缺一不可！<br></li>
</ul>
<p><img src="QQ截图20210720094815.png" alt="输入图片说明"></p>
<blockquote>
<p>DockerFile：需要定义一个DockerFile，DockerFile定义了进程需要的一切东西。DockerFile涉及的内容<br><br>包括执行代码或者是文件、环境变量、依赖包、运行时环境、动态链接库、操作系统的发行版、服务进<br><br>程和内核进程（当引用进行需要和系统服务和内核进程打交道，这时需要考虑如何设计 namespace的权<br><br>限控制）等等。<br><br>Docker镜像：在DockerFile 定义了一个文件之后，Docker build 时会产生一个Docker镜像，当运行<br><br>Docker 镜像时，会真正开始提供服务；<br><br>Docker容器：容器是直接提供服务的。<br></p>
</blockquote>
<h2 id="DockerFile指令"><a href="#DockerFile指令" class="headerlink" title="DockerFile指令"></a>DockerFile指令</h2><h3 id="关键字"><a href="#关键字" class="headerlink" title="关键字"></a>关键字</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">FROM # 基础镜像，当前新镜像是基于哪个镜像的</span><br><span class="line">MAINTAINER # 镜像维护者的姓名混合邮箱地址</span><br><span class="line">RUN  # 容器构建时需要运行的命令</span><br><span class="line">EXPOSE # 当前容器对外保留出的端口</span><br><span class="line">WORKDIR  # 指定在创建容器后，终端默认登录的进来工作目录，一个落脚点</span><br><span class="line">ENV  # 用来在构建镜像过程中设置环境变量</span><br><span class="line">ADD  # 将宿主机目录下的文件拷贝进镜像且ADD命令会自动处理URL和解压tar压缩包</span><br><span class="line">COPY # 类似ADD，拷贝文件和目录到镜像中！</span><br><span class="line">VOLUME # 容器数据卷，用于数据保存和持久化工作</span><br><span class="line">CMD  # 指定一个容器启动时要运行的命令，dockerFile中可以有多个CMD指令，但只有最后一个生效！</span><br><span class="line">ENTRYPOINT # 指定一个容器启动时要运行的命令！和CMD一样</span><br><span class="line">ONBUILD  # 当构建一个被继承的DockerFile时运行命令，父镜像在被子镜像继承后，父镜像的</span><br><span class="line">ONBUILD被触发</span><br></pre></td></tr></table></figure>
<p><img src="QQ截图20210720095101.png" alt="输入图片说明"></p>
<h2 id="实战测试"><a href="#实战测试" class="headerlink" title="实战测试"></a>实战测试</h2><p>Docker Hub 中99% 的镜像都是通过在base镜像（Scratch）中安装和配置需要的软件构建出来的</p>
<p><img src="QQ截图20210720095139.png" alt="输入图片说明"></p>
<h3 id="自定义一个-centos"><a href="#自定义一个-centos" class="headerlink" title="自定义一个 centos"></a>自定义一个 centos</h3><h3 id="1-、编写DockerFile"><a href="#1-、编写DockerFile" class="headerlink" title="1 、编写DockerFile"></a>1 、编写DockerFile</h3><h3 id="查看下官方默认的CentOS的情况"><a href="#查看下官方默认的CentOS的情况" class="headerlink" title="查看下官方默认的CentOS的情况"></a>查看下官方默认的CentOS的情况</h3><p><img src="QQ截图20210720095244.png" alt="输入图片说明"></p>
<h3 id="目的：使我们自己的镜像具备如下：登陆后的默认路径、vim编辑器、查看网络配置ifconfig支持"><a href="#目的：使我们自己的镜像具备如下：登陆后的默认路径、vim编辑器、查看网络配置ifconfig支持" class="headerlink" title="目的：使我们自己的镜像具备如下：登陆后的默认路径、vim编辑器、查看网络配置ifconfig支持"></a>目的：使我们自己的镜像具备如下：登陆后的默认路径、vim编辑器、查看网络配置ifconfig支持</h3><h3 id="准备编写DockerFlie文件"><a href="#准备编写DockerFlie文件" class="headerlink" title="准备编写DockerFlie文件"></a>准备编写DockerFlie文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@kuangshen home]# mkdir dockerfile-test</span><br><span class="line">[root@kuangshen home]# ls</span><br><span class="line">ceshi dockerfile-test docker-test-volume f1</span><br><span class="line">[root@kuangshen home]#</span><br><span class="line">[root@kuangshen home]# vim mydockerfile-centos # 编辑文件</span><br><span class="line">[root@kuangshen home]# cat mydockerfile-centos</span><br><span class="line">FROM centos</span><br><span class="line">MAINTAINER kuangshen&lt;24736743@qq.com&gt;</span><br><span class="line"></span><br><span class="line">ENV MYPATH /usr/local</span><br><span class="line">WORKDIR $MYPATH</span><br><span class="line"></span><br><span class="line">RUN yum -y install vim</span><br><span class="line">RUN yum -y install net-tools</span><br><span class="line"></span><br><span class="line">EXPOSE 80 </span><br><span class="line"></span><br><span class="line">CMD echo $MYPATH </span><br><span class="line">CMD echo &quot;----------end--------&quot; </span><br><span class="line">CMD /bin/bash</span><br></pre></td></tr></table></figure>
<h3 id="2-、构建"><a href="#2-、构建" class="headerlink" title="2 、构建"></a>2 、构建</h3><p>docker build -f dockerfile地址 - t 新镜像名字:TAG.</p>
<p>会看到 docker build 命令最后有一个.. 表示当前目录<em>**</em></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line">[root@kuangshen home]# docker build -f mydockerfile-centos -t mycentos:0.1</span><br><span class="line">Sending build context to Docker daemon 6 .144kB</span><br><span class="line">Step 1 /10 : FROM centos</span><br><span class="line"><span class="meta prompt_">---&gt; </span><span class="language-bash">470671670cac</span></span><br><span class="line">Step 2 /10 : MAINTAINER kuangshen&lt;24736743@qq.com&gt;</span><br><span class="line"><span class="meta prompt_">---&gt; </span><span class="language-bash">Running <span class="keyword">in</span> ac052943c151</span></span><br><span class="line">Removing intermediate container ac052943c151</span><br><span class="line"><span class="meta prompt_">---&gt; </span><span class="language-bash">9d37c7174860</span></span><br><span class="line">Step 3 /10 : ENV MYPATH /usr/local</span><br><span class="line"><span class="meta prompt_">---&gt; </span><span class="language-bash">Running <span class="keyword">in</span> a9d43e0b41bb</span></span><br><span class="line">Removing intermediate container a9d43e0b41bb</span><br><span class="line"><span class="meta prompt_">---&gt; </span><span class="language-bash">7a89b945c3a6</span></span><br><span class="line">Step 4 /10 : WORKDIR $MYPATH</span><br><span class="line"><span class="meta prompt_">---&gt; </span><span class="language-bash">Running <span class="keyword">in</span> b41f085b06bc</span></span><br><span class="line">Removing intermediate container b41f085b06bc</span><br><span class="line"><span class="meta prompt_">---&gt; </span><span class="language-bash">022384682f07</span></span><br><span class="line">Step 5 /10 : RUN yum -y install vim</span><br><span class="line"><span class="meta prompt_">---&gt; </span><span class="language-bash">Running <span class="keyword">in</span> 8a8d351ee43b</span></span><br><span class="line">CentOS-8 - AppStream 2 .7 MB/s | 7 .0 MB 00 :02</span><br><span class="line"></span><br><span class="line">CentOS-8 - Base 1 .1 MB/s | 2 .2 MB 00 :02</span><br><span class="line"></span><br><span class="line">CentOS-8 - Extras 6 .3 kB/s | 5 .9 kB 00 :00</span><br><span class="line"></span><br><span class="line">Dependencies resolved.</span><br><span class="line">===========================================================================</span><br><span class="line">=====</span><br><span class="line">Package Arch Version Repository</span><br><span class="line">Size</span><br><span class="line">===========================================================================</span><br><span class="line">=====</span><br><span class="line">Installing:</span><br><span class="line">vim-enhanced x86_64 2 :8.0.1763-13.el8 AppStream</span><br><span class="line"> 1 .4 M</span><br><span class="line">Installing dependencies:</span><br><span class="line">gpm-libs x86_64 1 .20.7-15.el8 AppStream</span><br><span class="line">39 k</span><br><span class="line">vim-common x86_64 2 :8.0.1763-13.el8 AppStream</span><br><span class="line"> 6 .3 M</span><br><span class="line">vim-filesystem noarch 2 :8.0.1763-13.el8 AppStream</span><br><span class="line">48 k</span><br><span class="line">which x86_64 2 .21-10.el8 BaseOS</span><br><span class="line"> 49 k</span><br><span class="line"></span><br><span class="line">Transaction Summary</span><br><span class="line">===========================================================================</span><br><span class="line">=====</span><br><span class="line">Install 5 Packages</span><br><span class="line"></span><br><span class="line">Total download size: 7 .8 M</span><br><span class="line">Installed size: 31 M</span><br><span class="line">Downloading Packages:</span><br><span class="line">(1/5): gpm-libs-1.20.7-15.el8.x86_64.rpm 815 kB/s | 39 kB 00 :00</span><br><span class="line"></span><br><span class="line">(2/5): vim-filesystem-8.0.1763-13.el8.noarch.rp 2 .1 MB/s | 48 kB 00 :00</span><br><span class="line"></span><br><span class="line">(3/5): which-2.21-10.el8.x86_64.rpm 161 kB/s | 49 kB 00 :00</span><br><span class="line"></span><br><span class="line">(4/5): vim-enhanced-8.0.1763-13.el8.x86_64.rpm 3 .1 MB/s | 1 .4 MB 00 :00</span><br><span class="line"></span><br><span class="line">(5/5): vim-common-8.0.1763-13.el8.x86_64.rpm 1 .4 MB/s | 6 .3 MB 00 :04</span><br><span class="line"></span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">-----</span><br><span class="line">Total 1 .4 MB/s | 7 .8 MB 00 :05</span><br><span class="line"></span><br><span class="line">warning: /var/cache/dnf/AppStream-02e86d1c976ab532/packages/gpm-libs-</span><br><span class="line">1.20.7-15.el8.x86_64.rpm: Header V3 RSA/SHA256 Signature, key ID 8483c65d:</span><br><span class="line">NOKEY</span><br><span class="line">CentOS-8 - AppStream 786 kB/s | 1 .6 kB 00 :00</span><br><span class="line"></span><br><span class="line">Importing GPG key 0x8483C65D:</span><br><span class="line">Userid : &quot;CentOS (CentOS Official Signing Key) &lt;security@centos.org&gt;&quot;</span><br><span class="line">Fingerprint: 99DB 70FA E1D7 CE22 7FB6 4882 05B5 55B3 8483 C65D</span><br><span class="line">From : /etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial</span><br><span class="line">Key imported successfully</span><br><span class="line">Running transaction check</span><br><span class="line">Transaction check succeeded.</span><br><span class="line">Running transaction test</span><br><span class="line">Transaction test succeeded.</span><br><span class="line">Running transaction</span><br><span class="line">Preparing :</span><br><span class="line"> 1 /1</span><br><span class="line">Installing : which-2.21-10.el8.x86_64</span><br><span class="line">1 /5</span><br><span class="line">Installing : vim-filesystem-2:8.0.1763-13.el8.noarch</span><br><span class="line"> 2 /5</span><br><span class="line">Installing : vim-common-2:8.0.1763-13.el8.x86_64</span><br><span class="line"> 3 /5</span><br><span class="line">Installing : gpm-libs-1.20.7-15.el8.x86_64</span><br><span class="line"> 4 /5</span><br><span class="line">Running scriptlet: gpm-libs-1.20.7-15.el8.x86_64</span><br><span class="line"> 4 /5</span><br><span class="line">Installing : vim-enhanced-2:8.0.1763-13.el8.x86_64</span><br><span class="line"> 5 /5</span><br><span class="line">Running scriptlet: vim-enhanced-2:8.0.1763-13.el8.x86_64</span><br><span class="line"> 5 /5</span><br><span class="line">Running scriptlet: vim-common-2:8.0.1763-13.el8.x86_64</span><br><span class="line"> 5 /5</span><br><span class="line">Verifying : gpm-libs-1.20.7-15.el8.x86_64</span><br><span class="line"> 1 /5</span><br><span class="line"></span><br><span class="line">Verifying : vim-common-2:8.0.1763-13.el8.x86_64</span><br><span class="line"> 2 /5</span><br><span class="line">Verifying : vim-enhanced-2:8.0.1763-13.el8.x86_64</span><br><span class="line"> 3 /5</span><br><span class="line">Verifying : vim-filesystem-2:8.0.1763-13.el8.noarch</span><br><span class="line"> 4 /5</span><br><span class="line">Verifying : which-2.21-10.el8.x86_64</span><br><span class="line">5 /5</span><br><span class="line"></span><br><span class="line">Installed:</span><br><span class="line">vim-enhanced-2:8.0.1763-13.el8.x86_64 gpm-libs-1.20.7-15.el8.x86_64</span><br><span class="line"></span><br><span class="line">vim-common-2:8.0.1763-13.el8.x86_64 vim-filesystem-2:8.0.1763-</span><br><span class="line">13.el8.noarch</span><br><span class="line">which-2.21-10.el8.x86_64</span><br><span class="line"></span><br><span class="line">Complete!</span><br><span class="line">Removing intermediate container 8a8d351ee43b</span><br><span class="line"><span class="meta prompt_">---&gt; </span><span class="language-bash">6f6449a55974</span></span><br><span class="line">Step 6 /10 : RUN yum -y install net-tools</span><br><span class="line"><span class="meta prompt_">---&gt; </span><span class="language-bash">Running <span class="keyword">in</span> 4f2c187b0bed</span></span><br><span class="line">Last metadata expiration check: 0 :00:12 ago on Tue May 12 03 :07:25 2020.</span><br><span class="line">Dependencies resolved.</span><br><span class="line">===========================================================================</span><br><span class="line">=====</span><br><span class="line">Package Architecture Version Repository</span><br><span class="line">Size</span><br><span class="line">===========================================================================</span><br><span class="line">=====</span><br><span class="line">Installing:</span><br><span class="line">net-tools x86_64 2 .0-0.51.20160912git.el8 BaseOS</span><br><span class="line">323 k</span><br><span class="line"></span><br><span class="line">Transaction Summary</span><br><span class="line">===========================================================================</span><br><span class="line">=====</span><br><span class="line">Install 1 Package</span><br><span class="line"></span><br><span class="line">Total download size: 323 k</span><br><span class="line">Installed size: 1 .0 M</span><br><span class="line">Downloading Packages:</span><br><span class="line">net-tools-2.0-0.51.20160912git.el8.x86_64.rpm 1 .3 MB/s | 323 kB 00 :00</span><br><span class="line"></span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">-----</span><br><span class="line">Total 397 kB/s | 323 kB 00 :00</span><br><span class="line"></span><br><span class="line">Running transaction check</span><br><span class="line">Transaction check succeeded.</span><br><span class="line">Running transaction test</span><br><span class="line">Transaction test succeeded.</span><br><span class="line">Running transaction</span><br><span class="line">Preparing :</span><br><span class="line"> 1 /1</span><br><span class="line">Installing : net-tools-2.0-0.51.20160912git.el8.x86_64</span><br><span class="line"> 1 /1</span><br><span class="line">Running scriptlet: net-tools-2.0-0.51.20160912git.el8.x86_64</span><br><span class="line"> 1 /1</span><br></pre></td></tr></table></figure>
<h3 id="3-、运行"><a href="#3-、运行" class="headerlink" title="3 、运行"></a>3 、运行</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it 新镜像名字:TAG</span><br></pre></td></tr></table></figure>
<p><img src="QQ截图20210720100037.png" alt="输入图片说明"></p>
<h3 id="可以看到，我们自己的新镜像已经支持-vim-ifconfig的命令，扩展OK"><a href="#可以看到，我们自己的新镜像已经支持-vim-ifconfig的命令，扩展OK" class="headerlink" title="可以看到，我们自己的新镜像已经支持 vim/ifconfig的命令，扩展OK"></a>可以看到，我们自己的新镜像已经支持 vim/ifconfig的命令，扩展OK</h3><h3 id="4-、列出镜像地的变更历史"><a href="#4-、列出镜像地的变更历史" class="headerlink" title="4 、列出镜像地的变更历史"></a>4 、列出镜像地的变更历史</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker history 镜像名</span><br></pre></td></tr></table></figure>
<p><img src="QQ截图20210720100126.png" alt="输入图片说明"></p>
<h3 id="CMD-和-ENTRYPOINT-的区别"><a href="#CMD-和-ENTRYPOINT-的区别" class="headerlink" title="CMD 和 ENTRYPOINT 的区别"></a>CMD 和 ENTRYPOINT 的区别</h3><p>我们之前说过，两个命令都是指定一个容器启动时要运行的命令<br><br>CMD：Dockerfile 中可以有多个CMD 指令，但只有最后一个生效，CMD 会被 docker run 之后的参数<br><br>替换！<br><br>ENTRYPOINT： docker run 之后的参数会被当做参数传递给 ENTRYPOINT，之后形成新的命令组合！<br><br>测试<br></p>
<h3 id="CMD命令"><a href="#CMD命令" class="headerlink" title="CMD命令"></a>CMD命令</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1、构建dockerfile</span></span><br><span class="line">[root@kuangshen home]# vim dockerfile-cmd-test</span><br><span class="line">[root@kuangshen home]# cat dockerfile-cmd-test</span><br><span class="line">FROM centos</span><br><span class="line">CMD [ &quot;ls&quot;, &quot;-a&quot; ]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2、build 镜像</span></span><br><span class="line">[root@kuangshen home]# docker build -f dockerfile-cmd-test -t cmdtest.</span><br><span class="line">Sending build context to Docker daemon 22 .02kB</span><br><span class="line">Step 1 /2 : FROM centos</span><br><span class="line"><span class="meta prompt_">---&gt; </span><span class="language-bash">470671670cac</span></span><br><span class="line">Step 2 /2 : CMD [ &quot;ls&quot;, &quot;-a&quot; ]</span><br><span class="line"><span class="meta prompt_">---&gt; </span><span class="language-bash">Running <span class="keyword">in</span> a3072987de38</span></span><br><span class="line">Removing intermediate container a3072987de38</span><br><span class="line"><span class="meta prompt_">---&gt; </span><span class="language-bash">554bc6952657</span></span><br><span class="line">Successfully built 554bc6952657</span><br><span class="line">Successfully tagged cmdtest:latest</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3、执行</span></span><br><span class="line">[root@kuangshen home]# docker run 554bc6952657</span><br><span class="line">.dockerenv</span><br><span class="line">bin</span><br><span class="line">dev</span><br><span class="line">etc</span><br><span class="line">home</span><br><span class="line">lib</span><br><span class="line">lib64</span><br><span class="line">......</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">4、如果我们希望用 -l 列表展示信息，我们就需要加上 -l参数</span></span><br><span class="line">[root@kuangshen home]# docker run cmdtest -l</span><br><span class="line">docker: Error response from daemon: OCI runtime create failed:</span><br><span class="line">container_linux.go:349: starting container process caused &quot;exec: \&quot;-l\&quot;:</span><br><span class="line">executable file not found in $PATH&quot;: unknown.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">问题：我们可以看到可执行文件找不到的报错，executable file not found。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">之前我们说过，跟在镜像名后面的是 <span class="built_in">command</span>，运行时会替换 CMD 的默认值。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">因此这里的 -l 替换了原来的 CMD，而不是添加在原来的 <span class="built_in">ls</span> -a 后面。而 -l 根本不是命令，所</span></span><br><span class="line">以自然找不到。</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">那么如果我们希望加入 -l 这参数，我们就必须重新完整的输入这个命令：</span></span><br><span class="line"></span><br><span class="line">docker run cmdtest ls -al</span><br></pre></td></tr></table></figure>
<h3 id="ENTRYPOINT命令"><a href="#ENTRYPOINT命令" class="headerlink" title="ENTRYPOINT命令"></a>ENTRYPOINT命令</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1、构建dockerfile</span></span><br><span class="line">[root@kuangshen home]# vim dockerfile-entrypoint-test</span><br><span class="line">[root@kuangshen home]# cat dockerfile-entrypoint-test</span><br><span class="line">FROM centos</span><br><span class="line">ENTRYPOINT [ &quot;ls&quot;, &quot;-a&quot; ]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2、build 镜像</span></span><br><span class="line">[root@kuangshen home]# docker build -f dockerfile-entrypoint-test -t</span><br><span class="line">entrypointtest.</span><br><span class="line">Sending build context to Docker daemon 23 .04kB</span><br><span class="line">Step 1 /2 : FROM centos</span><br><span class="line"><span class="meta prompt_">---&gt; </span><span class="language-bash">470671670cac</span></span><br><span class="line">Step 2 /2 : ENTRYPOINT [ &quot;ls&quot;, &quot;-a&quot; ]</span><br><span class="line"><span class="meta prompt_">---&gt; </span><span class="language-bash">Running <span class="keyword">in</span> bac4ae055630</span></span><br><span class="line">Removing intermediate container bac4ae055630</span><br><span class="line"><span class="meta prompt_">---&gt; </span><span class="language-bash">ae07199f9144</span></span><br><span class="line">Successfully built ae07199f9144</span><br><span class="line">Successfully tagged entrypointtest:latest</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3、执行</span></span><br><span class="line">[root@kuangshen home]# docker run ae07199f9144</span><br><span class="line">.dockerenv</span><br><span class="line">bin</span><br><span class="line">dev</span><br><span class="line">etc</span><br><span class="line">home</span><br><span class="line">lib</span><br><span class="line">lib64</span><br><span class="line">......</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">4、测试-l参数，发现可以直接使用，这里就是一种追加，我们可以明显的知道 CMD 和</span></span><br><span class="line">ENTRYPOINT 的区别了</span><br><span class="line">[root@kuangshen home]# docker run entrypointtest -l</span><br><span class="line">total 56</span><br><span class="line">drwxr-xr-x 1 root root 4096 May 12 04 :21.</span><br><span class="line">drwxr-xr-x 1 root root 4096 May 12 04 :21 ..</span><br><span class="line">-rwxr-xr-x 1 root root 0 May 12 04 :21 .dockerenv</span><br><span class="line">lrwxrwxrwx 1 root root 7 May 11  2019 bin -&gt; usr/bin</span><br><span class="line">drwxr-xr-x 5 root root 340 May 12 04 :21 dev</span><br><span class="line">drwxr-xr-x 1 root root 4096 May 12 04 :21 etc</span><br><span class="line">drwxr-xr-x 2 root root 4096 May 11  2019 home</span><br><span class="line">.....</span><br></pre></td></tr></table></figure>
<h3 id="自定义镜像-tomcat"><a href="#自定义镜像-tomcat" class="headerlink" title="自定义镜像 tomcat"></a>自定义镜像 tomcat</h3><ul>
<li>1、 mkdir -p kuangshen/build/tomcat</li>
<li>2、在上述目录下 touch read.txt</li>
<li>3、将 JDK 和 tomcat 安装的压缩包拷贝进上一步目录</li>
<li>4、在 /kuangshen/build/tomcat 目录下新建一个Dockerfile文件</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">vim Dockerfile</span></span><br><span class="line"></span><br><span class="line">FROM centos</span><br><span class="line">MAINTAINER kuangshen&lt;24736743@qq.com&gt;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">把宿主机当前上下文的read.txt拷贝到容器/usr/local/路径下</span></span><br><span class="line">COPY read.txt /usr/local/cincontainer.txt</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">把java与tomcat添加到容器中</span></span><br><span class="line">ADD jdk-8u11-linux-x64.tar.gz /usr/local/</span><br><span class="line">ADD apache-tomcat-9.0.22.tar.gz /usr/local/</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">安装vim编辑器</span></span><br><span class="line">RUN yum -y install vim</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">设置工作访问时候的WORKDIR路径，登录落脚点</span></span><br><span class="line">ENV MYPATH /usr/local</span><br><span class="line">WORKDIR $MYPATH</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">配置java与tomcat环境变量</span></span><br><span class="line">ENV JAVA_HOME /usr/local/jdk1.8.0_11</span><br><span class="line">ENV CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</span><br><span class="line">ENV CATALINA_HOME /usr/local/apache-tomcat-9.0.22</span><br><span class="line">ENV CATALINA_BASE /usr/local/apache-tomcat-9.0.22</span><br><span class="line">ENV PATH $PATH:$JAVA_HOME/bin:$CATALINA_HOME/lib:$CATALINA_HOME/bin</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">容器运行时监听的端口</span></span><br><span class="line">EXPOSE 8080</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动时运行tomcat</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ENTRYPOINT [<span class="string">&quot;/usr/local/apache-tomcat-9.0.22/bin/startup.sh&quot;</span> ]</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">CMD [<span class="string">&quot;/usr/local/apache-tomcat-9.0.22/bin/catalina.sh&quot;</span>,<span class="string">&quot;run&quot;</span>]</span></span><br><span class="line">CMD /usr/local/apache-tomcat-9.0.22/bin/startup.sh &amp;&amp; tail -F</span><br><span class="line">/usr/local/apache-tomcat-9.0.22/bin/logs/catalina.out</span><br></pre></td></tr></table></figure>
<h3 id="当前文件状态"><a href="#当前文件状态" class="headerlink" title="当前文件状态"></a>当前文件状态</h3><p><img src="QQ截图20210720101049.png" alt="输入图片说明"></p>
<h3 id="5-、构建镜像"><a href="#5-、构建镜像" class="headerlink" title="5 、构建镜像"></a>5 、构建镜像</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@kuangshen tomcat]# docker build -t diytomcat.</span><br><span class="line">.....</span><br><span class="line">Successfully built ffdf6529937d</span><br><span class="line">Successfully tagged diytomcat:latest  # 构建完成</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看确定构建完毕！</span></span><br><span class="line">[root@kuangshen tomcat]# docker images</span><br><span class="line">REPOSITORY TAG IMAGE ID CREATED</span><br><span class="line">SIZE</span><br><span class="line">diytomcat latest ffdf6529937d 20 seconds ago</span><br><span class="line">636MB</span><br></pre></td></tr></table></figure>
<h3 id="6-、运行启动-run"><a href="#6-、运行启动-run" class="headerlink" title="6 、运行启动 run"></a>6 、运行启动 run</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 9090 :8080 --name mydiytomcat -v /home/kuangshen/build/tomcat/test:/usr/local/apache-tomcat-9.0.22/webapps/test -v /home/kuangshen/build/tomcat/tomcat9logs/:/usr/local/apache-tomcat-9.0.22/logs --privileged=true diytomcat</span><br></pre></td></tr></table></figure>
<p><img src="QQ截图20210720101217.png" alt="输入图片说明"></p>
<blockquote>
<p>备注：Docker挂载主机目录Docker访问出现cannot open directory .: Permission denied<br><br>解决办法：在挂载目录后多加一个—privileged=true参数即可</p>
</blockquote>
<h3 id="7-、验证测试访问！-curl-localhost-9090"><a href="#7-、验证测试访问！-curl-localhost-9090" class="headerlink" title="7 、验证测试访问！ curl localhost:9090"></a>7 、验证测试访问！ curl localhost:9090</h3><p><img src="QQ截图20210720101259.png" alt="输入图片说明"></p>
<h3 id="8-、结合前面学习的容器卷将测试的web服务test发布"><a href="#8-、结合前面学习的容器卷将测试的web服务test发布" class="headerlink" title="8 、结合前面学习的容器卷将测试的web服务test发布"></a>8 、结合前面学习的容器卷将测试的web服务test发布</h3><p><img src="QQ截图20210720101311.png" alt="输入图片说明"></p>
<h3 id="web-xml"><a href="#web-xml" class="headerlink" title="web.xml"></a>web.xml</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns</span>=<span class="string">&quot;http://java.sun.com/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://java.sun.com/xml/ns/javaee</span></span></span><br><span class="line"><span class="string"><span class="tag">http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">id</span>=<span class="string">&quot;WebApp_ID&quot;</span> <span class="attr">version</span>=<span class="string">&quot;2.5&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">display-name</span>&gt;</span>test<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="a-jsp"><a href="#a-jsp" class="headerlink" title="a.jsp"></a>a.jsp</h3><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html PUBLIC <span class="string">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span></span><br><span class="line"><span class="string">&quot;http://www.w3.org/TR/html4/loose.dtd&quot;</span>&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">&quot;Content-Type&quot;</span> content=<span class="string">&quot;text/html; charset=UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;hello，kuangshen&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">-----------welcome------------</span><br><span class="line">&lt;%=<span class="string">&quot; my docker tomcat，kuangshen666 &quot;</span>%&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;% System.out.println(<span class="string">&quot;-------my docker tomcat-------&quot;</span>);%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h3 id="9-、测试"><a href="#9-、测试" class="headerlink" title="9 、测试"></a>9 、测试</h3><p><img src="QQ截图20210720101427.png" alt="输入图片说明"></p>
<h4 id="查看日志-1"><a href="#查看日志-1" class="headerlink" title="# 查看日志"></a># 查看日志</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@kuangshen tomcat]# cd tomcat9logs/</span><br><span class="line">[root@kuangshen tomcat9logs]# ll</span><br><span class="line">total 24</span><br><span class="line">-rw-r----- 1 root root 6993 May 12 12 :50 catalina.2020-05-12.log</span><br><span class="line">-rw-r----- 1 root root 7024 May 12 12 :53 catalina.out</span><br><span class="line">-rw-r----- 1 root root 0 May 12 12 :47 host-manager.2020-05-12.log</span><br><span class="line">-rw-r----- 1 root root 408 May 12 12 :47 localhost.2020-05-12.log</span><br><span class="line">-rw-r----- 1 root root 150 May 12 12 :53 localhost_access_log.2020-05-12.txt</span><br><span class="line">-rw-r----- 1 root root 0 May 12 12 :47 manager.2020-05-12.log</span><br><span class="line">[root@kuangshen tomcat9logs]# cat catalina.out</span><br><span class="line">....</span><br><span class="line">-------my docker tomcat-------  # 搞定</span><br></pre></td></tr></table></figure>
<h2 id="发布镜像"><a href="#发布镜像" class="headerlink" title="发布镜像"></a>发布镜像</h2><h3 id="DockerHub"><a href="#DockerHub" class="headerlink" title="DockerHub"></a>DockerHub</h3><h3 id="注册dockerhub-https-hub-docker-com-signup，需要有一个账号"><a href="#注册dockerhub-https-hub-docker-com-signup，需要有一个账号" class="headerlink" title="注册dockerhub https://hub.docker.com/signup，需要有一个账号"></a>注册dockerhub <a target="_blank" rel="noopener" href="https://hub.docker.com/signup，需要有一个账号">https://hub.docker.com/signup，需要有一个账号</a></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1、查看登录命令</span></span><br><span class="line">[root@kuangshen tomcat]# docker login --help</span><br><span class="line">Usage: docker login [OPTIONS] [SERVER]</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2、登录</span></span><br><span class="line">[root@kuangshen tomcat]# docker login -u kuangshen</span><br><span class="line">Password:</span><br><span class="line">WARNING! Your password will be stored unencrypted in</span><br><span class="line">/root/.docker/config.json.</span><br><span class="line">Configure a credential helper to remove this warning. See</span><br><span class="line">https://docs.docker.com/engine/reference/commandline/login/#credentials-</span><br><span class="line">store</span><br><span class="line">Login Succeeded</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3、将镜像发布出去</span></span><br><span class="line">[root@kuangshen tomcat]# docker push kuangshen/diytomcat:1.0</span><br><span class="line">The push refers to repository [docker.io/library/diytomcat]</span><br><span class="line">0f02399c6fdf: Preparing</span><br><span class="line">e79ea0c3a34e: Preparing</span><br><span class="line">09281fa8fe38: Preparing</span><br><span class="line">b56a902b0aef: Preparing</span><br><span class="line">0683de282177: Preparing</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">拒绝：请求的资源访问被拒绝</span></span><br><span class="line">denied: requested access to the resource is denied</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">问题：本地镜像名无帐号信息，解决加 tag即可</span></span><br><span class="line">docker tag 251ca4419332 kuangshen/diytomcat:1.0</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">再次 push， ok</span></span><br><span class="line">[root@kuangshen tomcat]# docker push kuangshen/diytomcat:1.0</span><br><span class="line">The push refers to repository [docker.io/kuangshen/diytomcat]</span><br><span class="line">0f02399c6fdf: Pushing [========&gt; ]</span><br><span class="line"> 9 .729MB/59.76MB</span><br><span class="line">e79ea0c3a34e: Pushing [==========&gt; ]</span><br><span class="line"> 3 .188MB/15.41MB</span><br><span class="line">09281fa8fe38: Pushing [&gt; ]</span><br><span class="line"> 3 .823MB/324MB</span><br><span class="line">b56a902b0aef: Pushed</span><br><span class="line">0683de282177: Pushing [=&gt; ]</span><br><span class="line"> 5 .997MB/237.1MB</span><br></pre></td></tr></table></figure>
<h3 id="阿里云镜像服务"><a href="#阿里云镜像服务" class="headerlink" title="阿里云镜像服务"></a>阿里云镜像服务</h3><ul>
<li>1、登录阿里云</li>
<li>2、找到容器镜像服务<br><img src="QQ截图20210720101724.png" alt="输入图片说明"></li>
</ul>
<h3 id="3-、创建命名空间"><a href="#3-、创建命名空间" class="headerlink" title="3 、创建命名空间"></a>3 、创建命名空间</h3><p><img src="QQ截图20210720101741.png" alt="输入图片说明"></p>
<h3 id="4-、创建镜像仓库"><a href="#4-、创建镜像仓库" class="headerlink" title="4 、创建镜像仓库"></a>4 、创建镜像仓库</h3><p><img src="QQ截图20210720101802.png" alt="输入图片说明"></p>
<p><img src="QQ截图20210720101824.png" alt="输入图片说明"></p>
<h3 id="5-、点击进入这个镜像仓库，可以看到所有的信息"><a href="#5-、点击进入这个镜像仓库，可以看到所有的信息" class="headerlink" title="5 、点击进入这个镜像仓库，可以看到所有的信息"></a>5 、点击进入这个镜像仓库，可以看到所有的信息</h3><p><img src="QQ截图20210720101845.png" alt="输入图片说明"></p>
<h3 id="6-、测试推送发布"><a href="#6-、测试推送发布" class="headerlink" title="6 、测试推送发布"></a>6 、测试推送发布</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@kuangshen tomcat]# docker login --username=18225148644 registry.cn-beijing.aliyuncs.com</span><br><span class="line">Password:</span><br><span class="line">WARNING! Your password will be stored unencrypted in</span><br><span class="line">/root/.docker/config.json.</span><br><span class="line">Configure a credential helper to remove this warning. See</span><br><span class="line">https://docs.docker.com/engine/reference/commandline/login/#credentials-</span><br><span class="line">store</span><br><span class="line"></span><br><span class="line">Login Succeeded</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2、设置 tag</span></span><br><span class="line">docker tag [ImageId] registry.cn-beijing.aliyuncs.com/bilibili-kuangshen/kuangshen-test:[镜像版本号]</span><br><span class="line">[root@kuangshen tomcat]# docker tag 251ca4419332 registry.cn-beijing.aliyuncs.com/bilibili-kuangshen/kuangshen-test:v1.0</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3、推送命令</span></span><br><span class="line">docker push registry.cn-beijing.aliyuncs.com/bilibili-kuangshen/kuangshen-test:[镜像版本号]</span><br><span class="line"></span><br><span class="line">[root@kuangshen tomcat]# docker push registry.cn-beijing.aliyuncs.com/bilibili-kuangshen/kuangshen-test:v1.0</span><br></pre></td></tr></table></figure>
<h3 id="7-、在阿里云镜像仓库查看效果"><a href="#7-、在阿里云镜像仓库查看效果" class="headerlink" title="7 、在阿里云镜像仓库查看效果"></a>7 、在阿里云镜像仓库查看效果</h3><p><img src="QQ截图20210720101953.png" alt="输入图片说明"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p><img src="QQ截图20210720102036.png" alt="输入图片说明"></p>
<h1 id="Docker-网络讲解"><a href="#Docker-网络讲解" class="headerlink" title="Docker-网络讲解"></a>Docker-网络讲解</h1><h2 id="理解Docker0"><a href="#理解Docker0" class="headerlink" title="理解Docker0"></a>理解Docker0</h2><h3 id="准备工作：清空所有的容器，清空所有的镜像"><a href="#准备工作：清空所有的容器，清空所有的镜像" class="headerlink" title="准备工作：清空所有的容器，清空所有的镜像"></a>准备工作：清空所有的容器，清空所有的镜像</h3><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker rm -f $(docker ps -a -q) <span class="comment"># 删除所有容器</span></span><br><span class="line">docker rmi -f $(docker images -qa) <span class="comment"># 删除全部镜像</span></span><br></pre></td></tr></table></figure>
<h3 id="查看本地ip-ip-addr"><a href="#查看本地ip-ip-addr" class="headerlink" title="查看本地ip ip addr"></a>查看本地ip ip addr</h3><p><img src="QQ截图20210720102953.png" alt="输入图片说明"></p>
<p><code>这里我们分析可得，有三个网络</code></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">lo 127.0.0.1 # 本机回环地址</span><br><span class="line">eth0 172 .17.90.138 # 阿里云的私有IP</span><br><span class="line">docker0 172 .18.0.1  # docker网桥</span><br><span class="line"># 问题：Docker 是如何处理容器网络访问的？</span><br></pre></td></tr></table></figure>
<blockquote>
<p>我们之前安装ES的时候，留过一个问题，就是安装Kibana的问题，Kibana得指定ES的地址！或者我们<br><br>实际场景中，我们开发了很多微服务项目，那些微服务项目都要连接数据库，需要指定数据库的url地<br><br>址，通过ip。但是我们用Docker管理的话，假设数据库出问题了，我们重新启动运行一个，这个时候数<br><br>据库的地址就会发生变化，docker会给每个容器都分配一个ip，且容器和容器之间是可以互相访问的。<br><br>我们可以测试下容器之间能不能ping通过：<br></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">启动tomcat01</span></span><br><span class="line">[root@kuangshen ~]# docker run -d -P --name tomcat01 tomcat</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看tomcat01的ip地址，docker会给每个容器都分配一个ip！</span></span><br><span class="line">[root@kuangshen ~]# docker exec -it tomcat01 ip addr</span><br><span class="line">1 : lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group</span><br><span class="line">default qlen 1000</span><br><span class="line">link/loopback 00 :00:00:00:00:00 brd 00 :00:00:00:00:00</span><br><span class="line">inet 127.0.0.1/8 scope host lo</span><br><span class="line">valid_lft forever preferred_lft forever</span><br><span class="line">122 : eth0@if123: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue</span><br><span class="line">state UP group default</span><br><span class="line">link/ether 02 :42:ac:12:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid 0</span><br><span class="line">inet 172 .18.0.2/16 brd 172 .18.255.255 scope global eth0</span><br><span class="line">valid_lft forever preferred_lft forever</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">思考，我们的linux服务器是否可以ping通容器内的tomcat ？</span></span><br><span class="line">[root@kuangshen ~]# ping 172.18.0.2</span><br><span class="line">PING 172 .18.0.2 (172.18.0.2) 56 (84) bytes of data.</span><br><span class="line">64 bytes from 172 .18.0.2: icmp_seq= 1 ttl= 64 time= 0 .070 ms  # 可以ping通！</span><br></pre></td></tr></table></figure>
<h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><ul>
<li>1 、每一个安装了Docker的linux主机都有一个docker0的虚拟网卡。这是个桥接网卡，使用了veth-pair技术</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">我们再次查看主机的 ip addr</span></span><br><span class="line">[root@kuangshen ~]# ip addr</span><br><span class="line">1 : lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group</span><br><span class="line">default qlen 1000</span><br><span class="line">link/loopback 00 :00:00:00:00:00 brd 00 :00:00:00:00:00</span><br><span class="line">inet 127.0.0.1/8 scope host lo</span><br><span class="line">valid_lft forever preferred_lft forever</span><br><span class="line">2 : eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state</span><br><span class="line">UP group default qlen 1000</span><br><span class="line">link/ether 00 :16:3e:30:27:f4 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">inet 172 .17.90.138/20 brd 172 .17.95.255 scope global dynamic eth0</span><br><span class="line">valid_lft 310954997sec preferred_lft 310954997sec</span><br><span class="line">3 : docker0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state</span><br><span class="line">UP group default</span><br><span class="line">link/ether 02 :42:bb:71:07:06 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">inet 172 .18.0.1/16 brd 172 .18.255.255 scope global docker0</span><br><span class="line">valid_lft forever preferred_lft forever</span><br><span class="line">123 : vethc8584ea@if122: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc</span><br><span class="line">noqueue master docker0 state UP group default</span><br><span class="line">link/ether 0a:4b:bb:40:78:a7 brd ff:ff:ff:ff:ff:ff link-netnsid 0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">发现：本来我们有三个网络，我们在启动了个tomcat容器之后，多了一个！ 123 的网络！</span></span><br></pre></td></tr></table></figure>
<ul>
<li>2 、每启动一个容器，linux主机就会多了一个虚拟网卡</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">我们启动了一个tomcat01，主机的ip地址多了一个 123: vethc8584ea@if122</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">然后我们在tomcat01容器中查看容器的ip是 122: eth0@if123</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">我们再启动一个tomcat02观察</span></span><br><span class="line">[root@kuangshen ~]# docker run -d -P --name tomcat02 tomcat</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">然后发现linux主机上又多了一个网卡 125: veth021eeea@if124:</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">我们看下tomcat02的容器内ip地址是 124: eth0@if125:</span></span><br><span class="line">[root@kuangshen ~]# docker exec -it tomcat02 ip addr</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">观察现象：</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tomcat --- linux主机 vethc8584ea@if122 ---- 容器内 eth0@if123</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tomcat --- linux主机 veth021eeea@if124 ---- 容器内 eth0@if125</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">相信到了这里，大家应该能看出点小猫腻了吧！只要启动一个容器，就有一对网卡</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">veth-pair 就是一对的虚拟设备接口，它都是成对出现的。一端连着协议栈，一端彼此相连着。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">正因为有这个特性，它常常充当着一个桥梁，连接着各种虚拟网络设备!</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">“Bridge、OVS 之间的连接”，“Docker 容器之间的连接” 等等，以此构建出非常复杂的虚拟网络结构，比如 OpenStack Neutron。</span></span><br></pre></td></tr></table></figure>
<ul>
<li>3 、我们来测试下tomcat01和tomcat02容器间是否可以互相ping通</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@kuangshen ~]# docker exec -it tomcat02 ping 172.18.0.2</span><br><span class="line">PING 172 .18.0.2 (172.18.0.2) 56 (84) bytes of data.</span><br><span class="line">64 bytes from 172 .18.0.2: icmp_seq= 1 ttl= 64 time= 0 .110 ms</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">结论：容器和容器之间是可以互相访问的。</span></span><br></pre></td></tr></table></figure>
<ul>
<li>4 、我们来画一个网络模型图</li>
</ul>
<p><img src="QQ截图20210720103853.png" alt="输入图片说明"></p>
<blockquote>
<p>结论：tomcat1和tomcat2共用一个路由器。是的，他们使用的一个，就是docker0。任何一个容器启动<br><br>默认都是docker0网络。<br><br>docker默认会给容器分配一个可用ip。<br></p>
</blockquote>
<h3 id="小结-2"><a href="#小结-2" class="headerlink" title="小结"></a>小结</h3><blockquote>
<p>Docker使用Linux桥接，在宿主机虚拟一个Docker容器网桥(docker0)，Docker启动一个容器时会根据<br><br>Docker网桥的网段分配给容器一个IP地址，称为Container-IP，同时Docker网桥是每个容器的默认网<br><br>关。因为在同一宿主机内的容器都接入同一个网桥，这样容器之间就能够通过容器的Container-IP直接<br><br>通信。<br></p>
</blockquote>
<p><img src="QQ截图20210720104149.png" alt="输入图片说明"></p>
<blockquote>
<p>Docker容器网络就很好的利用了Linux虚拟网络技术，在本地主机和容器内分别创建一个虚拟接口，并<br><br>让他们彼此联通（这样一对接口叫veth pair）；<br><br>Docker中的网络接口默认都是虚拟的接口。虚拟接口的优势就是转发效率极高（因为Linux是在内核中<br><br>进行数据的复制来实现虚拟接口之间的数据转发，无需通过外部的网络设备交换），对于本地系统和容<br><br>器系统来说，虚拟接口跟一个正常的以太网卡相比并没有区别，只是他的速度快很多。<br></p>
</blockquote>
<h2 id="—Link"><a href="#—Link" class="headerlink" title="—Link"></a>—Link</h2><blockquote>
<p>思考一个场景，我们编写一个微服务，数据库连接地址原来是使用ip的，如果ip变化就不行了，那我们<br><br>能不能使用服务名访问呢？<br><br><br>jdbc:mysql://mysql:3306，这样的话哪怕mysql重启，我们也不需要修改配置了！docker提供了 —link<br><br>的操作！<br></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">我们使用tomcat02，直接通过容器名ping tomcat01，不使用ip</span></span><br><span class="line">[root@kuangshen ~]# docker exec -it tomcat02 ping tomcat01</span><br><span class="line">ping: tomcat01: Name or service not known  # 发现ping不通</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">我们再启动一个tomcat03，但是启动的时候连接tomcat02</span></span><br><span class="line">[root@kuangshen ~]# docker run -d -P --name tomcat03 --link tomcat02 tomcat</span><br><span class="line">a3a4a17a2b707766ad4f2bb967ce1d94f658cd4cccef3bb8707395cdc71fa1e7</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这个时候，我们就可以使用tomcat03 ping通tomcat02 了</span></span><br><span class="line">[root@kuangshen ~]# docker exec -it tomcat03 ping tomcat02</span><br><span class="line">PING tomcat02 (172.18.0.3) 56 (84) bytes of data.</span><br><span class="line">64 bytes from tomcat02 (172.18.0.3): icmp_seq= 1 ttl= 64 time= 0 .093 ms</span><br><span class="line">64 bytes from tomcat02 (172.18.0.3): icmp_seq= 2 ttl= 64 time= 0 .066 ms</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">再来测试，tomcat03 是否可以ping tomcat01 失败</span></span><br><span class="line">[root@kuangshen ~]# docker exec -it tomcat03 ping tomcat01</span><br><span class="line">ping: tomcat01: Name or service not known</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">再来测试，tomcat02 是否可以ping tomcat03 反向也ping不通</span></span><br><span class="line">[root@kuangshen ~]# docker exec -it tomcat02 ping tomcat03</span><br><span class="line">ping: tomcat03: Name or service not known</span><br></pre></td></tr></table></figure>
<p><code>思考，这个原理是什么呢？我们进入tomcat03中查看下host配置文件</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@kuangshen ~]# docker exec -it tomcat03 cat /etc/hosts</span><br><span class="line">127.0.0.1 localhost</span><br><span class="line">::1 localhost ip6-localhost ip6-loopback</span><br><span class="line">fe00::0 ip6-localnet</span><br><span class="line">ff00::0 ip6-mcastprefix</span><br><span class="line">ff02::1 ip6-allnodes</span><br><span class="line">ff02::2 ip6-allrouters</span><br><span class="line">172 .18.0.3 tomcat02 b80da266a3ad  # 发现tomcat2直接被写在这里</span><br><span class="line">172 .18.0.4 a3a4a17a2b70</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">所以这里其实就是配置了一个 hosts 地址而已！</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">原因：--<span class="built_in">link</span>的时候，直接把需要<span class="built_in">link</span>的主机的域名和ip直接配置到了hosts文件中了。</span></span><br></pre></td></tr></table></figure>
<p><strong><em>—link早都过时了，我们不推荐使用！我们可以使用自定义网络的方式</em></strong></p>
<h2 id="自定义网络"><a href="#自定义网络" class="headerlink" title="自定义网络"></a>自定义网络</h2><h3 id="基本命令查看"><a href="#基本命令查看" class="headerlink" title="基本命令查看"></a>基本命令查看</h3><h3 id="命令如下"><a href="#命令如下" class="headerlink" title="命令如下"></a>命令如下</h3><p><img src="QQ截图20210720104443.png" alt="输入图片说明"></p>
<h3 id="查看所有网络"><a href="#查看所有网络" class="headerlink" title="查看所有网络"></a>查看所有网络</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@kuangshen ~]# docker network ls</span><br><span class="line">NETWORK ID NAME DRIVER SCOPE</span><br><span class="line">4eb2182ac4b2 bridge bridge local</span><br><span class="line">ae2b6209c2ab host host local</span><br><span class="line">c037f7ec7e57 none null local</span><br></pre></td></tr></table></figure>
<h3 id="网络模式"><a href="#网络模式" class="headerlink" title="网络模式"></a>网络模式</h3><p><img src="QQ截图20210720104548.png" alt="输入图片说明"></p>
<h3 id="查看一个具体的网络的详细信息"><a href="#查看一个具体的网络的详细信息" class="headerlink" title="查看一个具体的网络的详细信息"></a>查看一个具体的网络的详细信息</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">命令</span></span><br><span class="line">[root@kuangshen ~]# docker network inspect 4eb2182ac4b2</span><br><span class="line">[</span><br><span class="line">&#123;</span><br><span class="line">&quot;Name&quot;: &quot;bridge&quot;,</span><br><span class="line">&quot;Id&quot;:</span><br><span class="line">&quot;4eb2182ac4b23487e1eb6e06df56c71ab6f0adc7ccc0962b4747d0eed5ad6690&quot;,</span><br><span class="line">&quot;Created&quot;: &quot;2020-05-11T15:44:20.131441544+08:00&quot;,</span><br><span class="line">&quot;Scope&quot;: &quot;local&quot;,</span><br><span class="line">&quot;Driver&quot;: &quot;bridge&quot;,</span><br><span class="line">&quot;EnableIPv6&quot;: false,</span><br><span class="line">&quot;IPAM&quot;: &#123;</span><br><span class="line">&quot;Driver&quot;: &quot;default&quot;,</span><br><span class="line">&quot;Options&quot;: null,</span><br><span class="line">&quot;Config&quot;: [</span><br><span class="line">&#123;</span><br><span class="line">// 默认docker0是管理这个子网范围内的。0~16，也就是 255 *255，去</span><br><span class="line">掉 0 个 255 ，我们有 65534 可以分配的ip</span><br><span class="line">// docker0网络默认可以支持创建 6 万多个容器ip不重复</span><br><span class="line">&quot;Subnet&quot;: &quot;172.18.0.0/16&quot;,</span><br><span class="line">&quot;Gateway&quot;: &quot;172.18.0.1&quot;</span><br><span class="line">&#125;</span><br><span class="line">]</span><br><span class="line">&#125;,</span><br><span class="line">&quot;Internal&quot;: false,</span><br><span class="line">&quot;Attachable&quot;: false,</span><br><span class="line">&quot;Ingress&quot;: false,</span><br><span class="line">&quot;ConfigFrom&quot;: &#123;</span><br><span class="line">&quot;Network&quot;: &quot;&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&quot;ConfigOnly&quot;: false,</span><br><span class="line">&quot;Containers&quot;: &#123;</span><br><span class="line">&quot;a3a4a17a2b707766ad4f2bb967ce1d94f658cd4cccef3bb8707395cdc71fa1e7&quot;: &#123;</span><br><span class="line">&quot;Name&quot;: &quot;tomcat03&quot;,</span><br><span class="line">&quot;EndpointID&quot;:</span><br><span class="line">&quot;5fe62d0be3a1343aa74f6bb77885d3657b191210cafad200e5054e1bdfe56be9&quot;,</span><br><span class="line">&quot;MacAddress&quot;: &quot;02:42:ac:12:00:04&quot;,</span><br><span class="line">&quot;IPv4Address&quot;: &quot;172.18.0.4/16&quot;,</span><br><span class="line">&quot;IPv6Address&quot;: &quot;&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&quot;b80da266a3ad85fcc874c5f0d3c897246ebc40533cb745bb24180237cc3167b1&quot;: &#123;</span><br><span class="line">&quot;Name&quot;: &quot;tomcat02&quot;,</span><br><span class="line">&quot;EndpointID&quot;:</span><br><span class="line">&quot;6232cac0c4e7fed30c9fa5eebc9238f9fc44f548f257344b5440d6d486825256&quot;,</span><br><span class="line">&quot;MacAddress&quot;: &quot;02:42:ac:12:00:03&quot;,</span><br><span class="line">&quot;IPv4Address&quot;: &quot;172.18.0.3/16&quot;,</span><br><span class="line">&quot;IPv6Address&quot;: &quot;&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&quot;f38239e2b405bccf8c93bd1052f336f661033b9b27ef9b3f99a018c108e06f87&quot;: &#123;</span><br><span class="line">&quot;Name&quot;: &quot;tomcat01&quot;,</span><br><span class="line">&quot;EndpointID&quot;:</span><br><span class="line">&quot;31dc174b8f3f15f217acdc3ac7e8a235a03d59438f863706c0143b4426772c5e&quot;,</span><br><span class="line">&quot;MacAddress&quot;: &quot;02:42:ac:12:00:02&quot;,</span><br><span class="line">&quot;IPv4Address&quot;: &quot;172.18.0.2/16&quot;,</span><br><span class="line">&quot;IPv6Address&quot;: &quot;&quot;</span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br><span class="line">&quot;Options&quot;: &#123;</span><br><span class="line">&quot;com.docker.network.bridge.default_bridge&quot;: &quot;true&quot;,</span><br><span class="line">&quot;com.docker.network.bridge.enable_icc&quot;: &quot;true&quot;,</span><br><span class="line">&quot;com.docker.network.bridge.enable_ip_masquerade&quot;: &quot;true&quot;,</span><br><span class="line">&quot;com.docker.network.bridge.host_binding_ipv4&quot;: &quot;0.0.0.0&quot;,</span><br><span class="line">&quot;com.docker.network.bridge.name&quot;: &quot;docker0&quot;,</span><br><span class="line">&quot;com.docker.network.driver.mtu&quot;: &quot;1500&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&quot;Labels&quot;: &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h3 id="自定义网卡"><a href="#自定义网卡" class="headerlink" title="自定义网卡"></a>自定义网卡</h3><ul>
<li>1 、删除原来的所有容器</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@kuangshen ~]# docker rm -f $(docker ps -aq)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">恢复到了最开始的样子</span></span><br><span class="line">[root@kuangshen ~]# ip addr</span><br><span class="line">1 : lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group</span><br><span class="line">default qlen 1000</span><br><span class="line">link/loopback 00 :00:00:00:00:00 brd 00 :00:00:00:00:00</span><br><span class="line">inet 127.0.0.1/8 scope host lo</span><br><span class="line">valid_lft forever preferred_lft forever</span><br><span class="line">2 : eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state</span><br><span class="line">UP group default qlen 1000</span><br><span class="line">link/ether 00 :16:3e:30:27:f4 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">inet 172 .17.90.138/20 brd 172 .17.95.255 scope global dynamic eth0</span><br><span class="line">valid_lft 310951436sec preferred_lft 310951436sec</span><br><span class="line">3 : docker0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state</span><br><span class="line">DOWN group default</span><br><span class="line">link/ether 02 :42:bb:71:07:06 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">inet 172 .18.0.1/16 brd 172 .18.255.255 scope global docker0</span><br><span class="line">valid_lft forever preferred_lft forever</span><br></pre></td></tr></table></figure>
<ul>
<li>2 、接下来我们来创建容器，但是我们知道默认创建的容器都是docker0网卡的</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">默认我们不配置网络，也就相当于默认值 --net bridge 使用的docker0</span></span><br><span class="line">docker run -d -P --name tomcat01 --net bridge tomcat</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">docker0网络的特点</span></span><br><span class="line">    1 .它是默认的</span><br><span class="line">    2 .域名访问不通</span><br><span class="line">    3 .--link 域名通了，但是删了又不行</span><br></pre></td></tr></table></figure>
<ul>
<li>3 、我们可以让容器创建的时候使用自定义网络</li>
</ul>
<p><img src="QQ截图20210720104920.png" alt="输入图片说明"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">自定义创建的默认default <span class="string">&quot;bridge&quot;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">自定义创建一个网络网络</span></span><br><span class="line">[root@kuangshen ~]# docker network create --driver bridge --subnet 192.168.0.0/16 --gateway 192.168.0.1 mynet</span><br><span class="line">09bd09d8d3a6b33e6d19f49643dab551e5a45818baf4d5328aa7320c6dcfc236</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">确认下</span></span><br><span class="line">[root@kuangshen ~]# docker network ls</span><br><span class="line">NETWORK ID NAME DRIVER SCOPE</span><br><span class="line">4eb2182ac4b2 bridge bridge local</span><br><span class="line">ae2b6209c2ab host host local</span><br><span class="line">09bd09d8d3a6 mynet bridge local</span><br><span class="line">c037f7ec7e57 none null local</span><br><span class="line">[root@kuangshen ~]# docker network inspect mynet</span><br><span class="line">[</span><br><span class="line">&#123;</span><br><span class="line">&quot;Name&quot;: &quot;mynet&quot;,</span><br><span class="line">&quot;Id&quot;:</span><br><span class="line">&quot;09bd09d8d3a6b33e6d19f49643dab551e5a45818baf4d5328aa7320c6dcfc236&quot;,</span><br><span class="line">&quot;Created&quot;: &quot;2020-05-13T13:29:33.568644836+08:00&quot;,</span><br><span class="line">&quot;Scope&quot;: &quot;local&quot;,</span><br><span class="line">&quot;Driver&quot;: &quot;bridge&quot;,</span><br><span class="line">&quot;EnableIPv6&quot;: false,</span><br><span class="line">&quot;IPAM&quot;: &#123;</span><br><span class="line">&quot;Driver&quot;: &quot;default&quot;,</span><br><span class="line">&quot;Options&quot;: &#123;&#125;,</span><br><span class="line">&quot;Config&quot;: [</span><br><span class="line">&#123;</span><br><span class="line">&quot;Subnet&quot;: &quot;192.168.0.0/16&quot;,</span><br><span class="line">&quot;Gateway&quot;: &quot;192.168.0.1&quot;</span><br><span class="line">&#125;</span><br><span class="line">]</span><br><span class="line">&#125;,</span><br><span class="line">&quot;Internal&quot;: false,</span><br><span class="line">&quot;Attachable&quot;: false,</span><br><span class="line">&quot;Ingress&quot;: false,</span><br><span class="line">&quot;ConfigFrom&quot;: &#123;</span><br><span class="line">&quot;Network&quot;: &quot;&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&quot;ConfigOnly&quot;: false,</span><br><span class="line">&quot;Containers&quot;: &#123;&#125;,</span><br><span class="line">&quot;Options&quot;: &#123;&#125;,</span><br><span class="line">&quot;Labels&quot;: &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">]</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">我们来启动两个容器测试，使用自己的 mynet！</span></span><br><span class="line">[root@kuangshen ~]# docker run -d -P --name tomcat-net-01 --net mynet tomcat</span><br><span class="line">065f82e947c760c63539ab4c0de0d683787ec7ac6d0dcaa71f64e191319f9fe7</span><br><span class="line">[root@kuangshen ~]# docker run -d -P --name tomcat-net-02 --net mynet tomcat</span><br><span class="line">2e85d71afe87c87166786b0bbae2d90eefb969d716fcd78a21173add5956cb12</span><br><span class="line">[root@kuangshen ~]# docker ps</span><br><span class="line">CONTAINER ID IMAGE PORTS NAMES</span><br><span class="line">2e85d71afe87 tomcat 0 .0.0.0:32772-&gt;8080/tcp tomcat-net-02</span><br><span class="line">065f82e947c7 tomcat 0 .0.0.0:32771-&gt;8080/tcp tomcat-net-01</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">再来查看下</span></span><br><span class="line">[root@kuangshen ~]# docker network inspect mynet</span><br><span class="line">[</span><br><span class="line">&#123;</span><br><span class="line">&quot;Name&quot;: &quot;mynet&quot;,</span><br><span class="line">&quot;Id&quot;:</span><br><span class="line">&quot;09bd09d8d3a6b33e6d19f49643dab551e5a45818baf4d5328aa7320c6dcfc236&quot;,</span><br><span class="line">............</span><br><span class="line">&quot;Containers&quot;: &#123;</span><br><span class="line">&quot;065f82e947c760c63539ab4c0de0d683787ec7ac6d0dcaa71f64e191319f9fe7&quot;: &#123;</span><br><span class="line">&quot;Name&quot;: &quot;tomcat-net-01&quot;,</span><br><span class="line">&quot;EndpointID&quot;:</span><br><span class="line">&quot;d61cef1bc294d7f10fb6d9b728735fc87bed79e4e02f5298374f0fab3e9b2da6&quot;,</span><br><span class="line">&quot;MacAddress&quot;: &quot;02:42:c0:a8:00:02&quot;,</span><br><span class="line">&quot;IPv4Address&quot;: &quot;192.168.0.2/16&quot;,</span><br><span class="line">&quot;IPv6Address&quot;: &quot;&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&quot;2e85d71afe87c87166786b0bbae2d90eefb969d716fcd78a21173add5956cb12&quot;: &#123;</span><br><span class="line">&quot;Name&quot;: &quot;tomcat-net-02&quot;,</span><br><span class="line">&quot;EndpointID&quot;:</span><br><span class="line">&quot;adbc37a20526c2985c3589382998a3d106ef722662c7b296a57d8a7c8f449f38&quot;,</span><br><span class="line">&quot;MacAddress&quot;: &quot;02:42:c0:a8:00:03&quot;,</span><br><span class="line">&quot;IPv4Address&quot;: &quot;192.168.0.3/16&quot;,</span><br><span class="line">&quot;IPv6Address&quot;: &quot;&quot;</span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br><span class="line">&quot;Options&quot;: &#123;&#125;,</span><br><span class="line">&quot;Labels&quot;: &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">]</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">我们来测试ping容器名和ip试试，都可以ping通</span></span><br><span class="line">[root@kuangshen ~]# docker exec -it tomcat-net-01 ping 192.168.0.3</span><br><span class="line">PING 192 .168.0.3 (192.168.0.3) 56 (84) bytes of data.</span><br><span class="line">64 bytes from 192 .168.0.3: icmp_seq= 1 ttl= 64 time= 0 .093 ms</span><br><span class="line"></span><br><span class="line">[root@kuangshen ~]# docker exec -it tomcat-net-01 ping tomcat-net-02</span><br><span class="line">PING tomcat-net-02 (192.168.0.3) 56 (84) bytes of data.</span><br><span class="line">64 bytes from tomcat-net-02.mynet (192.168.0.3): icmp_seq= 1 ttl= 64</span><br><span class="line">time= 0 .063 ms</span><br><span class="line">64 bytes from tomcat-net-02.mynet (192.168.0.3): icmp_seq= 2 ttl= 64</span><br><span class="line">time= 0 .066 ms</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">发现，我们自定义的网络docker都已经帮我们维护好了对应的关系</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">所以我们平时都可以这样使用网络，不使用--<span class="built_in">link</span>效果一样，所有东西实时维护好，直接域名 ping通。</span></span><br></pre></td></tr></table></figure>
<h2 id="网络连通"><a href="#网络连通" class="headerlink" title="网络连通"></a>网络连通</h2><p><img src="QQ截图20210720105221.png" alt="输入图片说明"></p>
<blockquote>
<p>docker0和自定义网络肯定不通，我们使用自定义网络的好处就是网络隔离：<br><br><br>大家公司项目部署的业务都非常多，假设我们有一个商城，我们会有订单业务（操作不同数据），会有<br><br>订单业务购物车业务（操作不同缓存）。如果在一个网络下，有的程序猿的恶意代码就不能防止了，所<br><br>以我们就在部署的时候网络隔离，创建两个桥接网卡，比如订单业务（里面的数据库，redis，mq，全<br><br>部业务 都在order-net网络下）其他业务在其他网络。<br><br>那关键的问题来了，如何让 tomcat-net-01 访问 tomcat1？<br></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">启动默认的容器，在docker0网络下</span></span><br><span class="line">[root@kuangshen ~]# docker run -d -P --name tomcat01 tomcat</span><br><span class="line">bcd122e0dcf6bf8c861eaa934911f98a5497a4954f3fde9575e496160bd23287</span><br><span class="line">[root@kuangshen ~]# docker run -d -P --name tomcat02 tomcat</span><br><span class="line">6183aaeca003a3e5a3549a37f9c1040551320ae358807b4aaad547a986afb887</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">### # 查看当前的容器</span></span></span><br><span class="line">[root@kuangshen ~]# docker ps</span><br><span class="line">CONTAINER ID IMAGE PORTS NAMES</span><br><span class="line">6183aaeca003 tomcat 0 .0.0.0:32774-&gt;8080/tcp tomcat02</span><br><span class="line">bcd122e0dcf6 tomcat 0 .0.0.0:32773-&gt;8080/tcp tomcat01</span><br><span class="line">2e85d71afe87 tomcat 0 .0.0.0:32772-&gt;8080/tcp tomcat-</span><br><span class="line">net-02</span><br><span class="line">065f82e947c7 tomcat 0 .0.0.0:32771-&gt;8080/tcp tomcat-</span><br><span class="line">net-01</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">我们来查看下network帮助，发现一个命令 connect</span></span><br><span class="line">[root@kuangshen ~]# docker network --help</span><br><span class="line">Commands:</span><br><span class="line">connect Connect a container to a network  # 连接一个容器到一个网络</span><br><span class="line">create Create a network</span><br><span class="line">disconnect Disconnect a container from a network</span><br><span class="line">inspect Display detailed information on one or more networks</span><br><span class="line">ls List networks</span><br><span class="line">prune Remove all unused networks</span><br><span class="line">rm Remove one or more networks</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">我们来测试一下！打通mynet-docker0</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">命令 docker network connect [OPTIONS] NETWORK CONTAINER</span></span><br><span class="line"></span><br><span class="line">[root@kuangshen ~]# docker network connect mynet tomcat01</span><br><span class="line">[root@kuangshen ~]# docker network inspect mynet</span><br><span class="line">[</span><br><span class="line">&#123;</span><br><span class="line">......</span><br><span class="line">&quot;Containers&quot;: &#123;</span><br><span class="line">&quot;065f82e947c760c63539ab4c0de0d683787ec7ac6d0dcaa71f64e191319f9fe7&quot;: &#123;</span><br><span class="line">&quot;Name&quot;: &quot;tomcat-net-01&quot;,</span><br><span class="line">&quot;EndpointID&quot;:</span><br><span class="line">&quot;d61cef1bc294d7f10fb6d9b728735fc87bed79e4e02f5298374f0fab3e9b2da6&quot;,</span><br><span class="line">&quot;MacAddress&quot;: &quot;02:42:c0:a8:00:02&quot;,</span><br><span class="line">&quot;IPv4Address&quot;: &quot;192.168.0.2/16&quot;,</span><br><span class="line">&quot;IPv6Address&quot;: &quot;&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&quot;2e85d71afe87c87166786b0bbae2d90eefb969d716fcd78a21173add5956cb12&quot;: &#123;</span><br><span class="line">&quot;Name&quot;: &quot;tomcat-net-02&quot;,</span><br><span class="line">&quot;EndpointID&quot;:</span><br><span class="line">&quot;adbc37a20526c2985c3589382998a3d106ef722662c7b296a57d8a7c8f449f38&quot;,</span><br><span class="line">&quot;MacAddress&quot;: &quot;02:42:c0:a8:00:03&quot;,</span><br><span class="line">&quot;IPv4Address&quot;: &quot;192.168.0.3/16&quot;,</span><br><span class="line">&quot;IPv6Address&quot;: &quot;&quot;</span><br><span class="line">&#125;,</span><br><span class="line">// 发现我们的tomcat01就进来这里了，tomcat01拥有了双ip</span><br><span class="line">&quot;bcd122e0dcf6bf8c861eaa934911f98a5497a4954f3fde9575e496160bd23287&quot;: &#123;</span><br><span class="line">&quot;Name&quot;: &quot;tomcat01&quot;,</span><br><span class="line">&quot;EndpointID&quot;:</span><br><span class="line">&quot;b2bf2342948e17048d872a4d5603c77e90d0e032439d510e86c10a1acc3928d9&quot;,</span><br><span class="line">&quot;MacAddress&quot;: &quot;02:42:c0:a8:00:04&quot;,</span><br><span class="line">&quot;IPv4Address&quot;: &quot;192.168.0.4/16&quot;,</span><br><span class="line">&quot;IPv6Address&quot;: &quot;&quot;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line">]</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tomcat01 可以ping通了</span></span><br><span class="line">[root@kuangshen ~]# docker exec -it tomcat01 ping tomcat-net-01</span><br><span class="line">PING tomcat-net-01 (192.168.0.2) 56 (84) bytes of data.</span><br><span class="line">64 bytes from tomcat-net-01.mynet (192.168.0.2): icmp_seq= 1 ttl= 64</span><br><span class="line">time= 0 .071 ms</span><br><span class="line">64 bytes from tomcat-net-01.mynet (192.168.0.2): icmp_seq= 2 ttl= 64</span><br><span class="line">time= 0 .067 ms</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tomcat02 依旧ping不通，大家应该就理解了</span></span><br><span class="line">[root@kuangshen ~]# docker exec -it tomcat02 ping tomcat-net-01</span><br><span class="line">ping: tomcat-net-01: Name or service not known</span><br></pre></td></tr></table></figure>
<p><code>结论：如果要跨网络操作别人，就需要使用 docker network connect [OPTIONS] NETWORK CONTAINER 连接</code></p>
<h2 id="实战：部署一个Redis集群"><a href="#实战：部署一个Redis集群" class="headerlink" title="实战：部署一个Redis集群"></a>实战：部署一个Redis集群</h2><p><img src="QQ截图20210720105609.png" alt="输入图片说明"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建网卡</span></span><br><span class="line">docker network create redis --subnet 172 .38.0.0/16</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">通过脚本创建六个redis配置</span></span><br><span class="line">for port in $(seq 1 6); \</span><br><span class="line">do \</span><br><span class="line">mkdir -p /mydata/redis/node-$&#123;port&#125;/conf</span><br><span class="line">touch /mydata/redis/node-$&#123;port&#125;/conf/redis.conf</span><br><span class="line">cat &lt;&lt; EOF &gt;/mydata/redis/node-$&#123;port&#125;/conf/redis.conf</span><br><span class="line">port 6379</span><br><span class="line">bind 0 .0.0.0</span><br><span class="line">cluster-enabled yes</span><br><span class="line">cluster-config-file nodes.conf</span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line">cluster-announce-ip 172 .38.0.1$&#123;port&#125;</span><br><span class="line">cluster-announce-port 6379</span><br><span class="line">cluster-announce-bus-port 16379</span><br><span class="line">appendonly yes</span><br><span class="line">EOF</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">docker run -p 637 $&#123;port&#125;:6379 -p 1637 $&#123;port&#125;:16379 --name redis-$&#123;port&#125; \</span><br><span class="line">-v /mydata/redis/node-$&#123;port&#125;/data:/data \</span><br><span class="line">-v /mydata/redis/node-$&#123;port&#125;/conf/redis.conf:/etc/redis/redis.conf \</span><br><span class="line">-d --net redis --ip 172 .38.0.1$&#123;port&#125; redis:5.0.9-alpine3.11 redis-server/etc/redis/redis.conf; \</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">启动 6 个容器</span></span><br><span class="line">docker run -p 6371 :6379 -p 16371 :16379 --name redis-1 \</span><br><span class="line">-v /mydata/redis/node-1/data:/data \</span><br><span class="line">-v /mydata/redis/node-1/conf/redis.conf:/etc/redis/redis.conf \</span><br><span class="line">-d --net redis --ip 172 .38.0.11 redis:5.0.9-alpine3.11 redis-server/etc/redis/redis.conf</span><br><span class="line"></span><br><span class="line">docker run -p 6376 :6379 -p 16376 :16379 --name redis-6 \</span><br><span class="line">-v /mydata/redis/node-6/data:/data \</span><br><span class="line">-v /mydata/redis/node-6/conf/redis.conf:/etc/redis/redis.conf \</span><br><span class="line">-d --net redis --ip 172 .38.0.16 redis:5.0.9-alpine3.11 redis-server/etc/redis/redis.conf</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">进入一个redis，注意这里是 sh命令</span></span><br><span class="line">docker exec -it redis-1 /bin/sh</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建集群</span></span><br><span class="line">redis-cli --cluster create 172.38.0.11:6379 172.38.0.12:6379 172.38.0.13:6379 172.38.0.14:6379 172.38.0.15:6379 172.38.0.16:6379 --cluster-replicas 1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">连接集群</span></span><br><span class="line">redis-cli -c</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看集群信息</span></span><br><span class="line">cluster info</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看节点</span></span><br><span class="line">cluster nodes</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">set</span> a b</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">停止到存值的容器</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">然后再次get a，发现依旧可以获取值</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看节点，发现高可用完全没问题</span></span><br></pre></td></tr></table></figure>
<h1 id="IDEA整合Docker"><a href="#IDEA整合Docker" class="headerlink" title="IDEA整合Docker"></a>IDEA整合Docker</h1><h2 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h2><ul>
<li>1、使用 IDEA 构建一个 SpringBoot 项目</li>
<li>2、编写一个helloController</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">()</span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;hello,kuangshen&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>3 、启动测试下，端口修改下，避免 8080 冲突！本地访问没问题就可以</p>
</li>
<li><p>4 、打jar包</p>
</li>
</ul>
<p><img src="QQ截图20210720110400.png" alt="输入图片说明"></p>
<p>有了 jar 包，我们就可以作镜像了！ 记得测试一下jar包可以使用吗</p>
<h2 id="打包镜像"><a href="#打包镜像" class="headerlink" title="打包镜像"></a>打包镜像</h2><ul>
<li>1 、在项目下编写 Dockerfile 文件，将打包好的jar包拷贝到Dockerfile同级目录</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">FROM java:8</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">服务器只有dockerfile和jar在同级目录</span></span><br><span class="line">COPY *.jar /app.jar</span><br><span class="line"></span><br><span class="line">CMD [&quot;--server.port=8080&quot;]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">指定容器内要暴露的端口</span></span><br><span class="line">EXPOSE 8080</span><br><span class="line"></span><br><span class="line">ENTRYPOINT [&quot;java&quot;,&quot;-jar&quot;,&quot;/app.jar&quot;]</span><br></pre></td></tr></table></figure>
<ul>
<li>2 、将Dockerfile 和 项目的 jar 包上传到linux服务器上，构建运行</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@kuangshen idea]# pwd</span><br><span class="line">/home/idea</span><br><span class="line">[root@kuangshen idea]# ll</span><br><span class="line">total 17228</span><br><span class="line">-rw-r--r-- 1 root root 17634294 May 14 12 :33 demo-0.0.1-SNAPSHOT.jar</span><br><span class="line">-rw-r--r-- 1 root root 207 May 14 12 :32 Dockerfile</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">构建镜像</span></span><br><span class="line">docker build -t idea-ks.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看镜像</span></span><br><span class="line">docker images</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">运行</span></span><br><span class="line">docker run -d -P --name idea-ks idea-ks</span><br><span class="line"></span><br><span class="line">[root@kuangshen ~]# docker ps</span><br><span class="line">CONTAINER ID IMAGE PORTS NAMES</span><br><span class="line">2366c960ba99 idea-ks 0 .0.0.0:32779-&gt;8080/tcp idea-ks1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">测试访问</span></span><br><span class="line">[root@kuangshen ~]# curl localhost:32779</span><br><span class="line">[root@kuangshen ~]# curl localhost:32779/hello</span><br></pre></td></tr></table></figure>
<h2 id="IDEA安装插件"><a href="#IDEA安装插件" class="headerlink" title="IDEA安装插件"></a>IDEA安装插件</h2><p><strong><em>了解即可！以后CI/CD，就完全没必要这样做</em></strong></p>
<h3 id="1-、IDEA安装插件"><a href="#1-、IDEA安装插件" class="headerlink" title="1 、IDEA安装插件"></a>1 、IDEA安装插件</h3><p><img src="QQ截图20210720110711.png" alt="输入图片说明"></p>
<h3 id="2-、配置docker连接集成"><a href="#2-、配置docker连接集成" class="headerlink" title="2 、配置docker连接集成"></a>2 、配置docker连接集成</h3><p><img src="QQ截图20210720110736.png" alt="输入图片说明"></p>
<h3 id="3-、集成了docker插件就可以在IDEA中操作Docker内部的容器和镜像了，但是很鸡肋这个功能，对于我们开发人员来说"><a href="#3-、集成了docker插件就可以在IDEA中操作Docker内部的容器和镜像了，但是很鸡肋这个功能，对于我们开发人员来说" class="headerlink" title="3 、集成了docker插件就可以在IDEA中操作Docker内部的容器和镜像了，但是很鸡肋这个功能，对于我们开发人员来说"></a>3 、集成了docker插件就可以在IDEA中操作Docker内部的容器和镜像了，但是很鸡肋这个功能，对于我们开发人员来说</h3><p><strong><em>之后学习的CI/CD才是真正在企业中的王道</em></strong></p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/" rel="tag"># 快速入门</a>
              <a href="/tags/docker/" rel="tag"># docker</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2025/02/06/mysql%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/" rel="prev" title="mysql快速入门">
      <i class="fa fa-chevron-left"></i> mysql快速入门
    </a></div>
      <div class="post-nav-item">
    <a href="/2025/02/07/diffusion%E5%BF%85%E8%AF%BB%E8%AE%BA%E6%96%87/" rel="next" title="diffusion必读论文">
      diffusion必读论文 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Docker%E6%A6%82%E8%BF%B0"><span class="nav-number">1.</span> <span class="nav-text">Docker概述</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker%E4%B8%BA%E4%BB%80%E4%B9%88%E5%87%BA%E7%8E%B0"><span class="nav-number">1.1.</span> <span class="nav-text">Docker为什么出现</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%86%E5%8F%B2"><span class="nav-number">1.1.1.</span> <span class="nav-text">历史</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#docker-%E7%90%86%E5%BF%B5"><span class="nav-number">1.1.2.</span> <span class="nav-text">docker 理念</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker%E8%83%BD%E5%B9%B2%E5%98%9B"><span class="nav-number">1.2.</span> <span class="nav-text">Docker能干嘛</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B9%8B%E5%89%8D%E7%9A%84%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%8A%80%E6%9C%AF"><span class="nav-number">1.2.1.</span> <span class="nav-text">之前的虚拟机技术</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8%E8%99%9A%E6%8B%9F%E5%8C%96%E6%8A%80%E6%9C%AF"><span class="nav-number">1.2.2.</span> <span class="nav-text">容器虚拟化技术</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%80%E5%8F%91-%E8%BF%90%E7%BB%B4%EF%BC%88DevOps%EF%BC%89"><span class="nav-number">1.2.3.</span> <span class="nav-text">开发&#x2F;运维（DevOps）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9B%B4%E5%BF%AB%E9%80%9F%E7%9A%84%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E5%92%8C%E9%83%A8%E7%BD%B2"><span class="nav-number">1.2.3.1.</span> <span class="nav-text">更快速的应用交付和部署</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9B%B4%E4%BE%BF%E6%8D%B7%E7%9A%84%E5%8D%87%E7%BA%A7%E5%92%8C%E6%89%A9%E7%BC%A9%E5%AE%B9"><span class="nav-number">1.2.3.2.</span> <span class="nav-text">更便捷的升级和扩缩容</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9B%B4%E7%AE%80%E5%8D%95%E7%9A%84%E7%B3%BB%E7%BB%9F%E8%BF%90%E7%BB%B4"><span class="nav-number">1.2.3.3.</span> <span class="nav-text">更简单的系统运维</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9B%B4%E9%AB%98%E6%95%88%E7%9A%84%E8%AE%A1%E7%AE%97%E8%B5%84%E6%BA%90%E5%88%A9%E7%94%A8"><span class="nav-number">1.2.3.4.</span> <span class="nav-text">更高效的计算资源利用</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%A6%E4%B9%A0%E9%80%94%E5%BE%84"><span class="nav-number">1.2.4.</span> <span class="nav-text">学习途径</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Docker%E5%AE%89%E8%A3%85"><span class="nav-number">2.</span> <span class="nav-text">Docker安装</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%BB%84%E6%88%90"><span class="nav-number">2.1.</span> <span class="nav-text">Docker的基本组成</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker%E7%9A%84%E6%9E%B6%E6%9E%84%E5%9B%BE"><span class="nav-number">2.1.1.</span> <span class="nav-text">Docker的架构图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%95%9C%E5%83%8F%EF%BC%88image%EF%BC%89"><span class="nav-number">2.1.2.</span> <span class="nav-text">镜像（image）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8%EF%BC%88container%EF%BC%89"><span class="nav-number">2.1.3.</span> <span class="nav-text">容器（container）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%93%E5%BA%93%EF%BC%88repository%EF%BC%89"><span class="nav-number">2.1.4.</span> <span class="nav-text">仓库（repository）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93"><span class="nav-number">2.1.5.</span> <span class="nav-text">小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E8%AF%B4%E6%98%8E"><span class="nav-number">2.2.</span> <span class="nav-text">环境说明</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E8%87%AA%E5%B7%B1%E7%9A%84%E5%86%85%E6%A0%B8"><span class="nav-number">2.2.1.</span> <span class="nav-text">查看自己的内核</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%89%88%E6%9C%AC%E4%BF%A1%E6%81%AF"><span class="nav-number">2.2.2.</span> <span class="nav-text">查看版本信息</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4"><span class="nav-number">2.3.</span> <span class="nav-text">安装步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1%E3%80%81%E5%AE%98%E7%BD%91%E5%AE%89%E8%A3%85%E5%8F%82%E8%80%83%E6%89%8B%E5%86%8C%EF%BC%9Ahttps-docs-docker-com-engine-install-centos"><span class="nav-number">2.3.1.</span> <span class="nav-text">1、官网安装参考手册：https:&#x2F;&#x2F;docs.docker.com&#x2F;engine&#x2F;install&#x2F;centos&#x2F; </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2%E3%80%81%E7%A1%AE%E5%AE%9A%E4%BD%A0%E6%98%AFCentOS7%E5%8F%8A%E4%BB%A5%E4%B8%8A%E7%89%88%E6%9C%AC%EF%BC%8C%E6%88%91%E4%BB%AC%E5%B7%B2%E7%BB%8F%E5%81%9A%E8%BF%87%E4%BA%86"><span class="nav-number">2.3.2.</span> <span class="nav-text">2、确定你是CentOS7及以上版本，我们已经做过了</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3%E3%80%81yum%E5%AE%89%E8%A3%85gcc%E7%9B%B8%E5%85%B3%E7%8E%AF%E5%A2%83%EF%BC%88%E9%9C%80%E8%A6%81%E7%A1%AE%E4%BF%9D-%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%8F%AF%E4%BB%A5%E4%B8%8A%E5%A4%96%E7%BD%91-%EF%BC%89"><span class="nav-number">2.3.3.</span> <span class="nav-text">3、yum安装gcc相关环境（需要确保 虚拟机可以上外网 ）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E3%80%81%E5%8D%B8%E8%BD%BD%E6%97%A7%E7%89%88%E6%9C%AC"><span class="nav-number">2.3.4.</span> <span class="nav-text">4 、卸载旧版本</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E3%80%81%E5%AE%89%E8%A3%85%E9%9C%80%E8%A6%81%E7%9A%84%E8%BD%AF%E4%BB%B6%E5%8C%85"><span class="nav-number">2.3.5.</span> <span class="nav-text">5 、安装需要的软件包</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-%E3%80%81%E8%AE%BE%E7%BD%AE%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93"><span class="nav-number">2.3.6.</span> <span class="nav-text">6 、设置镜像仓库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-%E3%80%81%E6%9B%B4%E6%96%B0yum%E8%BD%AF%E4%BB%B6%E5%8C%85%E7%B4%A2%E5%BC%95"><span class="nav-number">2.3.7.</span> <span class="nav-text">7 、更新yum软件包索引</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-%E3%80%81%E5%AE%89%E8%A3%85-Docker-CE"><span class="nav-number">2.3.8.</span> <span class="nav-text">8 、安装 Docker CE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-%E3%80%81%E5%90%AF%E5%8A%A8-Docker"><span class="nav-number">2.3.9.</span> <span class="nav-text">9 、启动 Docker</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10-%E3%80%81%E6%B5%8B%E8%AF%95%E5%91%BD%E4%BB%A4"><span class="nav-number">2.3.10.</span> <span class="nav-text">10 、测试命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#11-%E3%80%81%E5%8D%B8%E8%BD%BD"><span class="nav-number">2.3.11.</span> <span class="nav-text">11 、卸载</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%98%BF%E9%87%8C%E4%BA%91%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F"><span class="nav-number">2.4.</span> <span class="nav-text">阿里云镜像加速</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E3%80%81%E4%BB%8B%E7%BB%8D%EF%BC%9Ahttps-www-aliyun-com-product-acr"><span class="nav-number">2.4.1.</span> <span class="nav-text">1 、介绍：https:&#x2F;&#x2F;www.aliyun.com&#x2F;product&#x2F;acr</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E3%80%81%E6%B3%A8%E5%86%8C%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84%E9%98%BF%E9%87%8C%E4%BA%91%E8%B4%A6%E6%88%B7-%E5%8F%AF%E5%A4%8D%E7%94%A8%E6%B7%98%E5%AE%9D%E8%B4%A6%E5%8F%B7"><span class="nav-number">2.4.2.</span> <span class="nav-text">2 、注册一个属于自己的阿里云账户(可复用淘宝账号)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E3%80%81%E8%BF%9B%E5%85%A5%E7%AE%A1%E7%90%86%E6%8E%A7%E5%88%B6%E5%8F%B0%E8%AE%BE%E7%BD%AE%E5%AF%86%E7%A0%81%EF%BC%8C%E5%BC%80%E9%80%9A"><span class="nav-number">2.4.3.</span> <span class="nav-text">3 、进入管理控制台设置密码，开通</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E3%80%81%E6%9F%A5%E7%9C%8B%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F%E5%99%A8%E8%87%AA%E5%B7%B1%E7%9A%84"><span class="nav-number">2.4.4.</span> <span class="nav-text">4 、查看镜像加速器自己的</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E3%80%81%E9%85%8D%E7%BD%AE%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F"><span class="nav-number">2.4.5.</span> <span class="nav-text">5 、配置镜像加速</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95-HelloWorld"><span class="nav-number">2.4.6.</span> <span class="nav-text">测试 HelloWorld</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E3%80%81%E5%90%AF%E5%8A%A8hello-world"><span class="nav-number">2.4.7.</span> <span class="nav-text">1 、启动hello-world</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E3%80%81run%E5%B9%B2%E4%BA%86%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="nav-number">2.4.8.</span> <span class="nav-text">2 、run干了什么？</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86"><span class="nav-number">2.5.</span> <span class="nav-text">底层原理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker%E6%98%AF%E6%80%8E%E4%B9%88%E5%B7%A5%E4%BD%9C%E7%9A%84"><span class="nav-number">2.5.1.</span> <span class="nav-text">Docker是怎么工作的</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88Docker%E6%AF%94%E8%BE%83-VM-%E5%BF%AB"><span class="nav-number">2.5.2.</span> <span class="nav-text">为什么Docker比较 VM 快</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Docker%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="nav-number">3.</span> <span class="nav-text">Docker常用命令</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%AE%E5%8A%A9%E5%91%BD%E4%BB%A4"><span class="nav-number">3.1.</span> <span class="nav-text">帮助命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%95%9C%E5%83%8F%E5%91%BD%E4%BB%A4"><span class="nav-number">3.2.</span> <span class="nav-text">镜像命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#docker-images"><span class="nav-number">3.2.1.</span> <span class="nav-text">docker images</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#docker-search"><span class="nav-number">3.2.2.</span> <span class="nav-text">docker search</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#docker-pull"><span class="nav-number">3.2.3.</span> <span class="nav-text">docker pull</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#docker-rmi"><span class="nav-number">3.2.4.</span> <span class="nav-text">docker rmi</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8%E5%91%BD%E4%BB%A4"><span class="nav-number">3.3.</span> <span class="nav-text">容器命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%B4%E6%98%8E%EF%BC%9A%E6%9C%89%E9%95%9C%E5%83%8F%E6%89%8D%E8%83%BD%E5%88%9B%E5%BB%BA%E5%AE%B9%E5%99%A8%EF%BC%8C%E6%88%91%E4%BB%AC%E8%BF%99%E9%87%8C%E4%BD%BF%E7%94%A8-centos-%E7%9A%84%E9%95%9C%E5%83%8F%E6%9D%A5%E6%B5%8B%E8%AF%95%EF%BC%8C%E5%B0%B1%E6%98%AF%E8%99%9A%E6%8B%9F%E4%B8%80%E4%B8%AA-centos"><span class="nav-number">3.3.1.</span> <span class="nav-text">说明：有镜像才能创建容器，我们这里使用 centos 的镜像来测试，就是虚拟一个 centos</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B0%E5%BB%BA%E5%AE%B9%E5%99%A8%E5%B9%B6%E5%90%AF%E5%8A%A8"><span class="nav-number">3.3.2.</span> <span class="nav-text">新建容器并启动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%97%E5%87%BA%E6%89%80%E6%9C%89%E8%BF%90%E8%A1%8C%E7%9A%84%E5%AE%B9%E5%99%A8"><span class="nav-number">3.3.3.</span> <span class="nav-text">列出所有运行的容器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%80%E5%87%BA%E5%AE%B9%E5%99%A8"><span class="nav-number">3.3.4.</span> <span class="nav-text">退出容器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E5%81%9C%E6%AD%A2%E5%AE%B9%E5%99%A8"><span class="nav-number">3.3.5.</span> <span class="nav-text">启动停止容器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E5%AE%B9%E5%99%A8"><span class="nav-number">3.3.6.</span> <span class="nav-text">删除容器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E5%85%B6%E4%BB%96%E5%91%BD%E4%BB%A4"><span class="nav-number">3.4.</span> <span class="nav-text">常用其他命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%8E%E5%8F%B0%E5%90%AF%E5%8A%A8%E5%AE%B9%E5%99%A8"><span class="nav-number">3.4.1.</span> <span class="nav-text">后台启动容器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E6%97%A5%E5%BF%97"><span class="nav-number">3.4.2.</span> <span class="nav-text">查看日志</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E5%AE%B9%E5%99%A8%E4%B8%AD%E8%BF%90%E8%A1%8C%E7%9A%84%E8%BF%9B%E7%A8%8B%E4%BF%A1%E6%81%AF%EF%BC%8C%E6%94%AF%E6%8C%81-ps-%E5%91%BD%E4%BB%A4%E5%8F%82%E6%95%B0"><span class="nav-number">3.4.3.</span> <span class="nav-text">查看容器中运行的进程信息，支持 ps 命令参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E5%AE%B9%E5%99%A8-%E9%95%9C%E5%83%8F%E7%9A%84%E5%85%83%E6%95%B0%E6%8D%AE"><span class="nav-number">3.4.4.</span> <span class="nav-text">查看容器&#x2F;镜像的元数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9B%E5%85%A5%E6%AD%A3%E5%9C%A8%E8%BF%90%E8%A1%8C%E7%9A%84%E5%AE%B9%E5%99%A8"><span class="nav-number">3.4.5.</span> <span class="nav-text">进入正在运行的容器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%8E%E5%AE%B9%E5%99%A8%E5%86%85%E6%8B%B7%E8%B4%9D%E6%96%87%E4%BB%B6%E5%88%B0%E4%B8%BB%E6%9C%BA%E4%B8%8A"><span class="nav-number">3.4.6.</span> <span class="nav-text">从容器内拷贝文件到主机上</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93-1"><span class="nav-number">3.5.</span> <span class="nav-text">小结</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="nav-number">3.5.1.</span> <span class="nav-text">常用命令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%9C%E4%B8%9A%E7%BB%83%E4%B9%A0"><span class="nav-number">3.6.</span> <span class="nav-text">作业练习</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8Docker-%E5%AE%89%E8%A3%85-Nginx"><span class="nav-number">3.6.1.</span> <span class="nav-text">使用Docker 安装 Nginx</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8docker%E5%AE%89%E8%A3%85-tomcat"><span class="nav-number">3.6.2.</span> <span class="nav-text">使用docker安装 tomcat</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8docker-%E9%83%A8%E7%BD%B2-es-kibana"><span class="nav-number">3.6.3.</span> <span class="nav-text">使用docker 部署 es + kibana</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%AF%E8%A7%86%E5%8C%96"><span class="nav-number">3.7.</span> <span class="nav-text">可视化</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Portainer%EF%BC%88%E5%85%88%E7%94%A8%E8%BF%99%E4%B8%AA%EF%BC%89"><span class="nav-number">3.7.1.</span> <span class="nav-text">Portainer（先用这个）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Rancher%EF%BC%88CI-CD%E5%86%8D%E7%94%A8%E8%BF%99%E4%B8%AA%EF%BC%89"><span class="nav-number">3.7.2.</span> <span class="nav-text">Rancher（CI&#x2F;CD再用这个）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%8B%E7%BB%8D"><span class="nav-number">3.7.3.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BF%E9%97%AE%E6%96%B9%E5%BC%8F%EF%BC%9Ahttp-IP-8088"><span class="nav-number">3.7.4.</span> <span class="nav-text">访问方式：http:&#x2F;&#x2F;IP:8088</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A6%96%E6%AC%A1%E7%99%BB%E9%99%86%E9%9C%80%E8%A6%81%E6%B3%A8%E5%86%8C%E7%94%A8%E6%88%B7%EF%BC%8C%E7%BB%99admin%E7%94%A8%E6%88%B7%E8%AE%BE%E7%BD%AE%E5%AF%86%E7%A0%81"><span class="nav-number">3.7.5.</span> <span class="nav-text">首次登陆需要注册用户，给admin用户设置密码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E6%9C%BA%E7%89%88%E8%BF%99%E9%87%8C%E9%80%89%E6%8B%A9local%E5%8D%B3%E5%8F%AF%EF%BC%8C%E9%80%89%E6%8B%A9%E5%AE%8C%E6%AF%95%EF%BC%8C%E7%82%B9%E5%87%BBConnect%E5%8D%B3%E5%8F%AF%E8%BF%9E%E6%8E%A5%E5%88%B0%E6%9C%AC%E5%9C%B0docker"><span class="nav-number">3.7.6.</span> <span class="nav-text">单机版这里选择local即可，选择完毕，点击Connect即可连接到本地docker</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%99%BB%E5%BD%95%E6%88%90%E5%8A%9F"><span class="nav-number">3.7.7.</span> <span class="nav-text">登录成功</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E7%82%B9%E5%87%BB%E5%8F%AF%E8%A7%86%E5%8C%96%E7%95%8C%E9%9D%A2%E6%9D%A5%E7%8E%A9%E7%8E%A9"><span class="nav-number">3.7.8.</span> <span class="nav-text">我们可以点击可视化界面来玩玩</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Docker%E9%95%9C%E5%83%8F%E8%AE%B2%E8%A7%A3"><span class="nav-number">4.</span> <span class="nav-text">Docker镜像讲解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%95%9C%E5%83%8F%E6%98%AF%E4%BB%80%E4%B9%88"><span class="nav-number">4.1.</span> <span class="nav-text">镜像是什么</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker%E9%95%9C%E5%83%8F%E5%8A%A0%E8%BD%BD%E5%8E%9F%E7%90%86"><span class="nav-number">4.2.</span> <span class="nav-text">Docker镜像加载原理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#UnionFS-%EF%BC%88%E8%81%94%E5%90%88%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%EF%BC%89"><span class="nav-number">4.2.1.</span> <span class="nav-text">UnionFS （联合文件系统）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker%E9%95%9C%E5%83%8F%E5%8A%A0%E8%BD%BD%E5%8E%9F%E7%90%86-1"><span class="nav-number">4.2.2.</span> <span class="nav-text">Docker镜像加载原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B9%B3%E6%97%B6%E6%88%91%E4%BB%AC%E5%AE%89%E8%A3%85%E8%BF%9B%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9A%84CentOS%E9%83%BD%E6%98%AF%E5%A5%BD%E5%87%A0%E4%B8%AAG%EF%BC%8C%E4%B8%BA%E4%BB%80%E4%B9%88Docker%E8%BF%99%E9%87%8C%E6%89%8D200M%EF%BC%9F"><span class="nav-number">4.2.3.</span> <span class="nav-text">平时我们安装进虚拟机的CentOS都是好几个G，为什么Docker这里才200M？</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E5%B1%82%E7%90%86%E8%A7%A3"><span class="nav-number">4.3.</span> <span class="nav-text">分层理解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E5%B1%82%E7%9A%84%E9%95%9C%E5%83%8F"><span class="nav-number">4.3.1.</span> <span class="nav-text">分层的镜像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%90%86%E8%A7%A3"><span class="nav-number">4.3.2.</span> <span class="nav-text">理解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%89%B9%E7%82%B9"><span class="nav-number">4.3.3.</span> <span class="nav-text">特点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%95%9C%E5%83%8FCommit"><span class="nav-number">4.4.</span> <span class="nav-text">镜像Commit</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#docker-commit-%E4%BB%8E%E5%AE%B9%E5%99%A8%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%96%B0%E7%9A%84%E9%95%9C%E5%83%8F"><span class="nav-number">4.4.1.</span> <span class="nav-text">docker commit 从容器创建一个新的镜像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95"><span class="nav-number">4.4.2.</span> <span class="nav-text">测试</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="nav-number">5.</span> <span class="nav-text">容器数据卷</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%AE%B9%E5%99%A8%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="nav-number">5.1.</span> <span class="nav-text">什么是容器数据卷</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#docker%E7%9A%84%E7%90%86%E5%BF%B5%E5%9B%9E%E9%A1%BE"><span class="nav-number">5.1.1.</span> <span class="nav-text">docker的理念回顾</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%9C%E7%94%A8%EF%BC%9A"><span class="nav-number">5.1.2.</span> <span class="nav-text">作用：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%89%B9%E7%82%B9-1"><span class="nav-number">5.1.3.</span> <span class="nav-text">特点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%80%E4%BB%A5%EF%BC%9A%E6%80%BB%E7%BB%93%E4%B8%80%E5%8F%A5%E8%AF%9D%EF%BC%9A-%E5%B0%B1%E6%98%AF%E5%AE%B9%E5%99%A8%E7%9A%84%E6%8C%81%E4%B9%85%E5%8C%96%EF%BC%8C%E4%BB%A5%E5%8F%8A%E5%AE%B9%E5%99%A8%E9%97%B4%E7%9A%84%E7%BB%A7%E6%89%BF%E5%92%8C%E6%95%B0%E6%8D%AE%E5%85%B1%E4%BA%AB"><span class="nav-number">5.1.4.</span> <span class="nav-text">所以：总结一句话： 就是容器的持久化，以及容器间的继承和数据共享</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="nav-number">5.2.</span> <span class="nav-text">使用数据卷</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B9%E5%BC%8F%E4%B8%80%EF%BC%9A%E5%AE%B9%E5%99%A8%E4%B8%AD%E7%9B%B4%E6%8E%A5%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4%E6%9D%A5%E6%B7%BB%E5%8A%A0"><span class="nav-number">5.2.1.</span> <span class="nav-text">方式一：容器中直接使用命令来添加</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%82%E8%BD%BD"><span class="nav-number">5.2.2.</span> <span class="nav-text">挂载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE%E5%8D%B7%E6%98%AF%E5%90%A6%E6%8C%82%E8%BD%BD%E6%88%90%E5%8A%9F-docker-inspect-%E5%AE%B9%E5%99%A8id"><span class="nav-number">5.2.3.</span> <span class="nav-text">查看数据卷是否挂载成功 docker inspect 容器id</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95%E5%AE%B9%E5%99%A8%E5%92%8C%E5%AE%BF%E4%B8%BB%E6%9C%BA%E4%B9%8B%E9%97%B4%E6%95%B0%E6%8D%AE%E5%85%B1%E4%BA%AB%EF%BC%9A%E5%8F%AF%E4%BB%A5%E5%8F%91%E7%8E%B0%EF%BC%8C%E5%9C%A8%E5%AE%B9%E5%99%A8%E4%B8%AD%EF%BC%8C%E5%88%9B%E5%BB%BA%E7%9A%84%E4%BC%9A%E5%9C%A8%E5%AE%BF%E4%B8%BB%E6%9C%BA%E4%B8%AD%E7%9C%8B%E5%88%B0"><span class="nav-number">5.2.4.</span> <span class="nav-text">测试容器和宿主机之间数据共享：可以发现，在容器中，创建的会在宿主机中看到</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95%E5%AE%B9%E5%99%A8%E5%81%9C%E6%AD%A2%E9%80%80%E5%87%BA%E5%90%8E%EF%BC%8C%E4%B8%BB%E6%9C%BA%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE%E6%98%AF%E5%90%A6%E4%BC%9A%E5%90%8C%E6%AD%A5"><span class="nav-number">5.2.5.</span> <span class="nav-text">测试容器停止退出后，主机修改数据是否会同步</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-docker-%E5%AE%89%E8%A3%85-mysql"><span class="nav-number">5.2.6.</span> <span class="nav-text">使用 docker 安装 mysql</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%9D%E8%80%83%EF%BC%9Amysql-%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%8C%96%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-number">5.2.7.</span> <span class="nav-text">思考：mysql 数据持久化的问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E8%BF%87Docker-File-%E6%9D%A5%E6%B7%BB%E5%8A%A0%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="nav-number">5.2.8.</span> <span class="nav-text">通过Docker File 来添加（了解）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%8D%B7%E5%AE%B9%E5%99%A8"><span class="nav-number">5.3.</span> <span class="nav-text">数据卷容器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E3%80%81%E5%85%88%E5%90%AF%E5%8A%A8%E4%B8%80%E4%B8%AA%E7%88%B6%E5%AE%B9%E5%99%A8docker01%EF%BC%8C%E7%84%B6%E5%90%8E%E5%9C%A8dataVolumeContainer2%E6%96%B0%E5%A2%9E%E6%96%87%E4%BB%B6"><span class="nav-number">5.3.1.</span> <span class="nav-text">1 、先启动一个父容器docker01，然后在dataVolumeContainer2新增文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%80%E5%87%BA%E4%B8%8D%E5%81%9C%E6%AD%A2%EF%BC%9Actrl-P-Q"><span class="nav-number">5.3.2.</span> <span class="nav-text">退出不停止：ctrl+P+Q</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E3%80%81%E5%88%9B%E5%BB%BAdocker02%EF%BC%8Cdocker03-%E8%AE%A9%E4%BB%96%E4%BB%AC%E7%BB%A7%E6%89%BFdocker01-%E2%80%94volumes-from"><span class="nav-number">5.3.3.</span> <span class="nav-text">2 、创建docker02，docker03 让他们继承docker01 —volumes-from</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E3%80%81%E5%9B%9E%E5%88%B0docker01%E5%8F%91%E7%8E%B0%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0-02-%E5%92%8C-03-%E6%B7%BB%E5%8A%A0%E7%9A%84%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6"><span class="nav-number">5.3.4.</span> <span class="nav-text">3 、回到docker01发现可以看到 02 和 03 添加的共享文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E3%80%81%E5%88%A0%E9%99%A4docker01%EF%BC%8Cdocker02-%E4%BF%AE%E6%94%B9%E5%90%8Edocker03%E8%BF%98%E8%83%BD%E4%B8%8D%E8%83%BD%E8%AE%BF%E9%97%AE"><span class="nav-number">5.3.5.</span> <span class="nav-text">4 、删除docker01，docker02 修改后docker03还能不能访问</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E3%80%81%E5%88%A0%E9%99%A4docker02-%EF%BC%8Cdocker03%E8%BF%98%E8%83%BD%E4%B8%8D%E8%83%BD%E8%AE%BF%E9%97%AE"><span class="nav-number">5.3.6.</span> <span class="nav-text">5 、删除docker02 ，docker03还能不能访问</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-%E3%80%81%E6%96%B0%E5%BB%BAdocker04%E7%BB%A7%E6%89%BFdocker03%EF%BC%8C%E7%84%B6%E5%90%8E%E5%86%8D%E5%88%A0%E9%99%A4docker03%EF%BC%8C%E7%9C%8B%E4%B8%8B%E6%98%AF%E5%90%A6%E5%8F%AF%E4%BB%A5%E8%AE%BF%E9%97%AE"><span class="nav-number">5.3.7.</span> <span class="nav-text">6 、新建docker04继承docker03，然后再删除docker03，看下是否可以访问</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BE%97%E5%87%BA%E7%BB%93%E8%AE%BA"><span class="nav-number">5.3.8.</span> <span class="nav-text">得出结论</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#DockerFile"><span class="nav-number">6.</span> <span class="nav-text">DockerFile</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFDockerFile"><span class="nav-number">6.1.</span> <span class="nav-text">什么是DockerFile</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DockerFile%E6%9E%84%E5%BB%BA%E8%BF%87%E7%A8%8B"><span class="nav-number">6.2.</span> <span class="nav-text">DockerFile构建过程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="nav-number">6.2.1.</span> <span class="nav-text">基础知识</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%81%E7%A8%8B"><span class="nav-number">6.2.2.</span> <span class="nav-text">流程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%B4%E6%98%8E"><span class="nav-number">6.2.3.</span> <span class="nav-text">说明</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DockerFile%E6%8C%87%E4%BB%A4"><span class="nav-number">6.3.</span> <span class="nav-text">DockerFile指令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%94%AE%E5%AD%97"><span class="nav-number">6.3.1.</span> <span class="nav-text">关键字</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E6%88%98%E6%B5%8B%E8%AF%95"><span class="nav-number">6.4.</span> <span class="nav-text">实战测试</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AA-centos"><span class="nav-number">6.4.1.</span> <span class="nav-text">自定义一个 centos</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E3%80%81%E7%BC%96%E5%86%99DockerFile"><span class="nav-number">6.4.2.</span> <span class="nav-text">1 、编写DockerFile</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E4%B8%8B%E5%AE%98%E6%96%B9%E9%BB%98%E8%AE%A4%E7%9A%84CentOS%E7%9A%84%E6%83%85%E5%86%B5"><span class="nav-number">6.4.3.</span> <span class="nav-text">查看下官方默认的CentOS的情况</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%AE%E7%9A%84%EF%BC%9A%E4%BD%BF%E6%88%91%E4%BB%AC%E8%87%AA%E5%B7%B1%E7%9A%84%E9%95%9C%E5%83%8F%E5%85%B7%E5%A4%87%E5%A6%82%E4%B8%8B%EF%BC%9A%E7%99%BB%E9%99%86%E5%90%8E%E7%9A%84%E9%BB%98%E8%AE%A4%E8%B7%AF%E5%BE%84%E3%80%81vim%E7%BC%96%E8%BE%91%E5%99%A8%E3%80%81%E6%9F%A5%E7%9C%8B%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AEifconfig%E6%94%AF%E6%8C%81"><span class="nav-number">6.4.4.</span> <span class="nav-text">目的：使我们自己的镜像具备如下：登陆后的默认路径、vim编辑器、查看网络配置ifconfig支持</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%86%E5%A4%87%E7%BC%96%E5%86%99DockerFlie%E6%96%87%E4%BB%B6"><span class="nav-number">6.4.5.</span> <span class="nav-text">准备编写DockerFlie文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E3%80%81%E6%9E%84%E5%BB%BA"><span class="nav-number">6.4.6.</span> <span class="nav-text">2 、构建</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E3%80%81%E8%BF%90%E8%A1%8C"><span class="nav-number">6.4.7.</span> <span class="nav-text">3 、运行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%EF%BC%8C%E6%88%91%E4%BB%AC%E8%87%AA%E5%B7%B1%E7%9A%84%E6%96%B0%E9%95%9C%E5%83%8F%E5%B7%B2%E7%BB%8F%E6%94%AF%E6%8C%81-vim-ifconfig%E7%9A%84%E5%91%BD%E4%BB%A4%EF%BC%8C%E6%89%A9%E5%B1%95OK"><span class="nav-number">6.4.8.</span> <span class="nav-text">可以看到，我们自己的新镜像已经支持 vim&#x2F;ifconfig的命令，扩展OK</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E3%80%81%E5%88%97%E5%87%BA%E9%95%9C%E5%83%8F%E5%9C%B0%E7%9A%84%E5%8F%98%E6%9B%B4%E5%8E%86%E5%8F%B2"><span class="nav-number">6.4.9.</span> <span class="nav-text">4 、列出镜像地的变更历史</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CMD-%E5%92%8C-ENTRYPOINT-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">6.4.10.</span> <span class="nav-text">CMD 和 ENTRYPOINT 的区别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CMD%E5%91%BD%E4%BB%A4"><span class="nav-number">6.4.11.</span> <span class="nav-text">CMD命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ENTRYPOINT%E5%91%BD%E4%BB%A4"><span class="nav-number">6.4.12.</span> <span class="nav-text">ENTRYPOINT命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E9%95%9C%E5%83%8F-tomcat"><span class="nav-number">6.4.13.</span> <span class="nav-text">自定义镜像 tomcat</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BD%93%E5%89%8D%E6%96%87%E4%BB%B6%E7%8A%B6%E6%80%81"><span class="nav-number">6.4.14.</span> <span class="nav-text">当前文件状态</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E3%80%81%E6%9E%84%E5%BB%BA%E9%95%9C%E5%83%8F"><span class="nav-number">6.4.15.</span> <span class="nav-text">5 、构建镜像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-%E3%80%81%E8%BF%90%E8%A1%8C%E5%90%AF%E5%8A%A8-run"><span class="nav-number">6.4.16.</span> <span class="nav-text">6 、运行启动 run</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-%E3%80%81%E9%AA%8C%E8%AF%81%E6%B5%8B%E8%AF%95%E8%AE%BF%E9%97%AE%EF%BC%81-curl-localhost-9090"><span class="nav-number">6.4.17.</span> <span class="nav-text">7 、验证测试访问！ curl localhost:9090</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-%E3%80%81%E7%BB%93%E5%90%88%E5%89%8D%E9%9D%A2%E5%AD%A6%E4%B9%A0%E7%9A%84%E5%AE%B9%E5%99%A8%E5%8D%B7%E5%B0%86%E6%B5%8B%E8%AF%95%E7%9A%84web%E6%9C%8D%E5%8A%A1test%E5%8F%91%E5%B8%83"><span class="nav-number">6.4.18.</span> <span class="nav-text">8 、结合前面学习的容器卷将测试的web服务test发布</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-xml"><span class="nav-number">6.4.19.</span> <span class="nav-text">web.xml</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#a-jsp"><span class="nav-number">6.4.20.</span> <span class="nav-text">a.jsp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-%E3%80%81%E6%B5%8B%E8%AF%95"><span class="nav-number">6.4.21.</span> <span class="nav-text">9 、测试</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E6%97%A5%E5%BF%97-1"><span class="nav-number">6.4.21.1.</span> <span class="nav-text"># 查看日志</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%91%E5%B8%83%E9%95%9C%E5%83%8F"><span class="nav-number">6.5.</span> <span class="nav-text">发布镜像</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#DockerHub"><span class="nav-number">6.5.1.</span> <span class="nav-text">DockerHub</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%A8%E5%86%8Cdockerhub-https-hub-docker-com-signup%EF%BC%8C%E9%9C%80%E8%A6%81%E6%9C%89%E4%B8%80%E4%B8%AA%E8%B4%A6%E5%8F%B7"><span class="nav-number">6.5.2.</span> <span class="nav-text">注册dockerhub https:&#x2F;&#x2F;hub.docker.com&#x2F;signup，需要有一个账号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%98%BF%E9%87%8C%E4%BA%91%E9%95%9C%E5%83%8F%E6%9C%8D%E5%8A%A1"><span class="nav-number">6.5.3.</span> <span class="nav-text">阿里云镜像服务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E3%80%81%E5%88%9B%E5%BB%BA%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4"><span class="nav-number">6.5.4.</span> <span class="nav-text">3 、创建命名空间</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E3%80%81%E5%88%9B%E5%BB%BA%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93"><span class="nav-number">6.5.5.</span> <span class="nav-text">4 、创建镜像仓库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E3%80%81%E7%82%B9%E5%87%BB%E8%BF%9B%E5%85%A5%E8%BF%99%E4%B8%AA%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93%EF%BC%8C%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%E6%89%80%E6%9C%89%E7%9A%84%E4%BF%A1%E6%81%AF"><span class="nav-number">6.5.6.</span> <span class="nav-text">5 、点击进入这个镜像仓库，可以看到所有的信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-%E3%80%81%E6%B5%8B%E8%AF%95%E6%8E%A8%E9%80%81%E5%8F%91%E5%B8%83"><span class="nav-number">6.5.7.</span> <span class="nav-text">6 、测试推送发布</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-%E3%80%81%E5%9C%A8%E9%98%BF%E9%87%8C%E4%BA%91%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93%E6%9F%A5%E7%9C%8B%E6%95%88%E6%9E%9C"><span class="nav-number">6.5.8.</span> <span class="nav-text">7 、在阿里云镜像仓库查看效果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">6.6.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Docker-%E7%BD%91%E7%BB%9C%E8%AE%B2%E8%A7%A3"><span class="nav-number">7.</span> <span class="nav-text">Docker-网络讲解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%90%86%E8%A7%A3Docker0"><span class="nav-number">7.1.</span> <span class="nav-text">理解Docker0</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C%EF%BC%9A%E6%B8%85%E7%A9%BA%E6%89%80%E6%9C%89%E7%9A%84%E5%AE%B9%E5%99%A8%EF%BC%8C%E6%B8%85%E7%A9%BA%E6%89%80%E6%9C%89%E7%9A%84%E9%95%9C%E5%83%8F"><span class="nav-number">7.1.1.</span> <span class="nav-text">准备工作：清空所有的容器，清空所有的镜像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E6%9C%AC%E5%9C%B0ip-ip-addr"><span class="nav-number">7.1.2.</span> <span class="nav-text">查看本地ip ip addr</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%9F%E7%90%86"><span class="nav-number">7.1.3.</span> <span class="nav-text">原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93-2"><span class="nav-number">7.1.4.</span> <span class="nav-text">小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E2%80%94Link"><span class="nav-number">7.2.</span> <span class="nav-text">—Link</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BD%91%E7%BB%9C"><span class="nav-number">7.3.</span> <span class="nav-text">自定义网络</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4%E6%9F%A5%E7%9C%8B"><span class="nav-number">7.3.1.</span> <span class="nav-text">基本命令查看</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E5%A6%82%E4%B8%8B"><span class="nav-number">7.3.2.</span> <span class="nav-text">命令如下</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E6%89%80%E6%9C%89%E7%BD%91%E7%BB%9C"><span class="nav-number">7.3.3.</span> <span class="nav-text">查看所有网络</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%BC%8F"><span class="nav-number">7.3.4.</span> <span class="nav-text">网络模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E4%B8%80%E4%B8%AA%E5%85%B7%E4%BD%93%E7%9A%84%E7%BD%91%E7%BB%9C%E7%9A%84%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF"><span class="nav-number">7.3.5.</span> <span class="nav-text">查看一个具体的网络的详细信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BD%91%E5%8D%A1"><span class="nav-number">7.3.6.</span> <span class="nav-text">自定义网卡</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E8%BF%9E%E9%80%9A"><span class="nav-number">7.4.</span> <span class="nav-text">网络连通</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E6%88%98%EF%BC%9A%E9%83%A8%E7%BD%B2%E4%B8%80%E4%B8%AARedis%E9%9B%86%E7%BE%A4"><span class="nav-number">7.5.</span> <span class="nav-text">实战：部署一个Redis集群</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#IDEA%E6%95%B4%E5%90%88Docker"><span class="nav-number">8.</span> <span class="nav-text">IDEA整合Docker</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE"><span class="nav-number">8.1.</span> <span class="nav-text">创建项目</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%93%E5%8C%85%E9%95%9C%E5%83%8F"><span class="nav-number">8.2.</span> <span class="nav-text">打包镜像</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IDEA%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6"><span class="nav-number">8.3.</span> <span class="nav-text">IDEA安装插件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E3%80%81IDEA%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6"><span class="nav-number">8.3.1.</span> <span class="nav-text">1 、IDEA安装插件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E3%80%81%E9%85%8D%E7%BD%AEdocker%E8%BF%9E%E6%8E%A5%E9%9B%86%E6%88%90"><span class="nav-number">8.3.2.</span> <span class="nav-text">2 、配置docker连接集成</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E3%80%81%E9%9B%86%E6%88%90%E4%BA%86docker%E6%8F%92%E4%BB%B6%E5%B0%B1%E5%8F%AF%E4%BB%A5%E5%9C%A8IDEA%E4%B8%AD%E6%93%8D%E4%BD%9CDocker%E5%86%85%E9%83%A8%E7%9A%84%E5%AE%B9%E5%99%A8%E5%92%8C%E9%95%9C%E5%83%8F%E4%BA%86%EF%BC%8C%E4%BD%86%E6%98%AF%E5%BE%88%E9%B8%A1%E8%82%8B%E8%BF%99%E4%B8%AA%E5%8A%9F%E8%83%BD%EF%BC%8C%E5%AF%B9%E4%BA%8E%E6%88%91%E4%BB%AC%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E6%9D%A5%E8%AF%B4"><span class="nav-number">8.3.3.</span> <span class="nav-text">3 、集成了docker插件就可以在IDEA中操作Docker内部的容器和镜像了，但是很鸡肋这个功能，对于我们开发人员来说</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Zongqing Li"
      src="https://github.com/hqulzq/hqulzq.github.io/blob/main/images/userimg.jpg?raw=true">
  <p class="site-author-name" itemprop="name">Zongqing Li</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">41</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">31</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/hqulzq" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hqulzq" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hqulzq@163.com" title="E-Mail → mailto:hqulzq@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

      
<script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
<script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
<div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div id="myCanvasContainer" class="widget tagcloud">
        <canvas width="250" height="250" id="resCanvas" style="width=100%">
            <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Bug%E6%80%BB%E7%BB%93/" rel="tag">Bug总结</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/" rel="tag">Git</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kafka/" rel="tag">Kafka</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Knife4j/" rel="tag">Knife4j</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MinIO/" rel="tag">MinIO</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mybatis-Plus/" rel="tag">Mybatis-Plus</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nginx/" rel="tag">Nginx</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RabbitMQ/" rel="tag">RabbitMQ</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/" rel="tag">Redis</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RocketMQ/" rel="tag">RocketMQ</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/diffusion/" rel="tag">diffusion</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/" rel="tag">docker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/k8s/" rel="tag">k8s</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/latex/" rel="tag">latex</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/leetcode/" rel="tag">leetcode</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/" rel="tag">mongodb</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/" rel="tag">mysql</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BB%A3%E7%A0%81%E9%9A%8F%E6%83%B3%E5%BD%95/" rel="tag">代码随想录</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%B4%E5%87%BD%E6%95%B0/" rel="tag">头函数</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B0%9A%E5%BA%AD%E5%85%AC%E5%AF%93/" rel="tag">尚庭公寓</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/" rel="tag">异常处理</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/" rel="tag">快速入门</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF%E6%80%BB%E7%BB%93/" rel="tag">技术总结</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E7%BB%84/" rel="tag">数组</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B3%A8%E8%A7%A3/" rel="tag">注解</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%8B%A5%E4%BE%9D/" rel="tag">若依</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BA%E6%96%87/" rel="tag">论文</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%93%BE%E8%A1%A8i/" rel="tag">链表i</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/" rel="tag">项目实战</a><span class="tag-list-count">6</span></li></ul>
        </canvas>
    </div>
</div>



    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zongqing Li</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>









<script>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>




  

  

  

  
  <style>
    .copy-btn {
      display: inline-block;
      padding: 6px 12px;
      font-size: 13px;
      font-weight: 700;
      line-height: 20px;
      color: #4D4D4C;
      white-space: nowrap;
      vertical-align: middle;
      cursor: pointer;
      background-color: #F7F7F7;
      background-image: linear-gradient(#F7F7F7, #F7F7F7);
      border: 1px solid #d5d5d5;
      border-radius: 3px;
      user-select: none;
      outline: 0;
    }

    .highlight-wrap .copy-btn {
      transition: opacity .3s ease-in-out;
      opacity: 0;
      padding: 2px 6px;
      position: absolute;
      right: 4px;
      top: 8px;
    }

    .highlight-wrap:hover .copy-btn,
    .highlight-wrap .copy-btn:focus {
      opacity: 1
    }

    .highlight-wrap {
      position: relative;
    }
  </style>

  <script>
    $('.highlight').each(function (i, e) {
      var $wrap = $('<div>').addClass('highlight-wrap')
      $(e).after($wrap)
      $wrap.append($('<button>').addClass('copy-btn').append('post.copy_button').on('click', function (e) {
        var code = $(this).parent().find('.code').find('.line').map(function (i, e) {
          return $(e).text()
        }).toArray().join('\n')
        var ta = document.createElement('textarea')
        document.body.appendChild(ta)
        ta.style.position = 'absolute'
        ta.style.top = '0px'
        ta.style.left = '0px'
        ta.value = code
        ta.select()
        ta.focus()
        var result = document.execCommand('copy')
        document.body.removeChild(ta)
        
          if(result)$(this).text('post.copy_success')
          else $(this).text('post.copy_failure')
        
        $(this).blur()
      })).on('mouseleave', function (e) {
        var $b = $(this).find('.copy-btn')
        setTimeout(function () {
          $b.text('post.copy_button')
        }, 300)
      }).append(e)
    })
  </script>


<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":300,"hOffset":-15,"vOffset":-15},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body>
</html>
