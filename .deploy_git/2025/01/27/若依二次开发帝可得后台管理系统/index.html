<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"hqulzq.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="项目介绍售货机简介 帝可得是一个基于物联网概念下的智能售货机运营管理系统">
<meta property="og:type" content="article">
<meta property="og:title" content="若依二次开发帝可得后台管理系统">
<meta property="og:url" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/index.html">
<meta property="og:site_name" content="Lzq&#39;s blog">
<meta property="og:description" content="项目介绍售货机简介 帝可得是一个基于物联网概念下的智能售货机运营管理系统">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240514214806291.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240514214918913.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/pic_c22f44576b8541242609e62a009150f9.jpeg">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/a4mz4524259898151405.jpg">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/1680489418001.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240515095146017.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/%E4%B8%BB%E6%B5%81%E7%A8%8B.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/1677120641712-17161937795607.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/1677120654314-17161937795618.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/1677120732660.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/1677120750585.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/1677120760514.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240521112225505.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/1-2.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240603213733977.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240603213714790.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240603161534054.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240603160705373.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240603213651549.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240520214059378.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240520214558738.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240604091257616.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240520215400124.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240520215706631.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240407114209508.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240520215922159.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240520220411801.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240520221244465.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240520221730103.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240520221915801.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240520222338910.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240520200927616.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240527171905791.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240604212450821.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240520191900302.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240520192424147.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240520192122055.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240521094532290.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240521094625483.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240521094714656.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240521094828280.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240521095341985.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240520195705524.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240605101454103.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240521100933980.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240521100154862.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240605101338740.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240521101741695.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240520200439529.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240605101546273.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240521100818303.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240521101119476.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240521101354165.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240521121836288.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240521121935608.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240521101613667.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240521122929449.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/1-5.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240605165826567.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240521125020524.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240521131706554.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240521134037713.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240607111610267.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240524173300573.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240521160012649.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240521164650187.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240521164640411.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240609225517037.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240612174727308.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240612174906586.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240614102316989.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240614101411660.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240526215928362.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240526220314397.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240615092652583.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240526190447167.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240526164727034.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240526184648412.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240526184722696.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240526184842567.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240526184905928.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240526165101957.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240526170042249.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240614222258513.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240614222335106.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240526170647520.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240526170748470.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240526170851074.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240526172403396.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240615092731978.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240526183406530.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240526190310190.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240526190608481.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240617195506512.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20231203203509617.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20231203203535648.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20231203203634852.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20231203204940906.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240618104400511.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20231203205356059.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20231203203727265.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20231203203749688.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20231203203957217.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20231203204031109.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20231203204157199.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20231203205500858-171869715719416.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20231203205600647-171869715719517.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20231203205742130-171869715719518.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20231203204307766.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20231203204415060.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20231203204510698.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240618105934234.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240618111315884.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240620160545588.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240620164449528.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630094429654.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240619221613865.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240619221629528.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240619221833852.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240619222227644.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240619222315484.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240619222356159.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240620144626365.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240620092207215.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240620092949410.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240620100029813.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240620093047213.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240620093441442.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240620100002707.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240620094725603.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240620144950436.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240620145048747.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240620145103156.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240620145131847.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240620145300354.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240620095333947.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240620145720081.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240620095814155.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240620100946781.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240620105247310.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630161558158.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240710101123724.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240710170114925.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240710094831550.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240710202709375.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240711094001513.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240626173707709.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240626172011769.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630100722719.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630102454674.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630100852212.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630101015020.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630101043469.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630103023330.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630101224680.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630102002000.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630102039555.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630102317850.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630102423801.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630102546807.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630103824304.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630104801234.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630110417850.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630122651738.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630121056783.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630121143428.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630121215844.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630121329378.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630121558343.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630121430008.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630122047727.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630122122679.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630122221412.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630122248478.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630122353216.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630122424605.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630122616266.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630122749105.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240526220314397.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630125831347.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240716214223061.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240716214154124.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630155543194.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240630142240399.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240719160225644.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240719160337360.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240719162954927.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240719163117366.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240719165325959.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/10-3.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722162323740.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722154846604.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722155046847.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722203758387.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722204652594.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722204737663.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722204956956.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722205033489.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722205105502.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722205128155.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722160506242.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722205158812.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722162617583.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722161206343.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722161237298.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722205625960.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722161701699.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722161727464.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722161835563.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722161908247.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722162850400.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722162906011.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722163046710.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722163056885.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722163112340.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722163159812.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722163438233.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722163548428.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722164320618.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722164423267.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722210725885.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722210902394.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722170521551.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722170554207.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722172059458.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722172113957.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722172059458.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722172113957.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/1681295827753.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240726100352426.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722200308660.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240727142355125.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240722202046114.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729151833677.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729161029907.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240730105638809.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729103454163.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729104324699.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20230524223644828.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729110127325.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729110248889.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729112910697.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729111817519.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729112854709.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729111836202.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729112052191.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729112117934.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729112211068.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729112418567.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729112340223.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729112501205.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729112529929.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729112634816.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729112954052.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729113007035.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729113050603.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729113059353.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729113149947.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729113246006.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729113259266.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729113804130.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729113930117.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729114254099.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729143120206.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729141233202.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729141617690.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729142202566.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729142628648.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729142715034.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729143443094.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729143602326.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729143843296.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729174725280.png">
<meta property="og:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240729143804299.png">
<meta property="article:published_time" content="2025-01-27T03:52:59.000Z">
<meta property="article:modified_time" content="2025-02-27T02:37:03.647Z">
<meta property="article:author" content="Zongqing Li">
<meta property="article:tag" content="项目实战">
<meta property="article:tag" content="若依">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/image-20240514214806291.png">

<link rel="canonical" href="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>若依二次开发帝可得后台管理系统 | Lzq's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Lzq's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">31</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">12</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">42</span></a>

  </li>
        <li class="menu-item menu-item-book">

    <a href="/book" rel="section"><i class="fas fa-book fa-fw"></i>Book</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://hqulzq.github.io/2025/01/27/%E8%8B%A5%E4%BE%9D%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%B8%9D%E5%8F%AF%E5%BE%97%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://github.com/hqulzq/hqulzq.github.io/blob/main/images/userimg.jpg?raw=true">
      <meta itemprop="name" content="Zongqing Li">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lzq's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          若依二次开发帝可得后台管理系统
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-01-27 11:52:59" itemprop="dateCreated datePublished" datetime="2025-01-27T11:52:59+08:00">2025-01-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-02-27 10:37:03" itemprop="dateModified" datetime="2025-02-27T10:37:03+08:00">2025-02-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="项目介绍"><a href="#项目介绍" class="headerlink" title="项目介绍"></a>项目介绍</h1><h2 id="售货机简介"><a href="#售货机简介" class="headerlink" title="售货机简介"></a>售货机简介</h2><blockquote>
<p>帝可得是一个基于<code>物联网</code>概念下的<code>智能售货机运营管理系统</code><br><span id="more"></span></p>
<h3 id="物联网"><a href="#物联网" class="headerlink" title="物联网"></a>物联网</h3></blockquote>
<p>物联网（IoT：Internet of Things）简单来说，就是让各种物品通过互联网连接起来，实现信息的交换和通信。</p>
<p>这个概念听起来可能有点抽象，但我们可以把它想象成一个超级大的社交网络。不过，这个网络里的成员不是人类，而是各种物品。比如，你的冰箱、洗衣机、甚至是你的汽车，它们都可以通过互联网互相交流信息，就像是它们自己在聊天一样。</p>
<p>物联网的神奇之处在于，它能够让这些物品变得更加“聪明”。它们能够感知周围的环境，并且能够根据情况自动做出反应。举个例子，如果你的家里安装了智能家居系统，当你下班回家的路上，家里的空调就能提前开启，自动调整到你喜欢的温度，让你一回到家就能感受到舒适的环境。</p>
<p>总的来说将现实物体赋予感知、通信和智能化的能力，为人们提供更加智能化和便利的生活和工作环境</p>
<p>应用场景：智能家居、共享充电中、智能售货机</p>
<h3 id="售货机"><a href="#售货机" class="headerlink" title="售货机"></a>售货机</h3><p>近年来，无接触式智能售货机逐渐成为年轻消费者的首选购物方式。这些设备不仅在公园、地铁站和商场等公共场所广泛分布，为顾客提供了极大的购物便利，而且由于其运营成本低廉和较高的利润空间，被众多电商企业视为新兴的蓝海市场。</p>
<p>与传统售货机相比，智能售货机的优势在于其<code>自我管理能力</code>，表现如下：</p>
<ul>
<li><strong>物联网技术</strong>：像是售货机的顺风耳和千里眼。不管售货机在哪，管理人员都能通过电脑或手机知道它的状态，比如哪些商品快卖完了，哪些需要补货。</li>
<li><strong>智能分析与推荐</strong>：智能售货机就像有一个隐形的聪明脑袋，它能分析顾客的喜好，推荐那些可能让你心动的商品。就像有一个贴心的小助手，总能帮你找到最想要的东西。</li>
<li><strong>人员设备绑定管理</strong>：每个售货机都有自己的专属“保镖”，一旦售货机出现问题，这些“保镖”就能立刻出现，迅速解决问题，让售货机始终保持最佳状态。</li>
<li><strong>移动支付支持</strong>：现在谁还带现金出门呢？智能售货机支持各种移动支付方式，一扫即付，既方便又安全，让购物体验更加流畅。</li>
<li><strong>线上线下融合（OMO）</strong>：智能售货机还能把线上和线下完美结合起来，顾客可以在线上浏览商品，然后直接在售货机上购买，或者在售货机上看到喜欢的商品后，直接在线上下单。</li>
</ul>
<p>智能售货机，不仅仅是一个自动售货的机器，它更像是一个智能的、能够自我管理和自我优化的系统。它让运营更高效，让购物体验更个性化，同时也为零售行业带来了创新和发展。</p>
<h2 id="售货机术语"><a href="#售货机术语" class="headerlink" title="售货机术语"></a>售货机术语</h2><p><strong>区域管理</strong>： 为了更高效地进行经营管理，公司将运营范围划分为若干个逻辑区域。这些区域的划分基于业务需求，可能与地理上的行政区域有所区别，以确保更合理的资源分配和更高效的运营管理。<br><img src="image-20240514214806291.png" alt="image-20240514214806291"></p>
<p><strong>点位选择</strong>： 点位指的是智能售货机的具体放置位置。选择点位时，我们会考虑人流量、目标顾客群体、可见度以及便利性等因素，以最大化售货机的使用效率和顾客的购买体验。</p>
<p><img src="image-20240514214918913.png" alt="image-20240514214918913" style="zoom:72%;" /></p>
<p><strong>售货机功能</strong>： 智能售货机就像是一个自动的小店，里面摆满了各种商品。顾客想要什么，直接在机器上选，然后机器就会把商品送到他们手中，就像是一个自动化的仓库。<br><img src="pic_c22f44576b8541242609e62a009150f9.jpeg" alt="img" style="zoom:20%;" /></p>
<p><strong>货道设计</strong>：售货机里面的货道，你可以想象成超市里的那种货架。每一层都有好几个位置可以放商品，这样就能放很多种不同的商品，而且每一层都能放很多，这样顾客的选择就会更多。</p>
<p><img src="a4mz4524259898151405.jpg" alt="img" style="zoom:70%;" />  <img src="1680489418001.png" alt="1680489418001" style="zoom: 67%;" /></p>
<h2 id="角色与功能"><a href="#角色与功能" class="headerlink" title="角色与功能"></a>角色与功能</h2><p>一个完整的售货机系统由五端五角色组成：</p>
<ol>
<li><p>管理员：对基础数据（区域、点位、设备、货道、商品等）进行管理，创建工单指派运维或运营人员，查看订单，查看各种统计报表。</p>
</li>
<li><p>运维人员：投放设备、撤除设备、维修设备。</p>
</li>
<li><p>运营人员：补货。</p>
</li>
<li><p>合作商：仅提供点位，坐收渔翁之利。</p>
</li>
<li>消费者:  在小程序或屏幕端下单购买商品。</li>
</ol>
<p><img src="image-20240515095146017.png" alt="image-20240515095146017"></p>
<h2 id="业务流程"><a href="#业务流程" class="headerlink" title="业务流程"></a>业务流程</h2><p>整个工程中，课程里会对主要核心的业务进行实现，主要包含下面的业务流程：</p>
<p>（1）<strong>平台管理员</strong>：主要作用有基础数据的管理和创建工单排除员工完成维修或补货。</p>
<p>（2）<strong>运营人员</strong>：主要作用是处理运营工单业务（补货等操作）</p>
<p>（3）<strong>运维人员</strong>：主要作用是处理运维工单业务（设备维修等操作）</p>
<p>（4）<strong>消费者</strong>：供C端用户使用。消费者扫描售货机上的二维码可以打开此端。主要作用是完成在售货机的购物操作。</p>
<p><img src="主流程.png" alt="主流程"></p>
<h3 id="平台管理员"><a href="#平台管理员" class="headerlink" title="平台管理员"></a>平台管理员</h3><p><img src="1677120641712-17161937795607.png" /></p>
<p><img src="1677120654314-17161937795618.png" alt="1677120654314"></p>
<p>上图中的简要流程：</p>
<p>①：平台管理人员登录到系统管理后台系统</p>
<p>②：创建区域数据</p>
<p>③：创建区域下点位数据</p>
<p>④：添加运维/运营人员</p>
<p>⑤：创建售货机信息</p>
<p>⑥：设置售货机点位信息</p>
<p>⑦：创建运维投放工单，由运维人员开始投放设备（安装设备）</p>
<p>⑧：设置售卖的商品信息</p>
<p>⑨：创建运营补货工单，由运营人员开始投放商品信息</p>
<h3 id="运维人员"><a href="#运维人员" class="headerlink" title="运维人员"></a>运维人员</h3><p><img src="1677120732660.png" alt="1677120732660"></p>
<p>上图中的简要流程：</p>
<p>①：运维人员通过App登录运营系统</p>
<p>②：在App对派送过来的工单进行处理</p>
<p>③：接受工单后在指定的投放点安装售货机</p>
<p>④：拒绝工单该运维人员的工单结束</p>
<h3 id="运营人员"><a href="#运营人员" class="headerlink" title="运营人员"></a>运营人员</h3><p><img src="1677120750585.png" alt="1677120750585"></p>
<p>上图中的简要流程：</p>
<p>①：运营人员通过App登录运营系统</p>
<p>②：在App对派送过来的工单进行处理</p>
<p>③：接受工单后在指定的售货机的商品进行补货</p>
<p>④：拒绝工单该运维人员的工单结束</p>
<h3 id="消费者"><a href="#消费者" class="headerlink" title="消费者"></a>消费者</h3><p><img src="1677120760514.png"/></p>
<p>上图中的简要流程：</p>
<p>方式一：</p>
<p>①：用户通过售货机二维码进行购买商品</p>
<p>②：扫码后在手机端微信小程序选择商品</p>
<p>③：支付成功后在售货机取货</p>
<p>方式二：</p>
<p>①：用户在售货机上选择商品</p>
<p>②：在选择商品后扫码支付商品的二维码</p>
<p>③：支付成功后在售货机取货</p>
<h2 id="产品原型"><a href="#产品原型" class="headerlink" title="产品原型"></a>产品原型</h2><p>帝可得项目点击链接立即查看 <a target="_blank" rel="noopener" href="https://codesign.qq.com/s/426304924036117">https://codesign.qq.com/s/426304924036117</a></p>
<p><img src="image-20240521112225505.png" alt="image-20240521112225505"></p>
<h2 id="库表设计"><a href="#库表设计" class="headerlink" title="库表设计"></a>库表设计</h2><p>系统后台基础数据表关系说明：</p>
<p><img src="1-2.png" alt=""></p>
<p>一个区域可以有多个点位</p>
<p>一个点位可以有多个售货机</p>
<p>一个售货机有多个货道</p>
<p>多个货道可以放置同一样商品</p>
<p>一个商品类型下有多个商品</p>
<p>一个售货机类型下有多个售货机</p>
<p>一个合作商有多个点位</p>
<p>合作商和区域之间没有关系，因为合作商拥有的多个点位可以分布在不同的区域</p>
<p>每个区域下有多个运维和运营人员，他们来负责这个区域下的设备的运维和运营</p>
<h1 id="初始AI"><a href="#初始AI" class="headerlink" title="初始AI"></a>初始AI</h1><h2 id="AIGC"><a href="#AIGC" class="headerlink" title="AIGC"></a>AIGC</h2><p>AI：即人工智能，是计算机科学体系下的一个学科，是指通过计算机系统模拟人类智力的一种技术。</p>
<p>简单地说，AI是一种模拟人类智能的技术，它通过机器学习、深度学习等算法，使计算机具备对数据分析、理解、推理和决策的能力。</p>
<p>我们可以把“人工智能”想象成一个聪明的机器人小伙伴，它不仅会自动学习，还能像人的大脑一样思考和决策。在常生活中，它可以帮助我们解决诸多问题，例如在出门前预测当天的天气状况、通过分析交通路况推荐汽车的最佳行驶路线等。</p>
<p>AIGC（AI Generated Content）：AIGC是AI领域的一个应用分支，专注于利用AI技术自动生成内容，包括文本，代码，图片，音频，视频。</p>
<p><img src="image-20240603213733977.png" alt="image-20240603213733977">  </p>
<p>AI大模型：通常指的是具有大量参数的深度学习模型，经过大量数据训练，具备复杂计算能力的人工智能系统，它们能够执行多种高级任务，其中包括内容生成。</p>
<p><img src="image-20240603213714790.png" alt="image-20240603213714790">  </p>
<p>常见的通用大模型产品：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>国家</th>
<th>对话产品</th>
<th>大模型</th>
<th>链接</th>
</tr>
</thead>
<tbody>
<tr>
<td>美国</td>
<td>OpenAI ChatGPT</td>
<td>GPT-3.5、GPT-4</td>
<td><a target="_blank" rel="noopener" href="https://chat.openai.com/">https://chat.openai.com/</a></td>
</tr>
<tr>
<td>美国</td>
<td>Microsoft Copilot</td>
<td>GPT-4 和未知</td>
<td><a target="_blank" rel="noopener" href="https://copilot.microsoft.com/">https://copilot.microsoft.com/</a></td>
</tr>
<tr>
<td>美国</td>
<td>Google Bard</td>
<td>Gemini</td>
<td><a target="_blank" rel="noopener" href="https://bard.google.com/">https://bard.google.com/</a></td>
</tr>
<tr>
<td>中国</td>
<td>百度文心一言</td>
<td>文心4.0</td>
<td><a target="_blank" rel="noopener" href="https://yiyan.baidu.com/">https://yiyan.baidu.com/</a></td>
</tr>
<tr>
<td>中国</td>
<td>讯飞星火</td>
<td>星火3.5</td>
<td><a target="_blank" rel="noopener" href="https://xinghuo.xfyun.cn/">https://xinghuo.xfyun.cn/</a></td>
</tr>
<tr>
<td>中国</td>
<td>智谱清言</td>
<td>GLM-4</td>
<td><a target="_blank" rel="noopener" href="https://chatglm.cn/">https://chatglm.cn/</a></td>
</tr>
<tr>
<td>中国</td>
<td>月之暗面 Kimi Chat</td>
<td>Moonshot</td>
<td><a target="_blank" rel="noopener" href="https://kimi.moonshot.cn/">https://kimi.moonshot.cn/</a></td>
</tr>
<tr>
<td>中国</td>
<td>MiniMax星野</td>
<td>abab6</td>
<td><a target="_blank" rel="noopener" href="https://www.xingyeai.com/">https://www.xingyeai.com/</a></td>
</tr>
<tr>
<td>中国</td>
<td>通义干问</td>
<td>Qwen-Max</td>
<td><a target="_blank" rel="noopener" href="https://tongyi.aliyun.com/">https://tongyi.aliyun.com/</a></td>
</tr>
</tbody>
</table>
</div>
<h2 id="提示工程"><a href="#提示工程" class="headerlink" title="提示工程"></a>提示工程</h2><h3 id="什么是Prompt"><a href="#什么是Prompt" class="headerlink" title="什么是Prompt?"></a>什么是Prompt?</h3><p>提示（Prompt）是我们对大模型提出的问题。</p>
<p>举一个最简单的例子，很多同学在第一次使用AI时，都会问AI”你是谁”，”你是谁”这个问题便是prompt。﻿﻿</p>
<p><img src="image-20240603161534054.png" alt="image-20240603161534054"></p>
<h3 id="为什么学？"><a href="#为什么学？" class="headerlink" title="为什么学？"></a>为什么学？</h3><p>在与AI交流时，我们常常发现直接提问可能得不到满意的答案。</p>
<p>但如果我们换一种方式提问，或者提供一些额外的上下文信息，AI的表现就会大大提升。</p>
<p><img src="image-20240603160705373.png" alt="image-20240603160705373"></p>
<p>同一个问题使用不同的prompt可能会获得不同的答案，怎么调教出一个聪明的AI助手呢？</p>
<p>这时候，提示工程就派上用场了。通过精心设计的提示，我们可以引导AI模型，让它的输出更加准确、相关和有用。</p>
<h3 id="什么是提示工程？"><a href="#什么是提示工程？" class="headerlink" title="什么是提示工程？"></a>什么是提示工程？</h3><p>提示工程（Prompt Engineering）也被称为上下文提示，它涉及到设计和优化输入文本，也就是Prompt，来引导AI模型生成预期的输出。</p>
<p>简单来说，就像是给AI出一个好问题，让它给我们一个满意的答案。</p>
<p><img src="image-20240603213651549.png" alt="image-20240603213651549">  </p>
<h3 id="Prompt的组成"><a href="#Prompt的组成" class="headerlink" title="Prompt的组成"></a>Prompt的组成</h3><ul>
<li><strong>角色</strong>：给 AI 定义一个最匹配任务的角色，比如：「你是一位软件工程师」「你是一位小学老师」</li>
<li><strong>指示</strong>：对任务进行描述</li>
<li><strong>上下文</strong>：给出与任务相关的其它背景信息（尤其在多轮交互中）</li>
<li><strong>例子</strong>：必要时给出举例，[实践证明其对输出正确性有帮助]</li>
<li><strong>输入</strong>：任务的输入信息；在提示词中明确的标识出输入</li>
<li><strong>输出</strong>：输出的格式描述，以便后继模块自动解析模型的输出结果，比如（JSON、Java）</li>
</ul>
<blockquote>
<p>先定义角色，其实就是在<strong>开头把问题域收窄</strong>，减少二义性。</p>
</blockquote>
<p><strong>案例：</strong></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">角色：你是一位专业的博客作者。</span><br><span class="line"></span><br><span class="line">指示：撰写一篇关于最新AI技术发展的文章。</span><br><span class="line"></span><br><span class="line">上下文：文章应该涵盖AI技术的当前状态和未来趋势。</span><br><span class="line"></span><br><span class="line">例子：可以引用最近的AI技术突破和行业专家的见解。</span><br><span class="line"></span><br><span class="line">输入：当前AI技术的相关信息和数据。</span><br><span class="line"></span><br><span class="line">输出：一篇结构清晰、观点鲜明的文章草稿。</span><br></pre></td></tr></table></figure>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">角色：你是一位资深的Java开发工程师。</span><br><span class="line"></span><br><span class="line">指示：编写一个Java函数，该函数接收两个整数参数，并返回它们的和。</span><br><span class="line"></span><br><span class="line">上下文：这个函数将被用于一个简单的数学应用程序，该程序帮助学生练习基本的算术运算。</span><br><span class="line"></span><br><span class="line">例子：如果你调用函数 <span class="code">`addNumbers(3, 5)`</span>，它应该返回 <span class="code">`8`</span>。</span><br><span class="line"></span><br><span class="line">输入：两个整数参数，分别为 <span class="code">`int a`</span> 和 <span class="code">`int b`</span>。</span><br><span class="line"></span><br><span class="line">输出：返回这两个整数的和，类型为 <span class="code">`int`</span>。</span><br></pre></td></tr></table></figure>
<h3 id="常见的编程相关的Prompt"><a href="#常见的编程相关的Prompt" class="headerlink" title="常见的编程相关的Prompt"></a>常见的编程相关的Prompt</h3><h4 id="表结构"><a href="#表结构" class="headerlink" title="表结构"></a>表结构</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">你是一个软件工程师，帮我生成MySQL的表结构</span><br><span class="line">需求如下：</span><br><span class="line"> 1，课程管理表，表名tb<span class="emphasis">_course，字段有主键id、课程编码、课程学科、课程名称、课程价格、适用人群、课程介绍</span></span><br><span class="line"><span class="emphasis">其他要求：</span></span><br><span class="line"><span class="emphasis">    1，每个表中都有创建时间(create_</span>time)、修改时间(date<span class="emphasis">_time)、创建人(create_</span>by)、修改人(update<span class="emphasis">_by)、备注(remark)这些字段</span></span><br><span class="line"><span class="emphasis">    2，每个表的主键都是自增的</span></span><br><span class="line"><span class="emphasis">    3，课程价格是整型、课程编码是字符串</span></span><br><span class="line"><span class="emphasis">    4，请为每个字段都添加上comment</span></span><br><span class="line"><span class="emphasis">    5，帮我给生成的表中插入一些IT课程示例数据</span></span><br><span class="line"><span class="emphasis">        课程学科：Java、人工智能、大数据</span></span><br><span class="line"><span class="emphasis">        适用人群：小白学员、中级程序员</span></span><br></pre></td></tr></table></figure>
<h4 id="生成数据库说明文档"><a href="#生成数据库说明文档" class="headerlink" title="生成数据库说明文档"></a>生成数据库说明文档</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">你是一个软件工程师，现在要根据数据库的sql脚本，编写数据库说明文档，sql脚本如下：</span><br><span class="line">CREATE TABLE <span class="code">`tb_course`</span> (</span><br><span class="line"><span class="code">    `id` INT AUTO_INCREMENT COMMENT &#x27;主键ID&#x27;,</span></span><br><span class="line"><span class="code">    `course_code` VARCHAR(255) NOT NULL COMMENT &#x27;课程编码&#x27;,</span></span><br><span class="line"><span class="code">    `course_subject` VARCHAR(100) NOT NULL COMMENT &#x27;课程学科&#x27;,</span></span><br><span class="line"><span class="code">    `course_name` VARCHAR(255) NOT NULL COMMENT &#x27;课程名称&#x27;,</span></span><br><span class="line"><span class="code">    `course_price` INT COMMENT &#x27;课程价格&#x27;,</span></span><br><span class="line"><span class="code">    `target_audience` VARCHAR(100) COMMENT &#x27;适用人群&#x27;,</span></span><br><span class="line"><span class="code">    `course_introduction` TEXT COMMENT &#x27;课程介绍&#x27;,</span></span><br><span class="line"><span class="code">    `create_time` DATETIME COMMENT &#x27;创建时间&#x27;,</span></span><br><span class="line"><span class="code">    `update_time` DATETIME COMMENT &#x27;修改时间&#x27;,</span></span><br><span class="line"><span class="code">    `create_by` VARCHAR(64) COMMENT &#x27;创建人&#x27;,</span></span><br><span class="line"><span class="code">    `update_by` VARCHAR(64) COMMENT &#x27;修改人&#x27;,</span></span><br><span class="line"><span class="code">    `remark` VARCHAR(255) COMMENT &#x27;备注&#x27;,</span></span><br><span class="line"><span class="code">    PRIMARY KEY (`id`)</span></span><br><span class="line"><span class="code">) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT=&#x27;课程管理表&#x27;;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line">输出要求是：</span><br><span class="line"> 1，每个表以及每个表的字段都要详细说明，包括，字段名称、类型、作用</span><br><span class="line"> 2，使用markdown的输出格式，字段的描述需要使用表格展示</span><br><span class="line"> 3，如果表之间有关系，需要描述清楚表之间的关系</span><br></pre></td></tr></table></figure>
<h4 id="生成代码"><a href="#生成代码" class="headerlink" title="生成代码"></a>生成代码</h4><p>代码生成算是比较常规的方案，用的也比较多，分为了几种情况</p>
<ul>
<li>给出表生成代码（项目中常见）<ul>
<li>给出表结构的ddl，可以输出这个表的增删改查的所有代码</li>
<li>给出表结构的dll，可以输出增删改查的接口文档</li>
</ul>
</li>
<li>补全代码<ul>
<li>例1-给出实体类，帮助编写getter、setter、toString、构造方法等等</li>
<li>例2-给出一个controller，帮助编写swagger注解等</li>
</ul>
</li>
<li>提取结构（无含金量，费时间的编程）<ul>
<li>例1-根据接口文档提取dto类或者vo类</li>
</ul>
</li>
</ul>
<h4 id="生成代码流程图"><a href="#生成代码流程图" class="headerlink" title="生成代码流程图"></a>生成代码流程图</h4><p>有一些比较复杂的业务流程，往往需要画出流程图，现在就可以使用ai协助我们画流程图</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">你是一个软件工程师，为了方便理解代码执行流程，需要给出代码执行的流程图，代码如下：</span><br><span class="line">    <span class="comment">// 创建工单</span></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">insertTaskDto</span><span class="params">(TaskDto taskDto)</span> &#123;</span><br><span class="line">    <span class="comment">//1. 查询售货机是否存在</span></span><br><span class="line">    <span class="type">VendingMachine</span> <span class="variable">vm</span> <span class="operator">=</span> vendingMachineService.selectVendingMachineByInnerCode(taskDto.getInnerCode());</span><br><span class="line">    <span class="keyword">if</span> (vm == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ServiceException</span>(<span class="string">&quot;设备不存在&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2. 校验售货机状态与工单类型是否相符</span></span><br><span class="line">    checkCreateTask(vm.getVmStatus(), taskDto.getProductTypeId());</span><br><span class="line">    <span class="comment">//3. 校验这台设备是否有未完成的同类型工单，如果存在则不能创建</span></span><br><span class="line">    hasTask(taskDto.getInnerCode(), taskDto.getProductTypeId());</span><br><span class="line">    <span class="comment">//4. 校验员工是否存在</span></span><br><span class="line">    <span class="type">Emp</span> <span class="variable">emp</span> <span class="operator">=</span> empService.selectEmpById(taskDto.getUserId());</span><br><span class="line">    <span class="keyword">if</span> (emp == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ServiceException</span>(<span class="string">&quot;员工不存在&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 5. 校验非同区域下的工作人员不能接受工单</span></span><br><span class="line">    <span class="keyword">if</span> (emp.getRegionId() != vm.getRegionId()) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ServiceException</span>(<span class="string">&quot;非同区域下的工作人员不能接受工单&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//6. 保存工单信息</span></span><br><span class="line">    <span class="type">Task</span> <span class="variable">task</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Task</span>();</span><br><span class="line">    BeanUtil.copyProperties(taskDto, task);<span class="comment">// 属性赋值</span></span><br><span class="line">    task.setCreateTime(DateUtils.getNowDate());<span class="comment">// 创建时间</span></span><br><span class="line">    task.setTaskCode(generateTaskCode());<span class="comment">// 工单编号 202405150001</span></span><br><span class="line">    task.setTaskStatus(DkdContants.TASK_STATUS_CREATE);<span class="comment">// 创建工单</span></span><br><span class="line">    task.setAddr(vm.getAddr());</span><br><span class="line">    task.setRegionId(vm.getRegionId());</span><br><span class="line">    task.setUserName(emp.getUserName());</span><br><span class="line">    <span class="type">int</span> <span class="variable">taskResult</span> <span class="operator">=</span> taskMapper.insertTask(task);</span><br><span class="line">    <span class="comment">//7. 如果是补货工单，向工单明细表插入记录</span></span><br><span class="line">    <span class="keyword">if</span> (task.getProductTypeId() == DkdContants.TASK_TYPE_SUPPLY) &#123;</span><br><span class="line">        <span class="keyword">if</span> (CollUtil.isEmpty(taskDto.getDetails())) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ServiceException</span>(<span class="string">&quot;补货工单明细不能为空&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;TaskDetails&gt; taskDetailsList = taskDto.getDetails().stream().map(details -&gt; &#123;</span><br><span class="line">            <span class="type">TaskDetails</span> <span class="variable">taskDetails</span> <span class="operator">=</span> BeanUtil.copyProperties(details, TaskDetails.class);</span><br><span class="line">            taskDetails.setTaskId(task.getTaskId());</span><br><span class="line">            <span class="keyword">return</span> taskDetails;</span><br><span class="line">        &#125;).collect(Collectors.toList());</span><br><span class="line">        taskDetailsService.insertBatch(taskDetailsList);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> taskResult;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">输出：请使用mermaid语言来描述这个方法的流程</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">graph TD;</span><br><span class="line">    A[查询售货机] --&gt; B(售货机不存在?)</span><br><span class="line">    B -- 是 --&gt; C[抛出异常: 设备不存在]</span><br><span class="line">    B -- 否 --&gt; D[校验售货机状态与工单类型]</span><br><span class="line">    D --&gt; E(校验失败?)</span><br><span class="line">    E -- 是 --&gt; F[抛出异常]</span><br><span class="line">    E -- 否 --&gt; G[检查未完成同类型工单]</span><br><span class="line">    G --&gt; H(存在未完成同类型工单?)</span><br><span class="line">    H -- 是 --&gt; I[抛出异常]</span><br><span class="line">    H -- 否 --&gt; J[查询员工]</span><br><span class="line">    J --&gt; K(员工不存在?)</span><br><span class="line">    K -- 是 --&gt; L[抛出异常: 员工不存在]</span><br><span class="line">    K -- 否 --&gt; M[校验员工区域与售货机区域是否一致]</span><br><span class="line">    M --&gt; N(不一致?)</span><br><span class="line">    N -- 是 --&gt; O[抛出异常: 非同区域工作人员不能接受工单]</span><br><span class="line">    N -- 否 --&gt; P[保存工单信息]</span><br><span class="line">    P --&gt; Q(保存成功?)</span><br><span class="line">    Q -- 否 --&gt; R[处理保存失败]</span><br><span class="line">    Q -- 是 --&gt; S(工单类型为补货?)</span><br><span class="line">    S -- 是 --&gt; T[处理补货工单明细]</span><br><span class="line">    T --&gt; U[补货明细处理结果?]</span><br><span class="line">    U -- 失败 --&gt; V[抛出异常: 补货工单明细不能为空]</span><br><span class="line">    U -- 成功 --&gt; END(结束)</span><br><span class="line">    S -- 否 --&gt; END</span><br></pre></td></tr></table></figure>
<h1 id="项目搭建"><a href="#项目搭建" class="headerlink" title="项目搭建"></a>项目搭建</h1><h2 id="搭建后端项目"><a href="#搭建后端项目" class="headerlink" title="搭建后端项目"></a>搭建后端项目</h2><h3 id="初始化项目"><a href="#初始化项目" class="headerlink" title="初始化项目"></a>初始化项目</h3><h4 id="Git下载"><a href="#Git下载" class="headerlink" title="Git下载"></a>Git下载</h4><p>通过idea克隆源码，仓库地址：<a target="_blank" rel="noopener" href="https://gitee.com/ys-gitee/dkd-parent.git">https://gitee.com/ys-gitee/dkd-parent.git</a></p>
<p><img src="image-20240520214059378.png" alt="image-20240520214059378"></p>
<h4 id="Maven构建"><a href="#Maven构建" class="headerlink" title="Maven构建"></a>Maven构建</h4><p>使用idea打开项目后，等待环境检查（主要是Maven下载项目依赖）</p>
<p><img src="image-20240520214558738.png" alt="image-20240520214558738"></p>
<h3 id="MySQL相关"><a href="#MySQL相关" class="headerlink" title="MySQL相关"></a>MySQL相关</h3><h4 id="导入sql"><a href="#导入sql" class="headerlink" title="导入sql"></a>导入sql</h4><p>1、创建数据库<code>create schema dkd;</code></p>
<p>2、执行下图的sql脚本文件，完成导入</p>
<p><img src="image-20240604091257616.png" alt="image-20240604091257616">  </p>
<h4 id="配置信息"><a href="#配置信息" class="headerlink" title="配置信息"></a>配置信息</h4><p>在<code>dkd-admin</code>模块下，编辑<code>resources</code>目录下的<code>application-druid.yml</code>，修改数据库连接</p>
<p><img src="image-20240520215400124.png" alt="image-20240520215400124"></p>
<h3 id="Redis相关"><a href="#Redis相关" class="headerlink" title="Redis相关"></a>Redis相关</h3><h4 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h4><p>在redis解压目录下，编辑<code>redis.windows.conf</code>配置文件，设置redis密码</p>
<blockquote>
<p>设置Redis密码是为了增强数据安全性、防止未授权访问和保护关键信息，从而确保应用程序的稳定性和合规性。</p>
</blockquote>
<p><img src="image-20240520215706631.png" alt="image-20240520215706631"></p>
<p>在redis解压目录下，执行<code>redis-server.exe redis.windows.conf</code>启动</p>
<p><img src="image-20240407114209508.png" alt="image-20240407114209508"></p>
<h4 id="配置信息-1"><a href="#配置信息-1" class="headerlink" title="配置信息"></a>配置信息</h4><p>在<code>dkd-admin</code>模块下，<code>resources</code>目录下的<code>application.yml</code>，设置redis密码等相关信息</p>
<p><img src="image-20240520215922159.png" alt="image-20240520215922159"></p>
<h3 id="项目运行"><a href="#项目运行" class="headerlink" title="项目运行"></a>项目运行</h3><p>在<code>dkd-admin</code>模块下，运行<code>com.ruoyi.DkdApplication.java</code>，出现如下图表示启动成功</p>
<p><img src="image-20240520220411801.png" alt="image-20240520220411801"></p>
<p>后端运行成功可以通过([<a target="_blank" rel="noopener" href="http://localhost:8080">http://localhost:8080</a> )访问，但是不会出现静态页面，可以继续参考下面步骤部署前端，然后通过前端地址来访问。</p>
<h2 id="搭建前端项目"><a href="#搭建前端项目" class="headerlink" title="搭建前端项目"></a>搭建前端项目</h2><h3 id="初始化项目-1"><a href="#初始化项目-1" class="headerlink" title="初始化项目"></a>初始化项目</h3><p>通过vscode克隆源码，仓库地址：<a target="_blank" rel="noopener" href="https://gitee.com/ys-gitee/dkd-vue.git">https://gitee.com/ys-gitee/dkd-vue.git</a></p>
<p><img src="image-20240520221244465.png" alt="image-20240520221244465"></p>
<h3 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装依赖</span></span><br><span class="line">npm install</span><br></pre></td></tr></table></figure>
<p><img src="image-20240520221730103.png" alt="image-20240520221730103"></p>
<h3 id="项目运行-1"><a href="#项目运行-1" class="headerlink" title="项目运行"></a>项目运行</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">启动服务</span></span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure>
<p><img src="image-20240520221915801.png" alt="image-20240520221915801"></p>
<p>打开浏览器，输入：([<a target="_blank" rel="noopener" href="http://localhost:80">http://localhost:80</a>) 默认账户/密码 <code>admin/admin123</code>）若能正确展示登录页面，并能成功登录，菜单及页面展示正常，表明环境搭建成功</p>
<p><img src="image-20240520222338910.png" alt="image-20240520222338910"></p>
<h1 id="点位管理"><a href="#点位管理" class="headerlink" title="点位管理"></a>点位管理</h1><h2 id="需求说明"><a href="#需求说明" class="headerlink" title="需求说明"></a>需求说明</h2><p><strong>业务场景</strong>： 假设我们的公司现在有一个宏伟的计划——在北京发展业务。首先，我们需要确定几个有潜力的区域，这些区域可能是人流量大、消费能力高的商业区或居民区。然后，我们要与这些区域内的潜在合作商进行洽谈，比如商场、写字楼、学校等地方的管理者或所有者。</p>
<p>一旦我们与合作商达成协议，确定了合作的细节和点位，我们就可以安排工作人员去投放智能售货机了。这些点位将成为我们智能售货机的“家”，为消费者提供便捷的购买服务。</p>
<p>点位管理主要涉及到三个功能模块，业务流程如下：</p>
<ol>
<li><strong>登录系统</strong>：后台管理人员登录后台系统</li>
<li><strong>新增区域</strong>: 后台管理人员可以添加区域范围，区域范围与运维/运维人员挂钩，区域下可关联点位。</li>
<li><strong>新增合作商</strong>: 管理人员可以添加合作商，合作商与点位进行关联。</li>
<li><strong>新增区域点位</strong>: 后台管理人员可以在特定区域内新增点位，这些点位是放置智能售货机的具体位置。</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">    A[登录系统] </span><br><span class="line">    A --&gt; B[新增区域]</span><br><span class="line">    B --&gt; C[新增合作商]</span><br><span class="line">    C --&gt; D[新增区域点位]</span><br></pre></td></tr></table></figure>
<p><img src="image-20240520200927616.png" alt="image-20240520200927616"></p>
<h2 id="库表设计-1"><a href="#库表设计-1" class="headerlink" title="库表设计"></a>库表设计</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">你是一位软件工程师，帮我生成MySQL的表结构</span><br><span class="line">需求如下：</span><br><span class="line">1，区域表，表名tb<span class="emphasis">_region，字段有主键id、区域名称</span></span><br><span class="line"><span class="emphasis">2，合作商表，表名tb_</span>partner，字段有主键id、合作商名称、联系人、联系电话、分成比例（int类型）、账号、密码</span><br><span class="line">3，点位表，表名tb<span class="emphasis">_node，字段有主键id、点位名称、详细地址、商圈类型（int类型）</span></span><br><span class="line"><span class="emphasis">其他要求：</span></span><br><span class="line"><span class="emphasis">1，每张表中都有创建时间(create_</span>time)、修改时间(date<span class="emphasis">_time)、创建人(create_</span>by)、修改人(update<span class="emphasis">_by)、备注(remark)这些字段</span></span><br><span class="line"><span class="emphasis">2，每张表的主键都是自增的</span></span><br><span class="line"><span class="emphasis">3，区域与点位是一对多的关系，合作商与点位是一对多的关系，请用字段表示出来，并建立外键约束</span></span><br><span class="line"><span class="emphasis">4，请为所有字段都添加上comment</span></span><br><span class="line"><span class="emphasis">5，帮我给生成的表中插入一些北京城市相关区域、点位、合作商的测试数据</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `tb_region` (</span><br><span class="line">  `id` <span class="type">INT</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;主键id&#x27;</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">  `region_name` <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;区域名称&#x27;</span>,</span><br><span class="line">  `create_time` <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">  `update_time` <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;修改时间&#x27;</span>,</span><br><span class="line">  `create_by` <span class="type">VARCHAR</span>(<span class="number">64</span>) COMMENT <span class="string">&#x27;创建人&#x27;</span>,</span><br><span class="line">  `update_by` <span class="type">VARCHAR</span>(<span class="number">64</span>) COMMENT <span class="string">&#x27;修改人&#x27;</span>,</span><br><span class="line">  `remark` TEXT COMMENT <span class="string">&#x27;备注&#x27;</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 COMMENT<span class="operator">=</span><span class="string">&#x27;区域表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插入测试数据</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_region` (`region_name`,`remark`) <span class="keyword">VALUES</span> (<span class="string">&#x27;北京市朝阳区&#x27;</span>,<span class="string">&#x27;北京市朝阳区&#x27;</span>), (<span class="string">&#x27;北京市海淀区&#x27;</span>,<span class="string">&#x27;北京市海淀区&#x27;</span>), (<span class="string">&#x27;北京市东城区&#x27;</span>,<span class="string">&#x27;北京市东城区&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `tb_partner` (</span><br><span class="line">  `id` <span class="type">INT</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;主键id&#x27;</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">  `partner_name` <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;合作商名称&#x27;</span>,</span><br><span class="line">  `contact_person` <span class="type">VARCHAR</span>(<span class="number">64</span>) COMMENT <span class="string">&#x27;联系人&#x27;</span>,</span><br><span class="line">  `contact_phone` <span class="type">VARCHAR</span>(<span class="number">15</span>) COMMENT <span class="string">&#x27;联系电话&#x27;</span>,</span><br><span class="line">  `profit_ratio` <span class="type">INT</span> COMMENT <span class="string">&#x27;分成比例&#x27;</span>,</span><br><span class="line">  `account` <span class="type">VARCHAR</span>(<span class="number">64</span>) COMMENT <span class="string">&#x27;账号&#x27;</span>,</span><br><span class="line">  `password` <span class="type">VARCHAR</span>(<span class="number">64</span>) COMMENT <span class="string">&#x27;密码&#x27;</span>,</span><br><span class="line">  `create_time` <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">  `update_time` <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;修改时间&#x27;</span>,</span><br><span class="line">  `create_by` <span class="type">VARCHAR</span>(<span class="number">64</span>) COMMENT <span class="string">&#x27;创建人&#x27;</span>,</span><br><span class="line">  `update_by` <span class="type">VARCHAR</span>(<span class="number">64</span>) COMMENT <span class="string">&#x27;修改人&#x27;</span>,</span><br><span class="line">  `remark` TEXT COMMENT <span class="string">&#x27;备注&#x27;</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 COMMENT<span class="operator">=</span><span class="string">&#x27;合作商表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插入测试数据</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_partner` (`partner_name`, `contact_person`, `contact_phone`, `profit_ratio`, `account`, `password`) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="string">&#x27;合作商A&#x27;</span>, <span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;13800138000&#x27;</span>, <span class="number">30</span>, <span class="string">&#x27;a001&#x27;</span>, <span class="string">&#x27;pwdA&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;合作商B&#x27;</span>, <span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;13912345678&#x27;</span>, <span class="number">25</span>, <span class="string">&#x27;b002&#x27;</span>, <span class="string">&#x27;pwdB&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `tb_node` (</span><br><span class="line">  `id` <span class="type">INT</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;主键id&#x27;</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">  `node_name` <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;点位名称&#x27;</span>,</span><br><span class="line">  `address` <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;详细地址&#x27;</span>,</span><br><span class="line">  `business_type` <span class="type">INT</span> COMMENT <span class="string">&#x27;商圈类型&#x27;</span>,</span><br><span class="line">  `region_id` <span class="type">INT</span> COMMENT <span class="string">&#x27;区域ID&#x27;</span>,</span><br><span class="line">  `partner_id` <span class="type">INT</span> COMMENT <span class="string">&#x27;合作商ID&#x27;</span>,</span><br><span class="line">  `create_time` <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">  `update_time` <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;修改时间&#x27;</span>,</span><br><span class="line">  `create_by` <span class="type">VARCHAR</span>(<span class="number">64</span>) COMMENT <span class="string">&#x27;创建人&#x27;</span>,</span><br><span class="line">  `update_by` <span class="type">VARCHAR</span>(<span class="number">64</span>) COMMENT <span class="string">&#x27;修改人&#x27;</span>,</span><br><span class="line">  `remark` TEXT COMMENT <span class="string">&#x27;备注&#x27;</span>,</span><br><span class="line">  <span class="keyword">FOREIGN</span> KEY (`region_id`) <span class="keyword">REFERENCES</span> `tb_region`(`id`) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE <span class="keyword">ON</span> <span class="keyword">UPDATE</span> CASCADE,</span><br><span class="line">  <span class="keyword">FOREIGN</span> KEY (`partner_id`) <span class="keyword">REFERENCES</span> `tb_partner`(`id`) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE <span class="keyword">ON</span> <span class="keyword">UPDATE</span> CASCADE</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 COMMENT<span class="operator">=</span><span class="string">&#x27;点位表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插入测试数据</span></span><br><span class="line"><span class="comment">-- 假设区域ID为1对应&#x27;北京市朝阳区&#x27;，合作商ID为1对应&#x27;合作商A&#x27;</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_node` (`node_name`, `address`, `business_type`, `region_id`, `partner_id`) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="string">&#x27;三里屯点位&#x27;</span>, <span class="string">&#x27;北京市朝阳区三里屯路&#x27;</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;五道口点位&#x27;</span>, <span class="string">&#x27;北京市海淀区五道口&#x27;</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>);</span><br></pre></td></tr></table></figure>
<p>对于点位管理数据模型，下面是示意图：</p>
<ul>
<li><p>关系字段：region_id、partner_id</p>
</li>
<li><p>数据字典：business_type <img src="image-20240527171905791.png" alt="image-20240527171905791"></p>
<p><img src="image-20240604212450821.png" alt="image-20240604212450821">  </p>
</li>
</ul>
<h2 id="生成基础代码"><a href="#生成基础代码" class="headerlink" title="生成基础代码"></a>生成基础代码</h2><h3 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h3><p>使用若依代码生成器，生成区域管理、合作商管理、点位管理前后端基础代码，并导入到项目中：</p>
<p><img src="image-20240520191900302.png" alt="image-20240520191900302"></p>
<h3 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h3><h4 id="①创建目录菜单"><a href="#①创建目录菜单" class="headerlink" title="①创建目录菜单"></a>①创建目录菜单</h4><p>创建点位管理目录菜单</p>
<p><img src="image-20240520192424147.png" alt="image-20240520192424147">  <img src="image-20240520192122055.png" alt="image-20240520192424147"></p>
<h4 id="②添加数据字典"><a href="#②添加数据字典" class="headerlink" title="②添加数据字典"></a>②添加数据字典</h4><p>先创建<code>商圈</code>的字典类型</p>
<p> <img src="image-20240521094532290.png" alt="image-20240521094532290"></p>
<p><img src="image-20240521094625483.png" alt="image-20240521094625483"></p>
<p>再创建<code>商圈</code>的字典数据</p>
<p><img src="image-20240521094714656.png" alt="image-20240521094714656"></p>
<p><img src="image-20240521094828280.png" alt="image-20240521094828280">  </p>
<h4 id="③配置代码生成信息"><a href="#③配置代码生成信息" class="headerlink" title="③配置代码生成信息"></a>③配置代码生成信息</h4><p>导入三张表</p>
<p><img src="image-20240521095341985.png" alt="image-20240521095341985"></p>
<p>配置合作商表（参考原型）</p>
<p><img src="image-20240520195705524.png" alt="image-20240520195705524"></p>
<p><img src="image-20240605101454103.png" alt="image-20240605101454103">  </p>
<p><img src="image-20240521100933980.png" alt="image-20240521100933980"></p>
<p>配置区域表（参考原型）</p>
<p><img src="image-20240521100154862.png" alt="image-20240521100154862"></p>
<p><img src="image-20240605101338740.png" alt="image-20240605101338740"></p>
<p><img src="image-20240521101741695.png" alt="image-20240521101741695">  </p>
<p>配置点位表（参考原型）</p>
<p><img src="image-20240520200439529.png" alt="image-20240520200439529"></p>
<p><img src="image-20240605101546273.png" alt="image-20240605101546273"></p>
<p><img src="image-20240521100818303.png" alt="image-20240521100818303"></p>
<h4 id="④下载代码并导入项目"><a href="#④下载代码并导入项目" class="headerlink" title="④下载代码并导入项目"></a>④下载代码并导入项目</h4><p>选中三张表生成下载</p>
<p><img src="image-20240521101119476.png" alt="image-20240521101119476"></p>
<p>解压<code>ruoyi.zip</code>得到前后端代码和动态菜单sql</p>
<p><img src="image-20240521101354165.png" alt="image-20240521101354165"></p>
<p>代码导入</p>
<p><img src="image-20240521121836288.png" alt="image-20240521121836288">  <img src="image-20240521121935608.png" alt="image-20240521121935608"></p>
<p>调整二级菜单显示顺序</p>
<p><img src="image-20240521101613667.png" alt="image-20240521101613667"></p>
<h2 id="区域管理改造"><a href="#区域管理改造" class="headerlink" title="区域管理改造"></a>区域管理改造</h2><h3 id="基础页面"><a href="#基础页面" class="headerlink" title="基础页面"></a>基础页面</h3><h4 id="需求-1"><a href="#需求-1" class="headerlink" title="需求"></a>需求</h4><p>参考页面原型，完成基础布局展示改造</p>
<p><img src="image-20240521122929449.png" alt="image-20240521122929449"></p>
<h4 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h4><p>在region/index.vue视图组件中修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 区域列表 --&gt;</span><br><span class="line">&lt;el-table v-loading=&quot;loading&quot; :data=&quot;regionList&quot; @selection-change=&quot;handleSelectionChange&quot;&gt;</span><br><span class="line">    &lt;el-table-column type=&quot;selection&quot; width=&quot;55&quot; align=&quot;center&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;序号&quot; type=&quot;index&quot; width=&quot;50&quot; align=&quot;center&quot; prop=&quot;id&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;区域名称&quot; align=&quot;center&quot; prop=&quot;regionName&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;备注说明&quot; align=&quot;center&quot; prop=&quot;remark&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;操作&quot; align=&quot;center&quot; class-name=&quot;small-padding fixed-width&quot;&gt;</span><br><span class="line">        &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">  &lt;el-button link type=&quot;primary&quot;  @click=&quot;handleUpdate(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:region:edit&#x27;]&quot;&gt;修改&lt;/el-button&gt;</span><br><span class="line">  &lt;el-button link type=&quot;primary&quot;  @click=&quot;handleDelete(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:region:remove&#x27;]&quot;&gt;删除&lt;/el-button&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">    &lt;/el-table-column&gt;</span><br><span class="line">&lt;/el-table&gt;</span><br></pre></td></tr></table></figure>
<h3 id="区域列表"><a href="#区域列表" class="headerlink" title="区域列表"></a>区域列表</h3><h4 id="需求-2"><a href="#需求-2" class="headerlink" title="需求"></a>需求</h4><p>在区域列表查询中，需要显示每个区域的点位数</p>
<p><img src="1-5.png" alt=""></p>
<h4 id="实现思路"><a href="#实现思路" class="headerlink" title="实现思路"></a>实现思路</h4><p>实现此功能也有多种方案：</p>
<p><strong>（1）同步存储：</strong>在区域表中有点位数的字段，当点位发生变化时，同步区域表中的点位数。</p>
<ul>
<li>优点：由于是单表查询操作，查询列表效率最高。</li>
<li>缺点：需要在点位增删改时修改区域表中的数据，有额外的开销，数据也可能不一致。</li>
</ul>
<p><strong>（2）关联查询：</strong>编写关联查询语句，在mapper 层封装。</p>
<ul>
<li>优点：实时查询，数据100%正确，不需要单独维护。</li>
<li>缺点：SQL语句较复杂，如果数据量大，性能比较低。</li>
</ul>
<p>区域和点位表，记录个数都不是很多，所以我们采用关联查询这种方案。</p>
<p><img src="image-20240605165826567.png" alt="image-20240605165826567"></p>
<h4 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h4><p>SQL查询：先聚合统计每个区域的点位数，然后与区域表进行关联查询</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 传统模式</span></span><br><span class="line"><span class="comment">-- 1.先聚合统计每个区域下的点位数</span></span><br><span class="line"><span class="comment">-- 确定查询表 tb_node</span></span><br><span class="line"><span class="comment">-- 确定分组字段 region_id</span></span><br><span class="line"><span class="keyword">select</span> region_id,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> node_count <span class="keyword">from</span> tb_node <span class="keyword">group</span> <span class="keyword">by</span> region_id;</span><br><span class="line"><span class="comment">-- 2.然后与区域表进行关联查询</span></span><br><span class="line"><span class="keyword">select</span> r.id,r.region_name,r.remark,ifnull(n.node_count,<span class="number">0</span>) <span class="keyword">as</span> node_count <span class="keyword">from</span> tb_region r</span><br><span class="line">    <span class="keyword">left</span> <span class="keyword">join</span> (<span class="keyword">select</span> region_id,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> node_count <span class="keyword">from</span> tb_node <span class="keyword">group</span> <span class="keyword">by</span> region_id) n <span class="keyword">on</span> r.id<span class="operator">=</span>n.region_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- AI辅助编程模式</span></span><br><span class="line"><span class="comment">-- 查询区域表所有的信息,需要显示每个区域的点位数</span></span><br><span class="line"><span class="keyword">SELECT</span> r.<span class="operator">*</span>, <span class="built_in">COUNT</span>(n.id) <span class="keyword">AS</span> node_count <span class="keyword">FROM</span> tb_region r <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> tb_node n <span class="keyword">ON</span> r.id <span class="operator">=</span> n.region_id <span class="keyword">GROUP</span> <span class="keyword">BY</span> r.id;</span><br></pre></td></tr></table></figure>
<h4 id="RegionVo"><a href="#RegionVo" class="headerlink" title="RegionVo"></a>RegionVo</h4><p>根据接口文档和sql创建RegionVo</p>
<p><img src="image-20240521125020524.png" alt="image-20240521125020524"></p>
<h4 id="RegionMapper"><a href="#RegionMapper" class="headerlink" title="RegionMapper"></a>RegionMapper</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询区域管理列表</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> region</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> RegionVo集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> List&lt;RegionVo&gt; <span class="title function_">selectRegionVoList</span><span class="params">(Region region)</span>;</span><br></pre></td></tr></table></figure>
<h4 id="RegionMapper-xml"><a href="#RegionMapper-xml" class="headerlink" title="RegionMapper.xml"></a>RegionMapper.xml</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectRegionVoList&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.dkd.manage.domain.vo.RegionVo&quot;</span>&gt;</span></span><br><span class="line">select r.id,r.region_name,r.remark,ifnull(n.node_count,0) as node_count from tb_region r</span><br><span class="line">    left join (select region_id,count(*) as node_count from tb_node group by region_id) n on r.id=n.region_id</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;regionName != null  and regionName != &#x27;&#x27;&quot;</span>&gt;</span> and r.region_name like concat(&#x27;%&#x27;, #&#123;regionName&#125;, &#x27;%&#x27;)<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="mybatis-config-xml"><a href="#mybatis-config-xml" class="headerlink" title="mybatis-config.xml"></a>mybatis-config.xml</h4><p><img src="image-20240521131706554.png" alt="image-20240521131706554"></p>
<h4 id="IRegionService"><a href="#IRegionService" class="headerlink" title="IRegionService"></a>IRegionService</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询区域管理列表</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> region</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> RegionVo集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> List&lt;RegionVo&gt; <span class="title function_">selectRegionVoList</span><span class="params">(Region region)</span>;</span><br></pre></td></tr></table></figure>
<h4 id="RegionServiceImpl"><a href="#RegionServiceImpl" class="headerlink" title="RegionServiceImpl"></a>RegionServiceImpl</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询区域管理列表</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> region</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> RegionVo集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;RegionVo&gt; <span class="title function_">selectRegionVoList</span><span class="params">(Region region)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> regionMapper.selectRegionVoList(region);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="RegionController"><a href="#RegionController" class="headerlink" title="RegionController"></a>RegionController</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询区域管理列表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PreAuthorize(&quot;@ss.hasPermi(&#x27;manage:region:list&#x27;)&quot;)</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/list&quot;)</span></span><br><span class="line"><span class="keyword">public</span> TableDataInfo <span class="title function_">list</span><span class="params">(Region region)</span></span><br><span class="line">&#123;</span><br><span class="line">    startPage();</span><br><span class="line">    List&lt;RegionVo&gt; voList = regionService.selectRegionVoList(region);</span><br><span class="line">    <span class="keyword">return</span> getDataTable(voList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="region-index-vue"><a href="#region-index-vue" class="headerlink" title="region/index.vue"></a>region/index.vue</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 区域列表 --&gt;</span><br><span class="line">&lt;el-table v-loading=&quot;loading&quot; :data=&quot;regionList&quot; @selection-change=&quot;handleSelectionChange&quot;&gt;</span><br><span class="line">  &lt;el-table-column type=&quot;selection&quot; width=&quot;55&quot; align=&quot;center&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;序号&quot; type=&quot;index&quot; width=&quot;50&quot; align=&quot;center&quot; prop=&quot;id&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;区域名称&quot; align=&quot;center&quot; prop=&quot;regionName&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;点位数&quot; align=&quot;center&quot; prop=&quot;nodeCount&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;备注说明&quot; align=&quot;center&quot; prop=&quot;remark&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;操作&quot; align=&quot;center&quot; class-name=&quot;small-padding fixed-width&quot;&gt;</span><br><span class="line">    &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">      &lt;el-button link type=&quot;primary&quot;  @click=&quot;handleUpdate(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:region:edit&#x27;]&quot;&gt;修改&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button link type=&quot;primary&quot;  @click=&quot;handleDelete(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:region:remove&#x27;]&quot;&gt;删除&lt;/el-button&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/el-table-column&gt;</span><br><span class="line">&lt;/el-table&gt;</span><br></pre></td></tr></table></figure>
<h2 id="合作商管理改造"><a href="#合作商管理改造" class="headerlink" title="合作商管理改造"></a>合作商管理改造</h2><h3 id="基础页面-1"><a href="#基础页面-1" class="headerlink" title="基础页面"></a>基础页面</h3><h4 id="需求-3"><a href="#需求-3" class="headerlink" title="需求"></a>需求</h4><p>参考页面原型，完成基础布局展示改造</p>
<p><img src="image-20240521134037713.png" alt="image-20240521134037713"></p>
<h4 id="代码实现-1"><a href="#代码实现-1" class="headerlink" title="代码实现"></a>代码实现</h4><p>在partner/index.vue视图组件中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 搜索区域 --&gt;</span><br><span class="line">&lt;el-form :model=&quot;queryParams&quot; ref=&quot;queryRef&quot; :inline=&quot;true&quot; v-show=&quot;showSearch&quot; label-width=&quot;90px&quot;&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;合作商名称&quot; prop=&quot;name&quot;&gt;</span><br><span class="line">        &lt;el-input</span><br><span class="line">                  v-model=&quot;queryParams.partnerName&quot; placeholder=&quot;请输入合作商名称&quot;</span><br><span class="line">                  clearable @keyup.enter=&quot;handleQuery&quot;/&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item&gt;</span><br><span class="line">        &lt;el-button type=&quot;primary&quot; icon=&quot;Search&quot; @click=&quot;handleQuery&quot;&gt;搜索&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button icon=&quot;Refresh&quot; @click=&quot;resetQuery&quot;&gt;重置&lt;/el-button&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">&lt;/el-form&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;!-- 合作商列表 --&gt;</span><br><span class="line">&lt;el-table v-loading=&quot;loading&quot; :data=&quot;partnerList&quot; @selection-change=&quot;handleSelectionChange&quot;&gt;</span><br><span class="line">  &lt;el-table-column type=&quot;selection&quot; width=&quot;55&quot; align=&quot;center&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;序号&quot; type=&quot;index&quot; width=&quot;50&quot; align=&quot;center&quot; prop=&quot;id&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;合作商名称&quot; align=&quot;center&quot; prop=&quot;partnerName&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;账号&quot; align=&quot;center&quot; prop=&quot;account&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;分成比例&quot; align=&quot;center&quot; prop=&quot;profitRatio&quot; &gt;</span><br><span class="line">    &lt;template #default=&quot;scope&quot;&gt;&#123;&#123;scope.row.profitRatio&#125;&#125;%&lt;/template&gt;</span><br><span class="line">  &lt;/el-table-column&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;联系人&quot; align=&quot;center&quot; prop=&quot;contactPerson&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;联系电话&quot; align=&quot;center&quot; prop=&quot;contactPhone&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;操作&quot; align=&quot;center&quot; class-name=&quot;small-padding fixed-width&quot;&gt;</span><br><span class="line">    &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">      &lt;el-button link type=&quot;primary&quot;  @click=&quot;handleUpdate(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:partner:edit&#x27;]&quot;&gt;修改&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button link type=&quot;primary&quot;  @click=&quot;handleDelete(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:partner:remove&#x27;]&quot;&gt;删除&lt;/el-button&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/el-table-column&gt;</span><br><span class="line">&lt;/el-table&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 添加或修改合作商管理对话框 --&gt;</span><br><span class="line">&lt;el-dialog :title=&quot;title&quot; v-model=&quot;open&quot; width=&quot;500px&quot; append-to-body&gt;</span><br><span class="line">  &lt;el-form ref=&quot;partnerRef&quot; :model=&quot;form&quot; :rules=&quot;rules&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;合作商名称&quot; prop=&quot;partnerName&quot;&gt;</span><br><span class="line">      &lt;el-input v-model=&quot;form.partnerName&quot; placeholder=&quot;请输入合作商名称&quot; /&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;联系人&quot; prop=&quot;contactPerson&quot;&gt;</span><br><span class="line">      &lt;el-input v-model=&quot;form.contactPerson&quot; placeholder=&quot;请输入联系人&quot; /&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;联系电话&quot; prop=&quot;contactPhone&quot;&gt;</span><br><span class="line">      &lt;el-input v-model=&quot;form.contactPhone&quot; placeholder=&quot;请输入联系电话&quot; /&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;创建时间&quot; prop=&quot;contactPhone&quot; v-if=&quot;form.id!=null&quot;&gt;</span><br><span class="line">      &#123;&#123;form.createTime&#125;&#125;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;分成比例&quot; prop=&quot;profitRatio&quot;&gt;</span><br><span class="line">      &lt;el-input v-model=&quot;form.profitRatio&quot; placeholder=&quot;请输入分成比例&quot; /&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;账号&quot; prop=&quot;account&quot; v-if=&quot;form.id==null&quot;&gt;</span><br><span class="line">      &lt;el-input v-model=&quot;form.account&quot; placeholder=&quot;请输入账号&quot; /&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;密码&quot; prop=&quot;password&quot; v-if=&quot;form.id==null&quot;&gt;</span><br><span class="line">      &lt;el-input v-model=&quot;form.password&quot; type=&quot;password&quot; placeholder=&quot;请输入密码&quot; /&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">  &lt;/el-form&gt;</span><br><span class="line">  &lt;template #footer&gt;</span><br><span class="line">    &lt;div class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">      &lt;el-button type=&quot;primary&quot; @click=&quot;submitForm&quot;&gt;确 定&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button @click=&quot;cancel&quot;&gt;取 消&lt;/el-button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/template&gt;</span><br><span class="line">&lt;/el-dialog&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<p>在PartnerServiceImpl的新增方法中修改</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 新增合作商</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> partner 合作商</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">insertPartner</span><span class="params">(Partner partner)</span> &#123;</span><br><span class="line">    <span class="comment">// 使用SecurityUtil工具类，对密码加密</span></span><br><span class="line">    partner.setPassword(SecurityUtils.encryptPassword(partner.getPassword()));</span><br><span class="line">    partner.setCreateTime(DateUtils.getNowDate());</span><br><span class="line">    <span class="keyword">return</span> partnerMapper.insertPartner(partner);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="查看详情"><a href="#查看详情" class="headerlink" title="查看详情"></a>查看详情</h3><p>在partner/index.vue视图组件中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-button link type=&quot;primary&quot; @click=&quot;getPartnerInfo(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:partner:query&#x27;]&quot;&gt;查看详情&lt;/el-button&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;!-- 查看合作商详情 --&gt;</span><br><span class="line">&lt;el-dialog title=&quot;合作商详情&quot; v-model=&quot;partnerInfoOpen&quot; width=&quot;500px&quot; append-to-body&gt;</span><br><span class="line">    &lt;el-row&gt;</span><br><span class="line">        &lt;el-col :span=&quot;12&quot;&gt;合作商名称：&#123;&#123; form.partnerName &#125;&#125;&lt;/el-col&gt;</span><br><span class="line">        &lt;el-col :span=&quot;12&quot;&gt;联系人：&#123;&#123; form.contactPerson &#125;&#125;&lt;/el-col&gt;</span><br><span class="line">    &lt;/el-row&gt;</span><br><span class="line">    &lt;el-row&gt;</span><br><span class="line">        &lt;el-col :span=&quot;12&quot;&gt;联系电话：&#123;&#123; form.contactPhone &#125;&#125;&lt;/el-col&gt;</span><br><span class="line">        &lt;el-col :span=&quot;12&quot;&gt;分成比例：&#123;&#123; form.profitRatio &#125;&#125;%&lt;/el-col&gt;</span><br><span class="line">    &lt;/el-row&gt;</span><br><span class="line">&lt;/el-dialog&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    /* 查看合作商详情 */</span><br><span class="line">    const partnerInfoOpen = ref(false);</span><br><span class="line">    function getPartnerInfo(row) &#123;</span><br><span class="line">        reset();</span><br><span class="line">        const _id = row.id;</span><br><span class="line">        getPartner(_id).then(response =&gt; &#123;</span><br><span class="line">            form.value = response.data;</span><br><span class="line">            partnerInfoOpen.value = true;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 查看合作商详情对话框 --&gt;</span><br><span class="line">&lt;el-dialog title=&quot;合作商详情&quot; v-model=&quot;partnerInfoOpen&quot; width=&quot;500px&quot; append-to-body&gt;</span><br><span class="line">    &lt;!-- 使用el-descriptions组件以卡片形式展示信息，更加整洁 --&gt;</span><br><span class="line">    &lt;el-descriptions :column=&quot;2&quot; border&gt;</span><br><span class="line">        &lt;el-descriptions-item label=&quot;合作商名称&quot;&gt;&#123;&#123; form.partnerName &#125;&#125;&lt;/el-descriptions-item&gt;</span><br><span class="line">        &lt;el-descriptions-item label=&quot;联系人&quot;&gt;&#123;&#123; form.contactPerson &#125;&#125;&lt;/el-descriptions-item&gt;</span><br><span class="line">        &lt;el-descriptions-item label=&quot;联系电话&quot;&gt;&#123;&#123; form.contactPhone &#125;&#125;&lt;/el-descriptions-item&gt;</span><br><span class="line">        &lt;el-descriptions-item label=&quot;分成比例&quot;&gt;&#123;&#123; form.profitRatio &#125;&#125;%&lt;/el-descriptions-item&gt;</span><br><span class="line">    &lt;/el-descriptions&gt;</span><br><span class="line">&lt;/el-dialog&gt;</span><br></pre></td></tr></table></figure>
<h3 id="合作商列表"><a href="#合作商列表" class="headerlink" title="合作商列表"></a>合作商列表</h3><h4 id="实现思路-1"><a href="#实现思路-1" class="headerlink" title="实现思路"></a>实现思路</h4><p>与区域列表实现方式相同。</p>
<p><img src="image-20240607111610267.png" alt="image-20240607111610267"></p>
<h4 id="SQL-1"><a href="#SQL-1" class="headerlink" title="SQL"></a>SQL</h4><p>SQL查询：先聚合统计每个合作商的点位数，然后与合作商表进行关联查询</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 传统模式</span></span><br><span class="line"><span class="comment">-- 1.先聚合统计每个合作商的点位数</span></span><br><span class="line"><span class="comment">-- 确定查询的表 tb_node</span></span><br><span class="line"><span class="comment">-- 确定分组字段 partner_id</span></span><br><span class="line"><span class="keyword">SELECT</span> partner_id, <span class="built_in">COUNT</span>(<span class="number">1</span>) <span class="keyword">AS</span> node_count <span class="keyword">from</span> tb_node <span class="keyword">group</span> <span class="keyword">by</span> partner_id;</span><br><span class="line"><span class="comment">-- 2.然后与合作商表进行关联查询</span></span><br><span class="line"><span class="keyword">select</span> tp.<span class="operator">*</span>,ifnull(tn.node_count,<span class="number">0</span>) <span class="keyword">from</span> tb_partner tp</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> (<span class="keyword">SELECT</span> partner_id, <span class="built_in">COUNT</span>(<span class="number">1</span>) <span class="keyword">AS</span> node_count <span class="keyword">from</span> tb_node <span class="keyword">group</span> <span class="keyword">by</span> partner_id) tn <span class="keyword">on</span> tn.partner_id <span class="operator">=</span> tp.id;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- AI辅助编程模式</span></span><br><span class="line"><span class="comment">-- 你是一个软件开发工程师，现在要根据数据库的sql脚本，查询并显示合作商表所有的字段信息,同时显示每个合作商的点位数，sql脚本如下</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tb_node</span><br><span class="line">(</span><br><span class="line">    id            <span class="type">int</span> auto_increment comment <span class="string">&#x27;主键id&#x27;</span></span><br><span class="line">        <span class="keyword">primary</span> key,</span><br><span class="line">    node_name     <span class="type">varchar</span>(<span class="number">255</span>)                        <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;点位名称&#x27;</span>,</span><br><span class="line">    address       <span class="type">varchar</span>(<span class="number">255</span>)                        <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;详细地址&#x27;</span>,</span><br><span class="line">    business_type <span class="type">int</span>                                 <span class="keyword">null</span> comment <span class="string">&#x27;商圈类型&#x27;</span>,</span><br><span class="line">    region_id     <span class="type">int</span>                                 <span class="keyword">null</span> comment <span class="string">&#x27;区域ID&#x27;</span>,</span><br><span class="line">    partner_id    <span class="type">int</span>                                 <span class="keyword">null</span> comment <span class="string">&#x27;合作商ID&#x27;</span>,</span><br><span class="line">    create_time   <span class="type">timestamp</span> <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">null</span> comment <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">    update_time   <span class="type">timestamp</span> <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">null</span> <span class="keyword">on</span> <span class="keyword">update</span> <span class="built_in">CURRENT_TIMESTAMP</span> comment <span class="string">&#x27;修改时间&#x27;</span>,</span><br><span class="line">    create_by     <span class="type">varchar</span>(<span class="number">64</span>)                         <span class="keyword">null</span> comment <span class="string">&#x27;创建人&#x27;</span>,</span><br><span class="line">    update_by     <span class="type">varchar</span>(<span class="number">64</span>)                         <span class="keyword">null</span> comment <span class="string">&#x27;修改人&#x27;</span>,</span><br><span class="line">    remark        text                                <span class="keyword">null</span> comment <span class="string">&#x27;备注&#x27;</span>,</span><br><span class="line">    <span class="keyword">constraint</span> tb_node_ibfk_1</span><br><span class="line">        <span class="keyword">foreign</span> key (region_id) <span class="keyword">references</span> tb_region (id)</span><br><span class="line">            <span class="keyword">on</span> <span class="keyword">update</span> cascade <span class="keyword">on</span> <span class="keyword">delete</span> cascade,</span><br><span class="line">    <span class="keyword">constraint</span> tb_node_ibfk_2</span><br><span class="line">        <span class="keyword">foreign</span> key (partner_id) <span class="keyword">references</span> tb_partner (id)</span><br><span class="line">            <span class="keyword">on</span> <span class="keyword">update</span> cascade <span class="keyword">on</span> <span class="keyword">delete</span> cascade</span><br><span class="line">)</span><br><span class="line">    comment <span class="string">&#x27;点位表&#x27;</span>;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tb_partner</span><br><span class="line">(</span><br><span class="line">    id             <span class="type">int</span> auto_increment comment <span class="string">&#x27;主键id&#x27;</span></span><br><span class="line">        <span class="keyword">primary</span> key,</span><br><span class="line">    partner_name   <span class="type">varchar</span>(<span class="number">255</span>)                        <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;合作商名称&#x27;</span>,</span><br><span class="line">    contact_person <span class="type">varchar</span>(<span class="number">64</span>)                         <span class="keyword">null</span> comment <span class="string">&#x27;联系人&#x27;</span>,</span><br><span class="line">    contact_phone  <span class="type">varchar</span>(<span class="number">15</span>)                         <span class="keyword">null</span> comment <span class="string">&#x27;联系电话&#x27;</span>,</span><br><span class="line">    profit_ratio   <span class="type">int</span>                                 <span class="keyword">null</span> comment <span class="string">&#x27;分成比例&#x27;</span>,</span><br><span class="line">    account        <span class="type">varchar</span>(<span class="number">64</span>)                         <span class="keyword">null</span> comment <span class="string">&#x27;账号&#x27;</span>,</span><br><span class="line">    password       <span class="type">varchar</span>(<span class="number">64</span>)                         <span class="keyword">null</span> comment <span class="string">&#x27;密码&#x27;</span>,</span><br><span class="line">    create_time    <span class="type">timestamp</span> <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">null</span> comment <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">    update_time    <span class="type">timestamp</span> <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">null</span> <span class="keyword">on</span> <span class="keyword">update</span> <span class="built_in">CURRENT_TIMESTAMP</span> comment <span class="string">&#x27;修改时间&#x27;</span>,</span><br><span class="line">    create_by      <span class="type">varchar</span>(<span class="number">64</span>)                         <span class="keyword">null</span> comment <span class="string">&#x27;创建人&#x27;</span>,</span><br><span class="line">    update_by      <span class="type">varchar</span>(<span class="number">64</span>)                         <span class="keyword">null</span> comment <span class="string">&#x27;修改人&#x27;</span>,</span><br><span class="line">    remark         text                                <span class="keyword">null</span> comment <span class="string">&#x27;备注&#x27;</span></span><br><span class="line">)</span><br><span class="line">    comment <span class="string">&#x27;合作商表&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h4 id="PartnerVo"><a href="#PartnerVo" class="headerlink" title="PartnerVo"></a>PartnerVo</h4><p>根据接口文档和sql创建PartnerVo</p>
<p><img src="image-20240524173300573.png" alt="image-20240524173300573">  </p>
<h4 id="PartnerMapper"><a href="#PartnerMapper" class="headerlink" title="PartnerMapper"></a>PartnerMapper</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询合作商管理列表</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> partner</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> partnerVo集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> List&lt;PartnerVo&gt; <span class="title function_">selectPartnerVoList</span><span class="params">(Partner partner)</span>;</span><br></pre></td></tr></table></figure>
<h4 id="PartnerMapper-xml"><a href="#PartnerMapper-xml" class="headerlink" title="PartnerMapper.xml"></a>PartnerMapper.xml</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectPartnerVoList&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.dkd.manage.domain.vo.PartnerVo&quot;</span>&gt;</span></span><br><span class="line">    SELECT p.*, COUNT(n.id) AS node_count FROM tb_partner p</span><br><span class="line">    LEFT JOIN tb_node n ON p.id = n.partner_id</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;partnerName != null  and partnerName != &#x27;&#x27;&quot;</span>&gt;</span>and partner_name like concat(&#x27;%&#x27;, #&#123;partnerName&#125;,&#x27;%&#x27;)</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">    GROUP BY p.id</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="IPartnerService"><a href="#IPartnerService" class="headerlink" title="IPartnerService"></a>IPartnerService</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询合作商管理列表</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> partner</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> partnerVo集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> List&lt;PartnerVo&gt; <span class="title function_">selectPartnerVoList</span><span class="params">(Partner partner)</span>;</span><br></pre></td></tr></table></figure>
<h4 id="PartnerServiceImpl"><a href="#PartnerServiceImpl" class="headerlink" title="PartnerServiceImpl"></a>PartnerServiceImpl</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询合作商管理列表</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> partner</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> partnerVo集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;PartnerVo&gt; <span class="title function_">selectPartnerVoList</span><span class="params">(Partner partner)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> partnerMapper.selectPartnerVoList(partner);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="PartnerController"><a href="#PartnerController" class="headerlink" title="PartnerController"></a>PartnerController</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询合作商管理列表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PreAuthorize(&quot;@ss.hasPermi(&#x27;manage:partner:list&#x27;)&quot;)</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/list&quot;)</span></span><br><span class="line"><span class="keyword">public</span> TableDataInfo <span class="title function_">list</span><span class="params">(Partner partner)</span> &#123;</span><br><span class="line">    startPage();</span><br><span class="line">    List&lt;PartnerVo&gt; voList = partnerService.selectPartnerVoList(partner);</span><br><span class="line">    <span class="keyword">return</span> getDataTable(voList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="region-index-vue-1"><a href="#region-index-vue-1" class="headerlink" title="region/index.vue"></a>region/index.vue</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 合作商列表 --&gt;</span><br><span class="line">&lt;el-table v-loading=&quot;loading&quot; :data=&quot;partnerList&quot; @selection-change=&quot;handleSelectionChange&quot;&gt;</span><br><span class="line">    &lt;el-table-column type=&quot;selection&quot; width=&quot;55&quot; align=&quot;center&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;序号&quot; type=&quot;index&quot; width=&quot;50&quot; align=&quot;center&quot; prop=&quot;id&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;合作商名称&quot; align=&quot;center&quot; prop=&quot;partnerName&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;点位数&quot; align=&quot;center&quot; prop=&quot;nodeCount&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;账号&quot; align=&quot;center&quot; prop=&quot;account&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;分成比例&quot; align=&quot;center&quot; prop=&quot;profitRatio&quot; &gt;</span><br><span class="line">        &lt;template #default=&quot;scope&quot;&gt;&#123;&#123; scope.row.profitRatio &#125;&#125;%&lt;/template&gt;</span><br><span class="line">    &lt;/el-table-column&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;联系人&quot; align=&quot;center&quot; prop=&quot;contactPerson&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;联系电话&quot; align=&quot;center&quot; prop=&quot;contactPhone&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;操作&quot; align=&quot;center&quot; class-name=&quot;small-padding fixed-width&quot;&gt;</span><br><span class="line">        &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">            &lt;el-button link type=&quot;primary&quot;  @click=&quot;getParnterInfo(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:partner:query&#x27;]&quot;&gt;查看详情&lt;/el-button&gt;</span><br><span class="line">            &lt;el-button link type=&quot;primary&quot;  @click=&quot;handleUpdate(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:partner:edit&#x27;]&quot;&gt;修改&lt;/el-button&gt;</span><br><span class="line">            &lt;el-button link type=&quot;primary&quot;  @click=&quot;handleDelete(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:partner:remove&#x27;]&quot;&gt;删除&lt;/el-button&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">    &lt;/el-table-column&gt;</span><br><span class="line">&lt;/el-table&gt;</span><br></pre></td></tr></table></figure>
<h3 id="重置密码"><a href="#重置密码" class="headerlink" title="重置密码"></a>重置密码</h3><h4 id="后端部分"><a href="#后端部分" class="headerlink" title="后端部分"></a>后端部分</h4><p>在PartnerController中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 重置合作商密码</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PreAuthorize(&quot;@ss.hasPermi(&#x27;manage:partner:edit&#x27;)&quot;)</span></span><br><span class="line"><span class="meta">@Log(title = &quot;重置合作商密码&quot;, businessType = BusinessType.UPDATE)</span></span><br><span class="line"><span class="meta">@PutMapping(&quot;/resetPwd/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> AjaxResult <span class="title function_">resetpwd</span><span class="params">(<span class="meta">@PathVariable</span> Long id)</span> &#123;<span class="comment">//1. 接收参数</span></span><br><span class="line">    <span class="comment">//2. 创建合作商对象</span></span><br><span class="line">    <span class="type">Partner</span> <span class="variable">partner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Partner</span>();</span><br><span class="line">    partner.setId(id);<span class="comment">// 设置id</span></span><br><span class="line">    partner.setPassword(SecurityUtils.encryptPassword(<span class="string">&quot;123456&quot;</span>));<span class="comment">// 设置加密后的初始密码</span></span><br><span class="line">    <span class="comment">//3. 调用service更新密码</span></span><br><span class="line">    <span class="keyword">return</span> toAjax(partnerService.updatePartner(partner));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="前端部分"><a href="#前端部分" class="headerlink" title="前端部分"></a>前端部分</h4><p>在manage/partner.js请求api中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 重置合作商密码</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">resetPartnerPwd</span>(<span class="params">id</span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/manage/partner/resetPwd/&#x27;</span> + id,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;put&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在partner/index.vue视图组件中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-table-column label=&quot;操作&quot; align=&quot;center&quot; class-name=&quot;small-padding fixed-width&quot; width=&quot;300px&quot;&gt;</span><br><span class="line">    &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">  &lt;el-button link type=&quot;primary&quot; @click=&quot;resetPwd(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:partner:edit&#x27;]&quot;&gt;重置密码&lt;/el-button&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">&lt;/el-table-column&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    import &#123; listPartner, getPartner, delPartner, addPartner, updatePartner,resetPartnerPwd &#125; from &quot;@/api/manage/partner&quot;;</span><br><span class="line">    /* 重置合作商密码 */</span><br><span class="line">    function resetPwd(row) &#123;</span><br><span class="line">        proxy.$modal.confirm(&#x27;你确定要重置该合作商密码吗？&#x27;).then(function () &#123;</span><br><span class="line">            return resetPartnerPwd(row.id);</span><br><span class="line">        &#125;).then(() =&gt; &#123;</span><br><span class="line">            proxy.$modal.msgSuccess(&quot;重置成功&quot;);</span><br><span class="line">        &#125;).catch(() =&gt; &#123; &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h2 id="点位管理改造"><a href="#点位管理改造" class="headerlink" title="点位管理改造"></a>点位管理改造</h2><h3 id="基础页面-2"><a href="#基础页面-2" class="headerlink" title="基础页面"></a>基础页面</h3><h4 id="需求-4"><a href="#需求-4" class="headerlink" title="需求"></a>需求</h4><p>参考页面原型，完成基础布局展示改造</p>
<p><img src="image-20240521160012649.png" alt="image-20240521160012649"></p>
<h4 id="代码实现-2"><a href="#代码实现-2" class="headerlink" title="代码实现"></a>代码实现</h4><p>在node/index.vue视图组件中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 搜索区域 --&gt;</span><br><span class="line">&lt;el-form :model=&quot;queryParams&quot; ref=&quot;queryRef&quot; :inline=&quot;true&quot; v-show=&quot;showSearch&quot; label-width=&quot;68px&quot;&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;点位名称&quot; prop=&quot;nodeName&quot;&gt;</span><br><span class="line">        &lt;el-input v-model=&quot;queryParams.nodeName&quot; placeholder=&quot;请输入点位名称&quot; clearable @keyup.enter=&quot;handleQuery&quot; /&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;区域搜索&quot; prop=&quot;regionId&quot;&gt;</span><br><span class="line">        &lt;!-- &lt;el-input v-model=&quot;queryParams.regionId&quot; placeholder=&quot;请输入区域ID&quot; clearable @keyup.enter=&quot;handleQuery&quot; /&gt; --&gt;</span><br><span class="line">        &lt;el-select v-model=&quot;queryParams.regionId&quot; placeholder=&quot;请选择区域&quot; clearable&gt;</span><br><span class="line">            &lt;el-option v-for=&quot;item in regionList&quot; :key=&quot;item.id&quot; :label=&quot;item.regionName&quot; :value=&quot;item.id&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">        &lt;/el-select&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item&gt;</span><br><span class="line">        &lt;el-button type=&quot;primary&quot; icon=&quot;Search&quot; @click=&quot;handleQuery&quot;&gt;搜索&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button icon=&quot;Refresh&quot; @click=&quot;resetQuery&quot;&gt;重置&lt;/el-button&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">&lt;/el-form&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 点位列表 --&gt;</span><br><span class="line">&lt;el-table v-loading=&quot;loading&quot; :data=&quot;nodeList&quot; @selection-change=&quot;handleSelectionChange&quot;&gt;</span><br><span class="line">    &lt;el-table-column type=&quot;selection&quot; width=&quot;55&quot; align=&quot;center&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;序号&quot; type=&quot;index&quot; width=&quot;50&quot; align=&quot;center&quot; prop=&quot;id&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;点位名称&quot; align=&quot;center&quot; prop=&quot;nodeName&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;区域ID&quot; align=&quot;center&quot; prop=&quot;regionId&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;商圈类型&quot; align=&quot;center&quot; prop=&quot;businessType&quot;&gt;</span><br><span class="line">        &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">&lt;dict-tag :options=&quot;business_type&quot; :value=&quot;scope.row.businessType&quot; /&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">    &lt;/el-table-column&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;合作商ID&quot; align=&quot;center&quot; prop=&quot;partnerId&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;详细地址&quot; align=&quot;center&quot; prop=&quot;address&quot; show-overflow-tooltip/&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;操作&quot; align=&quot;center&quot; class-name=&quot;small-padding fixed-width&quot;&gt;</span><br><span class="line">        &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">&lt;el-button link type=&quot;primary&quot; icon=&quot;Edit&quot; @click=&quot;handleUpdate(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:node:edit&#x27;]&quot;&gt;修改&lt;/el-button&gt;</span><br><span class="line">&lt;el-button link type=&quot;primary&quot; icon=&quot;Delete&quot; @click=&quot;handleDelete(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:node:remove&#x27;]&quot;&gt;删除&lt;/el-button&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">    &lt;/el-table-column&gt;</span><br><span class="line">&lt;/el-table&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 添加或修改点位管理对话框 --&gt;</span><br><span class="line">&lt;el-dialog :title=&quot;title&quot; v-model=&quot;open&quot; width=&quot;500px&quot; append-to-body&gt;</span><br><span class="line">  &lt;el-form ref=&quot;nodeRef&quot; :model=&quot;form&quot; :rules=&quot;rules&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;点位名称&quot; prop=&quot;nodeName&quot;&gt;</span><br><span class="line">      &lt;el-input v-model=&quot;form.nodeName&quot; placeholder=&quot;请输入点位名称&quot; /&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;所在区域&quot; prop=&quot;regionId&quot;&gt;</span><br><span class="line">      &lt;!-- &lt;el-input v-model=&quot;form.regionId&quot; placeholder=&quot;请输入区域ID&quot; /&gt; --&gt;</span><br><span class="line">        &lt;el-select v-model=&quot;form.regionId&quot; placeholder=&quot;请选择区域&quot; clearable&gt;</span><br><span class="line">        &lt;el-option v-for=&quot;item in regionList&quot; :key=&quot;item.id&quot; :label=&quot;item.regionName&quot; :value=&quot;item.id&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">      &lt;/el-select&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;商圈类型&quot; prop=&quot;businessType&quot;&gt;</span><br><span class="line">      &lt;el-select v-model=&quot;form.businessType&quot; placeholder=&quot;请选择商圈类型&quot;&gt;</span><br><span class="line">        &lt;el-option v-for=&quot;dict in business_type&quot; :key=&quot;dict.value&quot; :label=&quot;dict.label&quot;</span><br><span class="line">          :value=&quot;parseInt(dict.value)&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">      &lt;/el-select&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;归属合作商&quot; prop=&quot;partnerId&quot;&gt;</span><br><span class="line">      &lt;!-- &lt;el-input v-model=&quot;form.partnerId&quot; placeholder=&quot;请输入合作商ID&quot; /&gt; --&gt;</span><br><span class="line">        &lt;el-select v-model=&quot;form.partnerId&quot; placeholder=&quot;请选择合作商&quot; clearable&gt;</span><br><span class="line">        &lt;el-option v-for=&quot;item in partnerList&quot; :key=&quot;item.id&quot; :label=&quot;item.partnerName&quot; :value=&quot;item.id&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">      &lt;/el-select&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;详细地址&quot; prop=&quot;address&quot;&gt;</span><br><span class="line">      &lt;el-input type=&quot;textarea&quot; v-model=&quot;form.address&quot; placeholder=&quot;请输入详细地址&quot; /&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">  &lt;/el-form&gt;</span><br><span class="line">  &lt;template #footer&gt;</span><br><span class="line">    &lt;div class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">      &lt;el-button type=&quot;primary&quot; @click=&quot;submitForm&quot;&gt;确 定&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button @click=&quot;cancel&quot;&gt;取 消&lt;/el-button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/template&gt;</span><br><span class="line">&lt;/el-dialog&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup name=&quot;Node&quot;&gt;</span><br><span class="line">    import &#123; listPartner &#125; from &quot;@/api/manage/partner&quot;;</span><br><span class="line">    import &#123; listRegion &#125; from &quot;@/api/manage/region&quot;;</span><br><span class="line">    import &#123; loadAllParams &#125; from &quot;@/api/page&quot;;</span><br><span class="line"></span><br><span class="line">    /* 查询所有的条件对象 */</span><br><span class="line">    /* const loadAllParams = reactive(&#123;</span><br><span class="line">      pageNum: 1,</span><br><span class="line">      pageSize: 10000,</span><br><span class="line">    &#125;); */</span><br><span class="line"></span><br><span class="line">    /* 查询合作商列表  */</span><br><span class="line">    const partnerList = ref([]);</span><br><span class="line">    function getPartnerList() &#123;</span><br><span class="line">        listPartner(loadAllParams).then(response =&gt; &#123;</span><br><span class="line">            partnerList.value = response.rows;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    getPartnerList();</span><br><span class="line">    /* 查询区域列表 */</span><br><span class="line">    const regionList = ref([]);</span><br><span class="line">    function getRegionList() &#123;</span><br><span class="line">        listRegion(loadAllParams).then(response =&gt; &#123;</span><br><span class="line">            regionList.value = response.rows;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    getRegionList();    </span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>在api/page.js中，抽取一个查询所有的条件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> loadAllParams = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">pageNum</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">pageSize</span>: <span class="number">10000</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="点位列表"><a href="#点位列表" class="headerlink" title="点位列表"></a>点位列表</h3><h4 id="需求-5"><a href="#需求-5" class="headerlink" title="需求"></a>需求</h4><p>在区域详情中，需要显示每个点位的设备数</p>
<p><img src="image-20240521164650187.png" alt="image-20240521164650187"></p>
<p>在点位列表查询中，会关联显示区域、商圈等信息</p>
<p><img src="image-20240521164640411.png" alt="image-20240521164640411"></p>
<h4 id="实现思路-2"><a href="#实现思路-2" class="headerlink" title="实现思路"></a>实现思路</h4><p><strong>关联查询</strong>：对于设备数量的统计，我们需要执行关联查询，在mapper 层封装。</p>
<p><strong>关联实体</strong>：对于区域和合作商的数据，我们会采用Mybatis提供的嵌套查询功能。</p>
<p>MyBatis 嵌套查询就是将原来多表查询中的联合查询语句拆成单个表的查询，再使用mybatis的语法嵌套在一 起，通过定义<code>resultMap</code>和<code>sql</code>语句中的<code>association</code>或<code>collection</code>元素来实现嵌套查询。</p>
<p><img src="image-20240609225517037.png" alt="image-20240609225517037">  </p>
<p>导入资料中<code>dkd.sql</code>业务表到开发数据库中</p>
<p><img src="image-20240612174727308.png" alt="image-20240612174727308"> <img src="image-20240612174906586.png" alt="image-20240612174906586"></p>
<h4 id="SQL-2"><a href="#SQL-2" class="headerlink" title="SQL"></a>SQL</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- AI辅助编程模式</span></span><br><span class="line"><span class="comment">-- 你是一个软件开发工程师，现在要根据数据库的sql脚本，查询并显示点位表所有的字段信息,同时显示每个点位的设备数量，sql脚本如下：</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tb_node</span><br><span class="line">(</span><br><span class="line">    id            <span class="type">int</span> auto_increment comment <span class="string">&#x27;主键id&#x27;</span></span><br><span class="line">        <span class="keyword">primary</span> key,</span><br><span class="line">    node_name     <span class="type">varchar</span>(<span class="number">255</span>)                        <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;点位名称&#x27;</span>,</span><br><span class="line">    address       <span class="type">varchar</span>(<span class="number">255</span>)                        <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;详细地址&#x27;</span>,</span><br><span class="line">    business_type <span class="type">int</span>                                 <span class="keyword">null</span> comment <span class="string">&#x27;商圈类型&#x27;</span>,</span><br><span class="line">    region_id     <span class="type">int</span>                                 <span class="keyword">null</span> comment <span class="string">&#x27;区域ID&#x27;</span>,</span><br><span class="line">    partner_id    <span class="type">int</span>                                 <span class="keyword">null</span> comment <span class="string">&#x27;合作商ID&#x27;</span>,</span><br><span class="line">    create_time   <span class="type">timestamp</span> <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">null</span> comment <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">    update_time   <span class="type">timestamp</span> <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">null</span> <span class="keyword">on</span> <span class="keyword">update</span> <span class="built_in">CURRENT_TIMESTAMP</span> comment <span class="string">&#x27;修改时间&#x27;</span>,</span><br><span class="line">    create_by     <span class="type">varchar</span>(<span class="number">64</span>)                         <span class="keyword">null</span> comment <span class="string">&#x27;创建人&#x27;</span>,</span><br><span class="line">    update_by     <span class="type">varchar</span>(<span class="number">64</span>)                         <span class="keyword">null</span> comment <span class="string">&#x27;修改人&#x27;</span>,</span><br><span class="line">    remark        text                                <span class="keyword">null</span> comment <span class="string">&#x27;备注&#x27;</span>,</span><br><span class="line">    <span class="keyword">constraint</span> tb_node_ibfk_1</span><br><span class="line">        <span class="keyword">foreign</span> key (region_id) <span class="keyword">references</span> tb_region (id)</span><br><span class="line">            <span class="keyword">on</span> <span class="keyword">update</span> cascade <span class="keyword">on</span> <span class="keyword">delete</span> cascade,</span><br><span class="line">    <span class="keyword">constraint</span> tb_node_ibfk_2</span><br><span class="line">        <span class="keyword">foreign</span> key (partner_id) <span class="keyword">references</span> tb_partner (id)</span><br><span class="line">            <span class="keyword">on</span> <span class="keyword">update</span> cascade <span class="keyword">on</span> <span class="keyword">delete</span> cascade</span><br><span class="line">)</span><br><span class="line">    comment <span class="string">&#x27;点位表&#x27;</span>;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tb_vending_machine</span><br><span class="line">(</span><br><span class="line">    id                   <span class="type">bigint</span> auto_increment comment <span class="string">&#x27;主键&#x27;</span></span><br><span class="line">        <span class="keyword">primary</span> key,</span><br><span class="line">    inner_code           <span class="type">varchar</span>(<span class="number">15</span>) <span class="keyword">default</span> <span class="string">&#x27;000&#x27;</span>                 <span class="keyword">null</span> comment <span class="string">&#x27;设备编号&#x27;</span>,</span><br><span class="line">    channel_max_capacity <span class="type">int</span>                                       <span class="keyword">null</span> comment <span class="string">&#x27;设备容量&#x27;</span>,</span><br><span class="line">    node_id              <span class="type">int</span>                                       <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;点位Id&#x27;</span>,</span><br><span class="line">    addr                 <span class="type">varchar</span>(<span class="number">100</span>)                              <span class="keyword">null</span> comment <span class="string">&#x27;详细地址&#x27;</span>,</span><br><span class="line">    last_supply_time     datetime    <span class="keyword">default</span> <span class="string">&#x27;2000-01-01 00:00:00&#x27;</span> <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;上次补货时间&#x27;</span>,</span><br><span class="line">    business_type        <span class="type">int</span>                                       <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;商圈类型&#x27;</span>,</span><br><span class="line">    region_id            <span class="type">int</span>                                       <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;区域Id&#x27;</span>,</span><br><span class="line">    partner_id           <span class="type">int</span>                                       <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;合作商Id&#x27;</span>,</span><br><span class="line">    vm_type_id           <span class="type">int</span>         <span class="keyword">default</span> <span class="number">0</span>                     <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;设备型号&#x27;</span>,</span><br><span class="line">    vm_status            <span class="type">int</span>         <span class="keyword">default</span> <span class="number">0</span>                     <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;设备状态，0:未投放;1-运营;3-撤机&#x27;</span>,</span><br><span class="line">    running_status       <span class="type">varchar</span>(<span class="number">100</span>)                              <span class="keyword">null</span> comment <span class="string">&#x27;运行状态&#x27;</span>,</span><br><span class="line">    longitudes           <span class="keyword">double</span>      <span class="keyword">default</span> <span class="number">0</span>                     <span class="keyword">null</span> comment <span class="string">&#x27;经度&#x27;</span>,</span><br><span class="line">    latitude             <span class="keyword">double</span>      <span class="keyword">default</span> <span class="number">0</span>                     <span class="keyword">null</span> comment <span class="string">&#x27;维度&#x27;</span>,</span><br><span class="line">    client_id            <span class="type">varchar</span>(<span class="number">50</span>)                               <span class="keyword">null</span> comment <span class="string">&#x27;客户端连接Id,做emq认证用&#x27;</span>,</span><br><span class="line">    policy_id            <span class="type">bigint</span>                                    <span class="keyword">null</span> comment <span class="string">&#x27;策略id&#x27;</span>,</span><br><span class="line">    create_time          <span class="type">timestamp</span>   <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span>     <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">    update_time          <span class="type">timestamp</span>   <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span>     <span class="keyword">null</span> comment <span class="string">&#x27;修改时间&#x27;</span>,</span><br><span class="line">    <span class="keyword">constraint</span> vendingmachine_VmId_uindex</span><br><span class="line">        <span class="keyword">unique</span> (inner_code),</span><br><span class="line">    <span class="keyword">constraint</span> tb_vending_machine_ibfk_1</span><br><span class="line">        <span class="keyword">foreign</span> key (vm_type_id) <span class="keyword">references</span> tb_vm_type (id),</span><br><span class="line">    <span class="keyword">constraint</span> tb_vending_machine_ibfk_2</span><br><span class="line">        <span class="keyword">foreign</span> key (node_id) <span class="keyword">references</span> tb_node (id),</span><br><span class="line">    <span class="keyword">constraint</span> tb_vending_machine_ibfk_3</span><br><span class="line">        <span class="keyword">foreign</span> key (policy_id) <span class="keyword">references</span> tb_policy (policy_id)</span><br><span class="line">)</span><br><span class="line">    comment <span class="string">&#x27;设备表&#x27;</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询并显示点位表所有的字段信息,同时显示每个点位的设备数量</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    n.id,</span><br><span class="line">    n.node_name,</span><br><span class="line">    n.address,</span><br><span class="line">    n.business_type,</span><br><span class="line">    n.region_id,</span><br><span class="line">    n.partner_id,</span><br><span class="line">    n.create_time,</span><br><span class="line">    n.update_time,</span><br><span class="line">    n.create_by,</span><br><span class="line">    n.update_by,</span><br><span class="line">    n.remark,</span><br><span class="line">    <span class="built_in">COUNT</span>(v.id) <span class="keyword">AS</span> vm_count</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    tb_node n</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span></span><br><span class="line">    tb_vending_machine v <span class="keyword">ON</span> n.id <span class="operator">=</span> v.node_id</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line">    n.id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 根据区域id查询区域信息</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_region <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="comment">-- 根据合作商id查询合作商信息</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_partner <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<h4 id="NodeVo"><a href="#NodeVo" class="headerlink" title="NodeVo"></a>NodeVo</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NodeVo</span> <span class="keyword">extends</span> <span class="title class_">Node</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设备数量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> vmCount;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 区域</span></span><br><span class="line">    <span class="keyword">private</span> Region region;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 合作商</span></span><br><span class="line">    <span class="keyword">private</span> Partner partner;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="NodeMapper"><a href="#NodeMapper" class="headerlink" title="NodeMapper"></a>NodeMapper</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询点位管理列表</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> node</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> NodeVo集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> List&lt;NodeVo&gt; <span class="title function_">selectNodeVoList</span><span class="params">(Node node)</span>;</span><br></pre></td></tr></table></figure>
<h4 id="NodeMapper-xml"><a href="#NodeMapper-xml" class="headerlink" title="NodeMapper.xml"></a>NodeMapper.xml</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;NodeVo&quot;</span> <span class="attr">id</span>=<span class="string">&quot;NodeVoResult&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>    <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;nodeName&quot;</span>    <span class="attr">column</span>=<span class="string">&quot;node_name&quot;</span>    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;address&quot;</span>    <span class="attr">column</span>=<span class="string">&quot;address&quot;</span>    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;businessType&quot;</span>    <span class="attr">column</span>=<span class="string">&quot;business_type&quot;</span>    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;regionId&quot;</span>    <span class="attr">column</span>=<span class="string">&quot;region_id&quot;</span>    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;partnerId&quot;</span>    <span class="attr">column</span>=<span class="string">&quot;partner_id&quot;</span>    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;createTime&quot;</span>    <span class="attr">column</span>=<span class="string">&quot;create_time&quot;</span>    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;updateTime&quot;</span>    <span class="attr">column</span>=<span class="string">&quot;update_time&quot;</span>    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;createBy&quot;</span>    <span class="attr">column</span>=<span class="string">&quot;create_by&quot;</span>    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;updateBy&quot;</span>    <span class="attr">column</span>=<span class="string">&quot;update_by&quot;</span>    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;remark&quot;</span>    <span class="attr">column</span>=<span class="string">&quot;remark&quot;</span>    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;vmCount&quot;</span>    <span class="attr">column</span>=<span class="string">&quot;vm_count&quot;</span>    /&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;region&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;Region&quot;</span> <span class="attr">column</span>=<span class="string">&quot;region_id&quot;</span> <span class="attr">select</span>=<span class="string">&quot;com.dkd.manage.mapper.RegionMapper.selectRegionById&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;partner&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;Partner&quot;</span> <span class="attr">column</span>=<span class="string">&quot;partner_id&quot;</span> <span class="attr">select</span>=<span class="string">&quot;com.dkd.manage.mapper.PartnerMapper.selectPartnerById&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectNodeVoList&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;NodeVoResult&quot;</span>&gt;</span></span><br><span class="line">    SELECT</span><br><span class="line">    n.id,</span><br><span class="line">    n.node_name,</span><br><span class="line">    n.address,</span><br><span class="line">    n.business_type,</span><br><span class="line">    n.region_id,</span><br><span class="line">    n.partner_id,</span><br><span class="line">    n.create_time,</span><br><span class="line">    n.update_time,</span><br><span class="line">    n.create_by,</span><br><span class="line">    n.update_by,</span><br><span class="line">    n.remark,</span><br><span class="line">    COUNT(v.id) AS vm_count</span><br><span class="line">    FROM</span><br><span class="line">    tb_node n</span><br><span class="line">    LEFT JOIN</span><br><span class="line">    tb_vending_machine v ON n.id = v.node_id</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;nodeName != null  and nodeName != &#x27;&#x27;&quot;</span>&gt;</span> and n.node_name like concat(&#x27;%&#x27;, #&#123;nodeName&#125;, &#x27;%&#x27;)<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;regionId != null &quot;</span>&gt;</span> and n.region_id = #&#123;regionId&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;partnerId != null &quot;</span>&gt;</span> and n.partner_id = #&#123;partnerId&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">    GROUP BY</span><br><span class="line">    n.id</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="NodeService"><a href="#NodeService" class="headerlink" title="NodeService"></a>NodeService</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询点位管理列表</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> node</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> NodeVo集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> List&lt;NodeVo&gt; <span class="title function_">selectNodeVoList</span><span class="params">(Node node)</span>;</span><br></pre></td></tr></table></figure>
<h4 id="NodeServiceImpl"><a href="#NodeServiceImpl" class="headerlink" title="NodeServiceImpl"></a>NodeServiceImpl</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询点位管理列表</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> node</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> NodeVo集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;NodeVo&gt; <span class="title function_">selectNodeVoList</span><span class="params">(Node node)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> nodeMapper.selectNodeVoList(node);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="NodeController"><a href="#NodeController" class="headerlink" title="NodeController"></a>NodeController</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询点位管理列表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PreAuthorize(&quot;@ss.hasPermi(&#x27;manage:node:list&#x27;)&quot;)</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/list&quot;)</span></span><br><span class="line"><span class="keyword">public</span> TableDataInfo <span class="title function_">list</span><span class="params">(Node node)</span></span><br><span class="line">&#123;</span><br><span class="line">    startPage();</span><br><span class="line">    List&lt;NodeVo&gt; voList = nodeService.selectNodeVoList(node);</span><br><span class="line">    <span class="keyword">return</span> getDataTable(voList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="node-index-vue"><a href="#node-index-vue" class="headerlink" title="node/index.vue"></a>node/index.vue</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 点位列表 --&gt;</span><br><span class="line">&lt;el-table v-loading=&quot;loading&quot; :data=&quot;nodeList&quot; @selection-change=&quot;handleSelectionChange&quot;&gt;</span><br><span class="line">  &lt;el-table-column type=&quot;selection&quot; width=&quot;55&quot; align=&quot;center&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;序号&quot; type=&quot;index&quot; width=&quot;50&quot; align=&quot;center&quot; prop=&quot;id&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;点位名称&quot; align=&quot;center&quot; prop=&quot;nodeName&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;所在区域&quot; align=&quot;center&quot; prop=&quot;region.regionName&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;商圈类型&quot; align=&quot;center&quot; prop=&quot;businessType&quot;&gt;</span><br><span class="line">    &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">      &lt;dict-tag :options=&quot;business_type&quot; :value=&quot;scope.row.businessType&quot; /&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/el-table-column&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;合作商&quot; align=&quot;center&quot; prop=&quot;partner.partnerName&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;详细地址&quot; align=&quot;center&quot; prop=&quot;address&quot; show-overflow-tooltip=&quot;true&quot;/&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;操作&quot; align=&quot;center&quot; class-name=&quot;small-padding fixed-width&quot;&gt;</span><br><span class="line">    &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">      &lt;el-button link type=&quot;primary&quot; icon=&quot;Edit&quot; @click=&quot;handleUpdate(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:node:edit&#x27;]&quot;&gt;修改&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button link type=&quot;primary&quot; icon=&quot;Delete&quot; @click=&quot;handleDelete(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:node:remove&#x27;]&quot;&gt;删除&lt;/el-button&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/el-table-column&gt;</span><br><span class="line">&lt;/el-table&gt;</span><br></pre></td></tr></table></figure>
<h2 id="区域查看详情"><a href="#区域查看详情" class="headerlink" title="区域查看详情"></a>区域查看详情</h2><p>在region/index.vue视图组件中修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-button link type=&quot;primary&quot; @click=&quot;getRegionInfo(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:node:list&#x27;]&quot;&gt;查看详情&lt;/el-button&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 查看详情对话框 --&gt;</span><br><span class="line">&lt;el-dialog title=&quot;区域详情&quot; v-model=&quot;regionInfoOpen&quot; width=&quot;500px&quot; append-to-body&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;区域名称&quot; prop=&quot;regionName&quot;&gt;</span><br><span class="line">        &lt;el-input v-model=&quot;form.regionName&quot; disabled /&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;label&gt;包含点位：&lt;/label&gt;</span><br><span class="line">    &lt;el-table :data=&quot;nodeList&quot;&gt;</span><br><span class="line">        &lt;el-table-column label=&quot;序号&quot; type=&quot;index&quot; width=&quot;50&quot; align=&quot;center&quot; /&gt;</span><br><span class="line">        &lt;el-table-column label=&quot;点位名称&quot; align=&quot;center&quot; prop=&quot;nodeName&quot; /&gt;</span><br><span class="line">        &lt;el-table-column label=&quot;设备数量&quot; align=&quot;center&quot; prop=&quot;vmCount&quot; /&gt;</span><br><span class="line">    &lt;/el-table&gt;</span><br><span class="line">&lt;/el-dialog&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    import &#123; listNode &#125; from &quot;@/api/manage/node&quot;;</span><br><span class="line">    import &#123; loadAllParams &#125; from &quot;@/api/page&quot;;</span><br><span class="line">    </span><br><span class="line">    /* 查看详情按钮操作 */</span><br><span class="line">    const nodeList = ref([]);</span><br><span class="line">    const regionInfoOpen = ref(false);</span><br><span class="line">    function getRegionInfo(row) &#123;</span><br><span class="line">        // 查询区域信息</span><br><span class="line">        reset();</span><br><span class="line">        const _id = row.id</span><br><span class="line">        getRegion(_id).then(response =&gt; &#123;</span><br><span class="line">            form.value = response.data;</span><br><span class="line">        &#125;);</span><br><span class="line">        // 查询点位列表</span><br><span class="line">        loadAllParams.regionId = row.id;</span><br><span class="line">        listNode(loadAllParams).then(response =&gt; &#123;</span><br><span class="line">            nodeList.value = response.rows;</span><br><span class="line">        &#125;);</span><br><span class="line">        regionInfoOpen.value = true;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h2 id="数据完整性"><a href="#数据完整性" class="headerlink" title="数据完整性"></a>数据完整性</h2><p>现在我们要思考一个问题，当我们删除区域或合作商数据时，与之关联的点位数据该如何处理？</p>
<p><img src="image-20240614102316989.png" alt="image-20240614102316989"></p>
<p>在默认情况下，由于我们在创建点位表时通过AI设置了外键约束，并配置了级联删除操作，所以删除区域或合作商会导致其关联的点位数据一并被删除。从技术角度来看，这是符合数据库的外键约束规则的。</p>
<p>但是，从业务角度来看，这种做法可能不太合适。想象一下，如果一个区域下有多个点位，一次误操作就可能导致所有的点位数据及其关联的设备信息被一并删除，这显然是我们不愿意看到的。</p>
<p>因此，我们需要对级联操作进行修改，将其改为限制删除。这样，当尝试删除一个区域或合作商时，如果它下面还有关联的点位数据，数据库将不会允许删除操作，并会给出错误提示。</p>
<p><img src="image-20240614101411660.png" alt="image-20240614101411660"></p>
<p><strong>CASCADE（级联操作）:</strong>当父表中的某行记录被删除或更新时，与其关联的所有子表中的匹配行也会自动被删除或更新。这种方式适用于希望保持数据一致性的场景，即父记录不存在时，相关的子记录也应该被移除。</p>
<p><strong>SET NULL（设为空）:</strong>若父表中的记录被删除或更新，子表中对应的外键字段会被设置为NULL。选择此选项的前提是子表的外键列允许为NULL值。这适用于那些子记录不再需要明确关联到任何父记录的情况。</p>
<p><strong>RESTRICT（限制）:</strong>在尝试删除或更新父表中的记录之前，数据库首先检查是否有相关联的子记录存在。如果有，则拒绝执行删除或更新操作，以防止意外丢失数据或破坏数据关系的完整性。这是一种保守策略，确保数据间的引用完整性。</p>
<p><strong>NO ACTION（无操作）:</strong>在标准SQL中，NO ACTION是一个关键字，它要求数据库在父表记录被删除或更新前，检查是否会影响子表中的相关记录。在MySQL中，NO ACTION的行为与RESTRICT相同，即如果子表中有匹配的行，则禁止执行父表的删除或更新操作。这意味着如果存在依赖关系，操作将被阻止，从而保护数据的参照完整性。</p>
<p>修改完毕后，如果你尝试进行删除操作，会发现数据库的完整性约束生效了，它会阻止删除操作并给出错误提示。但是，这个错误提示信息可能对于用户来说不够友好，可能会让用户感到困惑。</p>
<p><img src="image-20240526215928362.png" alt="image-20240526215928362"></p>
<p><code>SQLIntegrityConstraintViolationException</code>是Java中的一个异常类，这个类通常用于表示SQL数据库操作中的完整性约束违反异常</p>
<p>例如：外键约束、唯一约束等。当数据库操作违反了这些约束时，就会抛出这个异常。</p>
<p>这个错误是由于外键约束导致的。它表明在删除或更新父表的行时，存在外键约束，子表中的相关行会受到影响。</p>
<p>是因为在删除tb_region表中的行时，tb_node表中的region_id外键约束会阻止操作。</p>
<p>如果你在使用Spring框架进行数据库操作，可能会先遇到DataIntegrityViolationException，它是对SQLIntegrityConstraintViolationException的一个更高层次的抽象，旨在提供一种更加面向应用的错误表示。</p>
<p>而SQLIntegrityConstraintViolationException是更底层的异常，直接来源于数据库驱动，包含更多底层数据库相关的细节。</p>
<p>在实际开发中，推荐捕获并处理DataIntegrityViolationException，因为它更符合Spring应用的异常处理模式，同时也可以通过其内部的cause（原因）属性来获取具体的SQLIntegrityConstraintViolationException，进而获取详细的错误信息。</p>
<p>为了提升用户体验，我们可以使用Spring Boot框架的全局异常处理器来捕获这些错误信息，并返回更友好的提示信息给用户。这样，当用户遇到这种情况时，他们将收到一个清晰、易懂的提示，告知他们操作无法完成的原因。</p>
<blockquote>
<p>修改全局异常处理器，添加以下内容</p>
</blockquote>
<p><img src="image-20240526220314397.png" alt="image-20240526220314397"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 数据完整性异常</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@ExceptionHandler(DataIntegrityViolationException.class)</span></span><br><span class="line"><span class="keyword">public</span> AjaxResult <span class="title function_">handelDataIntegrityViolationException</span><span class="params">(DataIntegrityViolationException e)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (e.getMessage().contains(<span class="string">&quot;foreign&quot;</span>)) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> AjaxResult.error(<span class="string">&quot;无法删除，有其他数据引用&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> AjaxResult.error(<span class="string">&quot;您的操作违反了数据库中的完整性约束&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="人员管理"><a href="#人员管理" class="headerlink" title="人员管理"></a>人员管理</h1><h2 id="需求说明-1"><a href="#需求说明-1" class="headerlink" title="需求说明"></a>需求说明</h2><p>人员管理业务流程如下：</p>
<ol>
<li><strong>登录系统：</strong> 首先，后台管理人员需要登录到帝可得后台管理系统中。</li>
<li><strong>新增工作人员：</strong> 登录系统后，管理人员可以新增工作人员，包括姓名、联系方式等信息。</li>
<li><strong>关联角色：</strong> 确定此员工是运维人员还是运营人员，这将影响他们的职责和权限。</li>
<li><strong>关联区域：</strong> 确定员工负责的区域范围，确保工作人员能够高效地完成区域内的设备安装、维修、商品补货等工作。</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">    A[登录系统] </span><br><span class="line">    A --&gt; B[新增员工]</span><br><span class="line">    B --&gt; C[关联角色]</span><br><span class="line">    B --&gt; D[关联区域]</span><br></pre></td></tr></table></figure>
<p>对于人员和其他管理数据，下面是示意图：</p>
<ul>
<li>关系字段：role_id、region_id</li>
<li>数据字典：status（1启用、0停用）</li>
<li>冗余字段：region_name、role_code、role_name</li>
</ul>
<p><img src="image-20240615092652583.png" alt="image-20240615092652583">  </p>
<h2 id="生成基础代码-1"><a href="#生成基础代码-1" class="headerlink" title="生成基础代码"></a>生成基础代码</h2><h3 id="需求-6"><a href="#需求-6" class="headerlink" title="需求"></a>需求</h3><p>使用若依代码生成器，生成人员列表前后端基础代码，并导入到项目中：</p>
<p><img src="image-20240526190447167.png" alt="image-20240526190447167"></p>
<h3 id="步骤-1"><a href="#步骤-1" class="headerlink" title="步骤"></a>步骤</h3><h4 id="①创建目录菜单-1"><a href="#①创建目录菜单-1" class="headerlink" title="①创建目录菜单"></a>①创建目录菜单</h4><p>创建人员管理目录菜单</p>
<p><img src="image-20240526164727034.png" alt="image-20240526164727034"></p>
<h4 id="②添加数据字典-1"><a href="#②添加数据字典-1" class="headerlink" title="②添加数据字典"></a>②添加数据字典</h4><p>先创建<code>员工状态</code>的字典类型</p>
<p><img src="image-20240526184648412.png" alt="image-20240526184648412"></p>
<p><img src="image-20240526184722696.png" alt="image-20240526184722696"></p>
<p>再创建<code>员工状态</code>的字典数据</p>
<p><img src="image-20240526184842567.png" alt="image-20240526184842567"></p>
<p><img src="image-20240526184905928.png" alt="image-20240526184905928"></p>
<h4 id="③配置代码生成信息-1"><a href="#③配置代码生成信息-1" class="headerlink" title="③配置代码生成信息"></a>③配置代码生成信息</h4><p>导入二张表</p>
<p><img src="image-20240526165101957.png" alt="image-20240526165101957"></p>
<p>配置员工表（参考原型）</p>
<p><img src="image-20240526170042249.png" alt="image-20240526170042249"></p>
<p><img src="image-20240614222258513.png" alt="image-20240614222258513"></p>
<p><img src="image-20240614222335106.png" alt="image-20240614222335106">  </p>
<p>配置角色表（无原型）</p>
<p><img src="image-20240526170647520.png" alt="image-20240526170647520"></p>
<p><img src="image-20240526170748470.png" alt="image-20240526170748470"></p>
<p><img src="image-20240526170851074.png" alt="image-20240526170851074"></p>
<h4 id="④下载代码并导入项目-1"><a href="#④下载代码并导入项目-1" class="headerlink" title="④下载代码并导入项目"></a>④下载代码并导入项目</h4><p>选中二张表生成下载</p>
<p><img src="image-20240526172403396.png" alt="image-20240526172403396"></p>
<p>解压<code>ruoyi.zip</code>得到前后端代码和动态菜单sql</p>
<blockquote>
<p>注意：角色动态菜单sql和视图组件不需要导入</p>
</blockquote>
<p> <img src="image-20240615092731978.png" alt="image-20240615092731978">  </p>
<p>代码导入</p>
<p><img src="image-20240526183406530.png" alt="image-20240526183406530"> <img src="image-20240526190310190.png" alt="image-20240526190310190"></p>
<h2 id="人员列表改造"><a href="#人员列表改造" class="headerlink" title="人员列表改造"></a>人员列表改造</h2><h3 id="基础页面-3"><a href="#基础页面-3" class="headerlink" title="基础页面"></a>基础页面</h3><h4 id="需求-7"><a href="#需求-7" class="headerlink" title="需求"></a>需求</h4><p>参考页面原型，完成基础布局展示改造</p>
<p><img src="image-20240526190608481.png" alt="image-20240526190608481">  </p>
<h4 id="代码实现-3"><a href="#代码实现-3" class="headerlink" title="代码实现"></a>代码实现</h4><p>在emp/index.vue视图组件中修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 搜索区域 --&gt;</span><br><span class="line">&lt;el-form :model=&quot;queryParams&quot; ref=&quot;queryRef&quot; :inline=&quot;true&quot; v-show=&quot;showSearch&quot; label-width=&quot;68px&quot;&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;人员名称&quot; prop=&quot;userName&quot;&gt;</span><br><span class="line">        &lt;el-input v-model=&quot;queryParams.userName&quot; placeholder=&quot;请输入人员名称&quot; clearable @keyup.enter=&quot;handleQuery&quot; /&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item&gt;</span><br><span class="line">        &lt;el-button type=&quot;primary&quot; icon=&quot;Search&quot; @click=&quot;handleQuery&quot;&gt;搜索&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button icon=&quot;Refresh&quot; @click=&quot;resetQuery&quot;&gt;重置&lt;/el-button&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">&lt;/el-form&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 人员列表 --&gt;</span><br><span class="line">&lt;el-table v-loading=&quot;loading&quot; :data=&quot;empList&quot; @selection-change=&quot;handleSelectionChange&quot;&gt;</span><br><span class="line">    &lt;el-table-column type=&quot;selection&quot; width=&quot;55&quot; align=&quot;center&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;序号&quot; type=&quot;index&quot; width=&quot;80&quot; align=&quot;center&quot; prop=&quot;id&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;人员名称&quot; align=&quot;center&quot; prop=&quot;userName&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;归属区域&quot; align=&quot;center&quot; prop=&quot;regionName&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;角色&quot; align=&quot;center&quot; prop=&quot;roleName&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;联系电话&quot; align=&quot;center&quot; prop=&quot;mobile&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;操作&quot; align=&quot;center&quot; class-name=&quot;small-padding fixed-width&quot;&gt;</span><br><span class="line">        &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">   &lt;el-button link type=&quot;primary&quot;  @click=&quot;handleUpdate(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:emp:edit&#x27;]&quot;&gt;修改&lt;/el-button&gt;</span><br><span class="line">   &lt;el-button link type=&quot;primary&quot;  @click=&quot;handleDelete(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:emp:remove&#x27;]&quot;&gt;删除&lt;/el-button&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">    &lt;/el-table-column&gt;</span><br><span class="line">&lt;/el-table&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 添加或修改人员列表对话框 --&gt;</span><br><span class="line">&lt;el-dialog :title=&quot;title&quot; v-model=&quot;open&quot; width=&quot;500px&quot; append-to-body&gt;</span><br><span class="line">  &lt;el-form ref=&quot;empRef&quot; :model=&quot;form&quot; :rules=&quot;rules&quot; label-width=&quot;80px&quot;&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;员工名称&quot; prop=&quot;userName&quot;&gt;</span><br><span class="line">      &lt;el-input v-model=&quot;form.userName&quot; placeholder=&quot;请输入员工名称&quot; /&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;角色&quot; prop=&quot;roleId&quot;&gt;</span><br><span class="line">      &lt;!-- &lt;el-input v-model=&quot;form.roleId&quot; placeholder=&quot;请输入角色id&quot; /&gt; --&gt;</span><br><span class="line">      &lt;el-select v-model=&quot;form.roleId&quot; placeholder=&quot;请选择角色&quot;&gt;</span><br><span class="line">        &lt;el-option v-for=&quot;item in roleList&quot; :key=&quot;item.roleId&quot; :label=&quot;item.roleName&quot; :value=&quot;item.roleId&quot; /&gt;</span><br><span class="line">      &lt;/el-select&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;联系电话&quot; prop=&quot;mobile&quot;&gt;</span><br><span class="line">      &lt;el-input v-model=&quot;form.mobile&quot; placeholder=&quot;请输入联系电话&quot; /&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;创建时间&quot; prop=&quot;createTime&quot; v-if=&quot;form.id!=null&quot;&gt;</span><br><span class="line">      &#123;&#123;form.createTime &#125;&#125;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;负责区域&quot; prop=&quot;regionId&quot;&gt;</span><br><span class="line">      &lt;!-- &lt;el-input v-model=&quot;form.regionId&quot; placeholder=&quot;请输入所属区域Id&quot; /&gt; --&gt;</span><br><span class="line">      &lt;el-select v-model=&quot;form.regionId&quot; placeholder=&quot;请选择所属区域&quot;&gt;</span><br><span class="line">        &lt;el-option v-for=&quot;item in regionList&quot; :key=&quot;item.id&quot; :label=&quot;item.regionName&quot; :value=&quot;item.id&quot; /&gt;</span><br><span class="line">      &lt;/el-select&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;员工头像&quot; prop=&quot;image&quot;&gt;</span><br><span class="line">      &lt;image-upload v-model=&quot;form.image&quot; /&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;是否启用&quot; prop=&quot;status&quot;&gt;</span><br><span class="line">      &lt;el-radio-group v-model=&quot;form.status&quot;&gt;</span><br><span class="line">        &lt;el-radio v-for=&quot;dict in emp_status&quot; :key=&quot;dict.value&quot;</span><br><span class="line">          :label=&quot;parseInt(dict.value)&quot;&gt;&#123;&#123; dict.label &#125;&#125;&lt;/el-radio&gt;</span><br><span class="line">      &lt;/el-radio-group&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">  &lt;/el-form&gt;</span><br><span class="line">  &lt;template #footer&gt;</span><br><span class="line">    &lt;div class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">      &lt;el-button type=&quot;primary&quot; @click=&quot;submitForm&quot;&gt;确 定&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button @click=&quot;cancel&quot;&gt;取 消&lt;/el-button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/template&gt;</span><br><span class="line">&lt;/el-dialog&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    import &#123; listRegion &#125; from &quot;@/api/manage/region&quot;;</span><br><span class="line">    import &#123; listRole &#125; from &quot;@/api/manage/role&quot;;</span><br><span class="line">    import &#123; loadAllParams &#125; from &quot;@/api/page&quot;;</span><br><span class="line"></span><br><span class="line">    // 查询角色列表</span><br><span class="line">    const roleList = ref([]);</span><br><span class="line">    function getRoleList() &#123;</span><br><span class="line">        listRole(loadAllParams).then(response =&gt; &#123;</span><br><span class="line">            roleList.value = response.rows;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    // 查询区域列表</span><br><span class="line">    const regionList = ref([]);</span><br><span class="line">    function getRegionList() &#123;</span><br><span class="line">        listRegion(loadAllParams).then(response =&gt; &#123;</span><br><span class="line">            regionList.value = response.rows;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    getRegionList();</span><br><span class="line">    getRoleList();</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>在EmpServiceImpl中新增和修改时，补充区域名称和角色信息</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> RegionMapper regionMapper;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> RoleMapper roleMapper;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 新增人员列表</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> emp 人员列表</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">insertEmp</span><span class="params">(Emp emp)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 补充区域名称</span></span><br><span class="line">    emp.setRegionName(regionMapper.selectRegionById(emp.getRegionId()).getRegionName());</span><br><span class="line">    <span class="comment">// 补充角色信息</span></span><br><span class="line">    <span class="type">Role</span> <span class="variable">role</span> <span class="operator">=</span> roleMapper.selectRoleByRoleId(emp.getRoleId());</span><br><span class="line">    emp.setRoleName(role.getRoleName());</span><br><span class="line">    emp.setRoleCode(role.getRoleCode());</span><br><span class="line">    emp.setCreateTime(DateUtils.getNowDate());</span><br><span class="line">    <span class="keyword">return</span> empMapper.insertEmp(emp);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 修改人员列表</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> emp 人员列表</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">updateEmp</span><span class="params">(Emp emp)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 补充区域名称</span></span><br><span class="line">    emp.setRegionName(regionMapper.selectRegionById(emp.getRegionId()).getRegionName());</span><br><span class="line">    <span class="comment">// 补充角色信息</span></span><br><span class="line">    <span class="type">Role</span> <span class="variable">role</span> <span class="operator">=</span> roleMapper.selectRoleByRoleId(emp.getRoleId());</span><br><span class="line">    emp.setRoleName(role.getRoleName());</span><br><span class="line">    emp.setRoleCode(role.getRoleCode());</span><br><span class="line">    emp.setUpdateTime(DateUtils.getNowDate());</span><br><span class="line">    <span class="keyword">return</span> empMapper.updateEmp(emp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="同步存储"><a href="#同步存储" class="headerlink" title="同步存储"></a>同步存储</h3><h4 id="实现思路-3"><a href="#实现思路-3" class="headerlink" title="实现思路"></a>实现思路</h4><p>实现此功能方案：</p>
<p><strong>同步存储：</strong>在员工表中有区域名称的冗余字段，在更新区域表的同时，同步更新员工表中区域名称。</p>
<ul>
<li>优点：由于是单表查询操作，查询列表效率最高。</li>
<li>缺点：需要在区域修改时修改员工表中的数据，有额外的开销，数据也可能不一致。</li>
</ul>
<p><img src="image-20240617195506512.png" alt="image-20240617195506512"></p>
<h4 id="sql"><a href="#sql" class="headerlink" title="sql"></a>sql</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 根据区域id修改区域名称</span></span><br><span class="line"><span class="keyword">update</span> tb_emp <span class="keyword">set</span> region_name<span class="operator">=</span><span class="string">&#x27;北京市奥体中心&#x27;</span> <span class="keyword">where</span> region_id<span class="operator">=</span><span class="number">5</span></span><br></pre></td></tr></table></figure>
<h4 id="EmpMapper"><a href="#EmpMapper" class="headerlink" title="EmpMapper"></a>EmpMapper</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据区域id修改区域名称</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> regionName</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> regionId</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Update(&quot;update tb_emp set region_name=#&#123;regionName&#125; where region_id=#&#123;regionId&#125;&quot;)</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">updateByRegionId</span><span class="params">(<span class="meta">@Param(&quot;regionName&quot;)</span> String regionName, <span class="meta">@Param(&quot;regionId&quot;)</span> Long regionId)</span>;</span><br></pre></td></tr></table></figure>
<h4 id="RegionServiceImpl-1"><a href="#RegionServiceImpl-1" class="headerlink" title="RegionServiceImpl"></a>RegionServiceImpl</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> EmpMapper empMapper;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 修改区域管理</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> region 区域管理</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">updateRegion</span><span class="params">(Region region)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 先更新区域信息</span></span><br><span class="line">    region.setUpdateTime(DateUtils.getNowDate());</span><br><span class="line">    <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> regionMapper.updateRegion(region);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 同步更新员工表区域名称</span></span><br><span class="line">    empMapper.updateByRegionId(region.getRegionName(),region.getId());</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="文件存储"><a href="#文件存储" class="headerlink" title="文件存储"></a>文件存储</h2><h3 id="本地存储"><a href="#本地存储" class="headerlink" title="本地存储"></a>本地存储</h3><p>问题分析说明：<br> 在若依框架目前的实现中，是把图片存储到了服务器本地的目录，通过服务进行访问，这样做存储的是比较省事，但是缺点也有很多：</p>
<ul>
<li>硬件与网络要求：服务器通常需要高性能的硬件和稳定的网络环境，以保证文件传输的效率和稳定性。这可能会增加硬件和网络资源的成本和维护难度。</li>
<li>管理难度：服务器目录需要管理员进行配置和管理，包括权限设置、备份策略等。如果管理不善或配置不当，可能会引发一些安全问题和性能问题。</li>
<li>性能瓶颈：如果服务器处理能力不足或网络带宽不够，可能会导致性能瓶颈，影响文件上传、下载和访问的速度。</li>
<li>单点故障风险：服务器故障可能导致所有存储在其上的文件无法访问，尽管可以通过备份和冗余措施来降低这种风险，但单点故障的风险仍然存在。</li>
</ul>
<p>为了解决上述问题呢，通常有两种解决方案：</p>
<ul>
<li>自己搭建存储服务器，如：fastDFS 、MinIO</li>
<li>使用现成的云服务，如：阿里云，腾讯云，华为云</li>
</ul>
<h3 id="阿里云OSS"><a href="#阿里云OSS" class="headerlink" title="阿里云OSS"></a>阿里云OSS</h3><h4 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h4><p>阿里云对象存储OSS（Object Storage Service），是一款海量、安全、低成本、高可靠的云存储服务。使用OSS，您可以通过网络随时存储和调用包括文本、图片、音频和视频等在内的各种文件。</p>
<p><img src="image-20231203203509617.png" alt="image-20231203203509617">  </p>
<p>在我们使用了阿里云OSS对象存储服务之后，我们的项目当中如果涉及到文件上传这样的业务，在前端进行文件上传并请求到服务端时，在服务器本地磁盘当中就不需要再来存储文件了。我们直接将接收到的文件上传到oss，由 oss帮我们存储和管理，同时阿里云的oss存储服务还保障了我们所存储内容的安全可靠。</p>
<p><img src="image-20231203203535648.png" alt="image-20231203203535648"></p>
<p>第三方服务使用的通用思路，我们做一个简单介绍之后，接下来我们就来介绍一下我们当前要使用的阿里云oss对象存储服务具体的使用步骤。</p>
<p><img src="image-20231203203634852.png" alt="image-20231203203634852"></p>
<blockquote>
<p>Bucket：存储空间是用户用于存储对象（Object，就是文件）的容器，所有的对象都必须隶属于某个存储空间。</p>
<p>SDK：Software Development Kit 的缩写，软件开发工具包，包括辅助软件开发的依赖（jar包）、代码示例等，都可以叫做SDK。</p>
<p>简单说，sdk中包含了我们使用第三方云服务时所需要的依赖，以及一些示例代码。我们可以参照sdk所提供的示例代码就可以完成入门程序。</p>
</blockquote>
<h4 id="账号准备"><a href="#账号准备" class="headerlink" title="账号准备"></a>账号准备</h4><p>下面我们根据之前介绍的使用步骤，完成准备工作：</p>
<ol>
<li><p>注册阿里云账户（<strong>注册完成后需要实名认证</strong>）</p>
<p><a target="_blank" rel="noopener" href="https://account.aliyun.com/login/login.htm?oauth_callback=https%3A%2F%2Fwww.aliyun.com%2F">https://account.aliyun.com/login/login.htm?oauth_callback=https%3A%2F%2Fwww.aliyun.com%2F</a></p>
<p><img src="image-20231203204940906.png" alt="image-20231203204940906"></p>
</li>
<li><p>注册完账号之后，就可以登录阿里云</p>
</li>
</ol>
<p><img src="image-20240618104400511.png" alt="image-20240618104400511"></p>
<h4 id="开通OSS云服务"><a href="#开通OSS云服务" class="headerlink" title="开通OSS云服务"></a>开通OSS云服务</h4><p>1). 通过控制台找到对象存储OSS服务</p>
<p><img src="image-20231203205356059.png" alt="image-20231203205356059" style="zoom:67%;" /></p>
<p><img src="image-20231203203727265.png" alt="image-20231203203727265" style="zoom:67%;" /></p>
<p>​ 如果是第一次访问，还需要开通对象存储服务OSS</p>
<p><img src="image-20231203203749688.png" alt="image-20231203203749688" style="zoom:67%;" />  </p>
<p>​</p>
<p>2). 开通OSS服务之后，就可以进入到阿里云对象存储的控制台</p>
<p><img src="image-20231203203957217.png" alt="image-20231203203957217" style="zoom:60%;" /></p>
<p>3). 点击左侧的 “Bucket列表”，创建一个Bucket</p>
<p><img src="image-20231203204031109.png" alt="image-20231203204031109" style="zoom: 67%;" /></p>
<p><img src="image-20231203204157199.png" alt="image-20231203204157199" style="zoom: 82%;" /></p>
<h4 id="配置AK-amp-SK"><a href="#配置AK-amp-SK" class="headerlink" title="配置AK &amp; SK"></a>配置AK &amp; SK</h4><p>1). 创建AccessKey</p>
<p>点击 “AccessKey管理”，进入到管理页面。</p>
<p><img src="image-20231203205500858-171869715719416.png" alt="image-20231203205500858" style="zoom:67%;" /></p>
<p>点击 “AccessKey”。</p>
<p><img src="image-20231203205600647-171869715719517.png" alt="image-20231203205600647"></p>
<p><img src="image-20231203205742130-171869715719518.png" alt="image-20231203205742130" style="zoom:67%;" /></p>
<p>2).  配置AK &amp; SK</p>
<p>以<strong>管理员身份</strong>打开CMD命令行，执行如下命令，配置系统的环境变量。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set OSS_ACCESS_KEY_ID=LTAI5tXXXXXXXXXXXXXXXXXXXXM8TP</span><br><span class="line">set OSS_ACCESS_KEY_SECRET=UzMcJXXXXXXXXXXXXXXXXXXXXdabTNafi</span><br></pre></td></tr></table></figure>
<p><span style='color:red; font-size: 25px; font-weight:800'> 注意：将上述的ACCESS_KEY_ID  与 ACCESS_KEY_SECRET 的值一定一定一定一定一定一定要替换成自己的 。</span></p>
<p>执行如下命令，让更改生效。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">setx OSS_ACCESS_KEY_ID &quot;%OSS_ACCESS_KEY_ID%&quot;</span><br><span class="line">setx OSS_ACCESS_KEY_SECRET &quot;%OSS_ACCESS_KEY_SECRET%&quot;</span><br></pre></td></tr></table></figure>
<p>执行如下命令，验证环境变量是否生效。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo %OSS_ACCESS_KEY_ID%</span><br><span class="line">echo %OSS_ACCESS_KEY_SECRET%</span><br></pre></td></tr></table></figure>
<h4 id="入门"><a href="#入门" class="headerlink" title="入门"></a>入门</h4><p>阿里云oss 对象存储服务的准备工作我们已经完成了，接下来我们就来完成第二步操作：参照官方所提供的sdk示例来编写入门程序。</p>
<p>首先我们需要来打开阿里云OSS的官方文档，在官方文档中找到 SDK 的示例代码：</p>
<p><img src="image-20231203204307766.png" alt="image-20231203204307766"></p>
<blockquote>
<p>如果是在实际开发当中，我们是需要从前往后仔细的去阅读这一份文档的，但是由于现在是教学，我们就只挑重点的去看。有兴趣的同学大家下来也可以自己去看一下这份官方文档。</p>
</blockquote>
<p><img src="image-20231203204415060.png" alt="image-20231203204415060"></p>
<p><img src="image-20231203204510698.png" alt="image-20231203204510698"></p>
<p>参照官方提供的SDK，改造一下，即可实现文件上传功能：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dkd.common.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.aliyun.oss.ClientException;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.oss.OSS;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.oss.common.auth.*;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.oss.OSSClientBuilder;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.oss.OSSException;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.oss.model.PutObjectRequest;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.oss.model.PutObjectResult;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// Endpoint以华东1（杭州）为例，其它Region请按实际情况填写。</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">endpoint</span> <span class="operator">=</span> <span class="string">&quot;https://oss-cn-beijing.aliyuncs.com&quot;</span>;</span><br><span class="line">        <span class="comment">// 从环境变量中获取访问凭证。运行本代码示例之前，请确保已设置环境变量OSS_ACCESS_KEY_ID和OSS_ACCESS_KEY_SECRET。</span></span><br><span class="line">        <span class="type">EnvironmentVariableCredentialsProvider</span> <span class="variable">credentialsProvider</span> <span class="operator">=</span> CredentialsProviderFactory.newEnvironmentVariableCredentialsProvider();</span><br><span class="line">        <span class="comment">// 填写Bucket名称，例如examplebucket。</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">bucketName</span> <span class="operator">=</span> <span class="string">&quot;dkd-itheima&quot;</span>;</span><br><span class="line">        <span class="comment">// 填写Object完整路径，完整路径中不能包含Bucket名称，例如exampledir/exampleobject.txt。</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">objectName</span> <span class="operator">=</span> <span class="string">&quot;gao.png&quot;</span>;</span><br><span class="line">        <span class="comment">// 填写本地文件的完整路径，例如D:\\localpath\\examplefile.txt。</span></span><br><span class="line">        <span class="comment">// 如果未指定本地路径，则默认从示例程序所属项目对应本地路径中上传文件流。</span></span><br><span class="line">        String filePath= <span class="string">&quot;E:\\temp\\upload\\gao.png&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建OSSClient实例。</span></span><br><span class="line">        <span class="type">OSS</span> <span class="variable">ossClient</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OSSClientBuilder</span>().build(endpoint, credentialsProvider);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(filePath);</span><br><span class="line">            <span class="comment">// 创建PutObjectRequest对象。</span></span><br><span class="line">            <span class="type">PutObjectRequest</span> <span class="variable">putObjectRequest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PutObjectRequest</span>(bucketName, objectName, inputStream);</span><br><span class="line">            <span class="comment">// 创建PutObject请求。</span></span><br><span class="line">            <span class="type">PutObjectResult</span> <span class="variable">result</span> <span class="operator">=</span> ossClient.putObject(putObjectRequest);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (OSSException oe) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Caught an OSSException, which means your request made it to OSS, &quot;</span></span><br><span class="line">                    + <span class="string">&quot;but was rejected with an error response for some reason.&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;Error Message:&quot;</span> + oe.getErrorMessage());</span><br><span class="line">            System.out.println(<span class="string">&quot;Error Code:&quot;</span> + oe.getErrorCode());</span><br><span class="line">            System.out.println(<span class="string">&quot;Request ID:&quot;</span> + oe.getRequestId());</span><br><span class="line">            System.out.println(<span class="string">&quot;Host ID:&quot;</span> + oe.getHostId());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClientException ce) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Caught an ClientException, which means the client encountered &quot;</span></span><br><span class="line">                    + <span class="string">&quot;a serious internal problem while trying to communicate with OSS, &quot;</span></span><br><span class="line">                    + <span class="string">&quot;such as not being able to access the network.&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;Error Message:&quot;</span> + ce.getMessage());</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (ossClient != <span class="literal">null</span>) &#123;</span><br><span class="line">                ossClient.shutdown();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在以上代码中，需要替换的内容为：</p>
<ul>
<li><p>endpoint：阿里云OSS中的bucket对应的域名</p>
</li>
<li><p>bucketName：Bucket名称</p>
</li>
<li>objectName：对象名称，在Bucket中存储的对象的名称</li>
<li>filePath：文件路径</li>
</ul>
</blockquote>
<p>运行以上程序后，会把本地的文件上传到阿里云OSS服务器上。</p>
<h3 id="x-file-storage"><a href="#x-file-storage" class="headerlink" title="x-file-storage"></a>x-file-storage</h3><h4 id="介绍-1"><a href="#介绍-1" class="headerlink" title="介绍"></a>介绍</h4><p><img src="image-20240618105934234.png" alt="image-20240618105934234"></p>
<p>官方地址：<a target="_blank" rel="noopener" href="https://x-file-storage.xuyanwu.cn/#/">https://x-file-storage.xuyanwu.cn/#/</a></p>
<p>一行代码将文件存储到本地、FTP、SFTP、WebDAV、阿里云 OSS、华为云 OBS、七牛云 Kodo、腾讯云 COS、百度云 BOS、又拍云 USS、MinIO、 Amazon S3、GoogleCloud Storage、FastDFS、 Azure Blob Storage、Cloudflare R2、金山云 KS3、美团云 MSS、京东云 OSS、天翼云 OOS、移动 云EOS、沃云 OSS、 网易数帆 NOS、Ucloud US3、青云 QingStor、平安云 OBS、首云 OSS、IBM COS、其它兼容 S3 协议的存储平台。</p>
<h4 id="集成"><a href="#集成" class="headerlink" title="集成"></a>集成</h4><p>1）在dkd-common的pom.xml中引入依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 文件上传--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.dromara.x-file-storage<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>x-file-storage-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 阿里云oss--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.aliyun.oss<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aliyun-sdk-oss<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.16.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>2）在dkd-admin的<code>application.yml</code> 配置文件中先添加以下基础配置，再添加对应平台的配置</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 文件上传</span></span><br><span class="line"><span class="attr">dromara:</span></span><br><span class="line">  <span class="attr">x-file-storage:</span> <span class="comment">#文件存储配置</span></span><br><span class="line">    <span class="attr">default-platform:</span> <span class="string">aliyun-oss-1</span> <span class="comment">#默认使用的存储平台</span></span><br><span class="line">    <span class="attr">thumbnail-suffix:</span> <span class="string">&quot;.min.jpg&quot;</span> <span class="comment">#缩略图后缀，例如【.min.jpg】【.png】</span></span><br><span class="line">    <span class="comment">#对应平台的配置写在这里，注意缩进要对齐</span></span><br><span class="line">    <span class="attr">aliyun-oss:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">platform:</span> <span class="string">aliyun-oss-1</span> <span class="comment"># 存储平台标识</span></span><br><span class="line">        <span class="attr">enable-storage:</span> <span class="literal">true</span>  <span class="comment"># 启用存储</span></span><br><span class="line">        <span class="attr">access-key:</span> <span class="string">??</span></span><br><span class="line">        <span class="attr">secret-key:</span> <span class="string">??</span></span><br><span class="line">        <span class="attr">end-point:</span> <span class="string">??</span></span><br><span class="line">        <span class="attr">bucket-name:</span> <span class="string">??</span></span><br><span class="line">        <span class="attr">domain:</span> <span class="string">??</span> <span class="comment"># 访问域名，注意“/”结尾，例如：https://abc.oss-cn-shanghai.aliyuncs.com/</span></span><br><span class="line">        <span class="attr">base-path:</span> <span class="string">dkd-images/</span> <span class="comment"># 基础路径</span></span><br></pre></td></tr></table></figure>
<p>3）在dkd-admin的启动类上加上<code>@EnableFileStorage</code>注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableFileStorage</span></span><br><span class="line"><span class="meta">@SpringBootApplication(exclude = &#123; DataSourceAutoConfiguration.class &#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DkdApplication</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// System.setProperty(&quot;spring.devtools.restart.enabled&quot;, &quot;false&quot;);</span></span><br><span class="line">        SpringApplication.run(DkdApplication.class, args);</span><br><span class="line">        System.out.println(<span class="string">&quot;(♥◠‿◠)ﾉﾞ  帝可得启动成功   ლ(´ڡ`ლ)ﾞ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4）修改若依默认上传图片代码</p>
<p>找到ruoyi-admin模块中的com.ruoyi.web.controller.common.<strong>CommonController类</strong>，修改单个文件上传的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> FileStorageService fileStorageService;<span class="comment">//注入实列</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 通用上传请求（单个）</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/upload&quot;)</span></span><br><span class="line"><span class="keyword">public</span> AjaxResult <span class="title function_">uploadFile</span><span class="params">(MultipartFile file)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 指定oss保存文件路径</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">objectName</span> <span class="operator">=</span> LocalDate.now().format(DateTimeFormatter.ofPattern(<span class="string">&quot;yyyy/MM/dd&quot;</span>)) + <span class="string">&quot;/&quot;</span>;</span><br><span class="line">        <span class="comment">// 上传图片，成功返回文件信息</span></span><br><span class="line">        <span class="type">FileInfo</span> <span class="variable">fileInfo</span> <span class="operator">=</span> fileStorageService.of(file).setPath(objectName).upload();</span><br><span class="line">        <span class="comment">// 设置返回结果</span></span><br><span class="line">        <span class="type">AjaxResult</span> <span class="variable">ajax</span> <span class="operator">=</span> AjaxResult.success();</span><br><span class="line">        ajax.put(<span class="string">&quot;url&quot;</span>, fileInfo.getUrl());</span><br><span class="line">        ajax.put(<span class="string">&quot;fileName&quot;</span>, fileInfo.getUrl());  <span class="comment">//注意：这里的值要改为url，前端访问的地址,需要文件的地址 而不是文件名称</span></span><br><span class="line">        ajax.put(<span class="string">&quot;newFileName&quot;</span>, fileInfo.getUrl());</span><br><span class="line">        ajax.put(<span class="string">&quot;originalFilename&quot;</span>, file.getOriginalFilename());</span><br><span class="line">        <span class="keyword">return</span> ajax;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        <span class="keyword">return</span> AjaxResult.error(e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>5）联调测试，重启后台程序，前端上传图片操作，<strong>F12</strong>抓包工具查看效果：</p>
<p><img src="image-20240618111315884.png" alt="image-20240618111315884"></p>
<h1 id="设备管理"><a href="#设备管理" class="headerlink" title="设备管理"></a>设备管理</h1><h2 id="需求说明-2"><a href="#需求说明-2" class="headerlink" title="需求说明"></a>需求说明</h2><p><img src="image-20240620160545588.png" alt="image-20240620160545588"></p>
<p>点位管理主要涉及到三个功能模块，业务流程如下：</p>
<ol>
<li><strong>新增设备类型</strong>: 允许管理员定义新的售货机型号，包括其规格和容量。</li>
<li><strong>新增设备</strong>: 在新的设备类型定义后，系统应允许添加新的售货机实例，并将它们分配到特定的点位。</li>
<li><strong>新增货道</strong>: 对于每个新添加的设备，系统应支持定义新的货道，后期用于关联相应的商品SKU。</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">    A[登录系统] </span><br><span class="line">    A --&gt; B[新增设备类型]</span><br><span class="line">    B --&gt; C[新增设备]</span><br><span class="line">    C --&gt; D[新增货道]</span><br></pre></td></tr></table></figure>
<p>对于设备和其他管理数据，下面是示意图：</p>
<ul>
<li>关系字段：vm_type_id、node_id、vm_id</li>
<li>数据字典：vm_status（0未投放、1运营、3撤机）</li>
<li>冗余字段：addr、business_type、region_id、partner_id（简化查询接口、提高查询效率）</li>
</ul>
<p><img src="image-20240620164449528.png" alt="image-20240620164449528"></p>
<h2 id="生成基础代码-2"><a href="#生成基础代码-2" class="headerlink" title="生成基础代码"></a>生成基础代码</h2><h3 id="需求-8"><a href="#需求-8" class="headerlink" title="需求"></a>需求</h3><p>使用若依代码生成器，生成设备类型、设备、货道前后端基础代码，并导入到项目中：</p>
<p><img src="image-20240630094429654.png" alt="image-20240630094429654"></p>
<h3 id="步骤-2"><a href="#步骤-2" class="headerlink" title="步骤"></a>步骤</h3><h4 id="①创建目录菜单-2"><a href="#①创建目录菜单-2" class="headerlink" title="①创建目录菜单"></a>①创建目录菜单</h4><p>创建设备管理目录菜单</p>
<p><img src="image-20240619221613865.png" alt="image-20240619221613865">   <img src="image-20240619221629528.png" alt="image-20240619221629528">  </p>
<h4 id="②添加数据字典-2"><a href="#②添加数据字典-2" class="headerlink" title="②添加数据字典"></a>②添加数据字典</h4><p>先创建<code>设备状态</code>的字典类型</p>
<p><img src="image-20240619221833852.png" alt="image-20240619221833852">  </p>
<p><img src="image-20240619222227644.png" alt="image-20240619222227644">  </p>
<p>再创建<code>设备状态</code>的字典数据</p>
<p><img src="image-20240619222315484.png" alt="image-20240619222315484">  </p>
<p><img src="image-20240619222356159.png" alt="image-20240619222356159"></p>
<h4 id="③配置代码生成信息-2"><a href="#③配置代码生成信息-2" class="headerlink" title="③配置代码生成信息"></a>③配置代码生成信息</h4><p>导入三张表</p>
<p><img src="image-20240620144626365.png" alt="image-20240620144626365"></p>
<p>配置设备类型表（参考原型）</p>
<p><img src="image-20240620092207215.png" alt="image-20240620092207215">  </p>
<p><img src="image-20240620092949410.png" alt="image-20240620092949410"></p>
<p><img src="image-20240620100029813.png" alt="image-20240620100029813"></p>
<p><img src="image-20240620093047213.png" alt="image-20240620093047213"></p>
<p>配置设备表（参考原型）</p>
<p><img src="image-20240620093441442.png" alt="image-20240620093441442">  </p>
<p><img src="image-20240620100002707.png" alt="image-20240620100002707"></p>
<p><img src="image-20240620094725603.png" alt="image-20240620094725603"></p>
<p>配置货道表（无原型）</p>
<p><img src="image-20240620144950436.png" alt="image-20240620144950436"></p>
<p><img src="image-20240620145048747.png" alt="image-20240620145048747"></p>
<p><img src="image-20240620145103156.png" alt="image-20240620145103156"></p>
<h4 id="④下载代码并导入项目-2"><a href="#④下载代码并导入项目-2" class="headerlink" title="④下载代码并导入项目"></a>④下载代码并导入项目</h4><p>选中三张表生成下载</p>
<p><img src="image-20240620145131847.png" alt="image-20240620145131847"></p>
<p>解压<code>ruoyi.zip</code>得到前后端代码和动态菜单sql</p>
<blockquote>
<p>注意：货道动态菜单sql和前端不需要导入</p>
</blockquote>
<p><img src="image-20240620145300354.png" alt="image-20240620145300354"></p>
<p>代码导入</p>
<p><img src="image-20240620095333947.png" alt="image-20240620095333947"> <img src="image-20240620145720081.png" alt="image-20240620145720081"></p>
<p>调整二级菜单显示顺序（设备状态稍后完成）</p>
<p><img src="image-20240620095814155.png" alt="image-20240620095814155"></p>
<h2 id="设备类型改造"><a href="#设备类型改造" class="headerlink" title="设备类型改造"></a>设备类型改造</h2><h3 id="基础页面-4"><a href="#基础页面-4" class="headerlink" title="基础页面"></a>基础页面</h3><h4 id="需求-9"><a href="#需求-9" class="headerlink" title="需求"></a>需求</h4><p>参考页面原型，完成基础布局展示改造</p>
<p><img src="image-20240620100946781.png" alt="image-20240620100946781">  </p>
<h4 id="代码实现-4"><a href="#代码实现-4" class="headerlink" title="代码实现"></a>代码实现</h4><p>在vmType/index.vue视图组件中修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 查询条件 --&gt;</span><br><span class="line">&lt;el-form :model=&quot;queryParams&quot; ref=&quot;queryRef&quot; :inline=&quot;true&quot; v-show=&quot;showSearch&quot; label-width=&quot;68px&quot;&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;型号名称&quot; prop=&quot;name&quot;&gt;</span><br><span class="line">        &lt;el-input  v-model=&quot;queryParams.name&quot; placeholder=&quot;请输入型号名称&quot; clearable  @keyup.enter=&quot;handleQuery&quot;/&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item&gt;</span><br><span class="line">        &lt;el-button type=&quot;primary&quot; icon=&quot;Search&quot; @click=&quot;handleQuery&quot;&gt;搜索&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button icon=&quot;Refresh&quot; @click=&quot;resetQuery&quot;&gt;重置&lt;/el-button&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">&lt;/el-form&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 列表展示 --&gt;</span><br><span class="line">&lt;el-table v-loading=&quot;loading&quot; :data=&quot;vmTypeList&quot; @selection-change=&quot;handleSelectionChange&quot;&gt;</span><br><span class="line">    &lt;el-table-column type=&quot;selection&quot; width=&quot;55&quot; align=&quot;center&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;型号名称&quot; align=&quot;center&quot; prop=&quot;name&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;型号编码&quot; align=&quot;center&quot; prop=&quot;model&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;设备图片&quot; align=&quot;center&quot; prop=&quot;image&quot; width=&quot;100&quot;&gt;</span><br><span class="line">        &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">&lt;image-preview :src=&quot;scope.row.image&quot; :width=&quot;50&quot; :height=&quot;50&quot;/&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">    &lt;/el-table-column&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;货道行&quot; align=&quot;center&quot; prop=&quot;vmRow&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;货道列&quot; align=&quot;center&quot; prop=&quot;vmCol&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;设备容量&quot; align=&quot;center&quot; prop=&quot;channelMaxCapacity&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;操作&quot; align=&quot;center&quot; class-name=&quot;small-padding fixed-width&quot;&gt;</span><br><span class="line">        &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">  &lt;el-button link type=&quot;primary&quot; @click=&quot;handleUpdate(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:vmType:edit&#x27;]&quot;&gt;修改&lt;/el-button&gt;</span><br><span class="line">  &lt;el-button link type=&quot;primary&quot; @click=&quot;handleDelete(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:vmType:remove&#x27;]&quot;&gt;删除&lt;/el-button&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">    &lt;/el-table-column&gt;</span><br><span class="line">&lt;/el-table&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 添加或修改设备类型管理对话框 --&gt;</span><br><span class="line">&lt;el-dialog :title=&quot;title&quot; v-model=&quot;open&quot; width=&quot;500px&quot; append-to-body&gt;</span><br><span class="line">    &lt;el-form ref=&quot;vmTypeRef&quot; :model=&quot;form&quot; :rules=&quot;rules&quot; label-width=&quot;80px&quot;&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;型号名称&quot; prop=&quot;name&quot;&gt;</span><br><span class="line">            &lt;el-input v-model=&quot;form.name&quot; placeholder=&quot;请输入型号名称&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;型号编码&quot; prop=&quot;model&quot;&gt;</span><br><span class="line">            &lt;el-input v-model=&quot;form.model&quot; placeholder=&quot;请输入型号编码&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;货道数&quot; prop=&quot;vmRow&quot;&gt;</span><br><span class="line">            &lt;el-input-number v-model=&quot;form.vmRow&quot; placeholder=&quot;请输入&quot;  :min=&quot;1&quot; :max=&quot;10&quot;/&gt;行&amp;nbsp;&amp;nbsp;</span><br><span class="line">            &lt;el-input-number v-model=&quot;form.vmCol&quot; placeholder=&quot;请输入&quot;  :min=&quot;1&quot; :max=&quot;10&quot;/&gt;列</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;货道容量&quot; prop=&quot;channelMaxCapacity&quot;&gt;</span><br><span class="line">            &lt;el-input-number v-model=&quot;form.channelMaxCapacity&quot; placeholder=&quot;请输入&quot;  :min=&quot;1&quot; :max=&quot;10&quot;/&gt;个</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;设备图片&quot; prop=&quot;image&quot;&gt;</span><br><span class="line">            &lt;image-upload v-model=&quot;form.image&quot;/&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">    &lt;/el-form&gt;</span><br><span class="line">    &lt;template #footer&gt;</span><br><span class="line">        &lt;div class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">            &lt;el-button type=&quot;primary&quot; @click=&quot;submitForm&quot;&gt;确 定&lt;/el-button&gt;</span><br><span class="line">            &lt;el-button @click=&quot;cancel&quot;&gt;取 消&lt;/el-button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">&lt;/el-dialog&gt;</span><br></pre></td></tr></table></figure>
<h2 id="设备管理改造"><a href="#设备管理改造" class="headerlink" title="设备管理改造"></a>设备管理改造</h2><h3 id="基础页面-5"><a href="#基础页面-5" class="headerlink" title="基础页面"></a>基础页面</h3><h4 id="需求-10"><a href="#需求-10" class="headerlink" title="需求"></a>需求</h4><p>参考页面原型，完成基础布局展示改造</p>
<p><img src="image-20240620105247310.png" alt="image-20240620105247310"></p>
<h4 id="代码实现-5"><a href="#代码实现-5" class="headerlink" title="代码实现"></a>代码实现</h4><p>刷新设备表数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> tb_vending_machine <span class="keyword">set</span> partner_id<span class="operator">=</span><span class="number">2</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="number">80</span>;</span><br><span class="line"><span class="keyword">update</span> tb_vending_machine <span class="keyword">set</span> addr<span class="operator">=</span>(<span class="keyword">select</span> address <span class="keyword">from</span> tb_node <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>) <span class="keyword">where</span> node_id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">update</span> tb_vending_machine <span class="keyword">set</span> addr<span class="operator">=</span>(<span class="keyword">select</span> address <span class="keyword">from</span> tb_node <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">2</span>) <span class="keyword">where</span> node_id<span class="operator">=</span><span class="number">2</span>;</span><br></pre></td></tr></table></figure>
<p>在vm/index.vue视图组件中修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 查询条件 --&gt;</span><br><span class="line">&lt;el-form :model=&quot;queryParams&quot; ref=&quot;queryRef&quot; :inline=&quot;true&quot; v-show=&quot;showSearch&quot; label-width=&quot;68px&quot;&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;设备编号&quot; prop=&quot;innerCode&quot;&gt;</span><br><span class="line">        &lt;el-input v-model=&quot;queryParams.innerCode&quot; placeholder=&quot;请输入设备编号&quot; clearable @keyup.enter=&quot;handleQuery&quot; /&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item&gt;</span><br><span class="line">        &lt;el-button type=&quot;primary&quot; icon=&quot;Search&quot; @click=&quot;handleQuery&quot;&gt;搜索&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button icon=&quot;Refresh&quot; @click=&quot;resetQuery&quot;&gt;重置&lt;/el-button&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">&lt;/el-form&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 列表展示 --&gt;</span><br><span class="line">&lt;el-table v-loading=&quot;loading&quot; :data=&quot;vmList&quot; @selection-change=&quot;handleSelectionChange&quot;&gt;</span><br><span class="line">  &lt;el-table-column type=&quot;selection&quot; width=&quot;55&quot; align=&quot;center&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;设备编号&quot; align=&quot;center&quot; prop=&quot;innerCode&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;设备型号&quot; align=&quot;center&quot; prop=&quot;vmTypeId&quot; &gt;</span><br><span class="line">    &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">      &lt;div v-for=&quot;item in vmTypeList&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">        &lt;span v-if=&quot;item.id==scope.row.vmTypeId&quot;&gt;&#123;&#123; item.name &#125;&#125;&lt;/span&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/el-table-column&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;详细地址&quot; align=&quot;center&quot; prop=&quot;addr&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;合作商&quot; align=&quot;center&quot; prop=&quot;partnerId&quot; &gt;</span><br><span class="line">    &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">      &lt;div v-for=&quot;item in partnerList&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">        &lt;span v-if=&quot;item.id==scope.row.partnerId&quot;&gt;&#123;&#123; item.partnerName &#125;&#125;&lt;/span&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/el-table-column&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;设备状态&quot; align=&quot;center&quot; prop=&quot;vmStatus&quot;&gt;</span><br><span class="line">    &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">      &lt;dict-tag :options=&quot;vm_status&quot; :value=&quot;scope.row.vmStatus&quot; /&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/el-table-column&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;操作&quot; align=&quot;center&quot; class-name=&quot;small-padding fixed-width&quot;&gt;</span><br><span class="line">    &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">      &lt;el-button link type=&quot;primary&quot; @click=&quot;handleUpdate(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:vm:edit&#x27;]&quot;&gt;修改&lt;/el-button&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/el-table-column&gt;</span><br><span class="line">&lt;/el-table&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 添加或修改设备管理对话框 --&gt;</span><br><span class="line">&lt;el-dialog :title=&quot;title&quot; v-model=&quot;open&quot; width=&quot;500px&quot; append-to-body&gt;</span><br><span class="line">  &lt;el-form ref=&quot;vmRef&quot; :model=&quot;form&quot; :rules=&quot;rules&quot; label-width=&quot;80px&quot;&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;设备编号&quot;&gt;</span><br><span class="line">      &lt;span&gt;&#123;&#123; form.innerCode == null ? &#x27;系统自动生成&#x27; : form.innerCode &#125;&#125;&lt;/span&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;供货时间&quot; v-if=&quot;form.innerCode != null&quot;&gt;</span><br><span class="line">      &lt;span&gt;&#123;&#123; parseTime(form.lastSupplyTime, &#x27;&#123;y&#125;-&#123;m&#125;-&#123;d&#125; &#123;h&#125;:&#123;i&#125;:&#123;s&#125;&#x27;) &#125;&#125;&lt;/span&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;设备类型&quot; v-if=&quot;form.innerCode != null&quot;&gt;</span><br><span class="line">      &lt;div v-for=&quot;item in vmTypeList&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">        &lt;span v-if=&quot;form.vmTypeId == item.id&quot;&gt;&#123;&#123; item.name &#125;&#125;&lt;/span&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;设备容量&quot; v-if=&quot;form.innerCode != null&quot;&gt;</span><br><span class="line">      &lt;span&gt;&#123;&#123; form.channelMaxCapacity &#125;&#125;&lt;/span&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;选择型号&quot; prop=&quot;vmTypeId&quot; v-if=&quot;form.innerCode == null&quot;&gt;</span><br><span class="line">      &lt;!-- &lt;el-input v-model=&quot;form.vmTypeId&quot; placeholder=&quot;请输入设备型号&quot; /&gt; --&gt;</span><br><span class="line">      &lt;el-select v-model=&quot;form.vmTypeId&quot; placeholder=&quot;请选择设备型号&quot; style=&quot;width: 100%&quot;&gt;</span><br><span class="line">        &lt;el-option v-for=&quot;item in vmTypeList&quot; :key=&quot;item.id&quot; :label=&quot;item.name&quot; :value=&quot;item.id&quot; /&gt;</span><br><span class="line">      &lt;/el-select&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;选择点位&quot; prop=&quot;nodeId&quot;&gt;</span><br><span class="line">      &lt;!-- &lt;el-input v-model=&quot;form.nodeId&quot; placeholder=&quot;请输入点位Id&quot; /&gt; --&gt;</span><br><span class="line">      &lt;el-select v-model=&quot;form.nodeId&quot; placeholder=&quot;请选择点位&quot; style=&quot;width: 100%&quot;&gt;</span><br><span class="line">        &lt;el-option v-for=&quot;item in nodeList&quot; :key=&quot;item.id&quot; :label=&quot;item.nodeName&quot; :value=&quot;item.id&quot; /&gt;</span><br><span class="line">      &lt;/el-select&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;合作商&quot; v-if=&quot;form.innerCode != null&quot;&gt;</span><br><span class="line">      &lt;div v-for=&quot;item in partnerList&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">        &lt;span v-if=&quot;form.partnerId == item.id&quot;&gt;&#123;&#123; item.partnerName &#125;&#125;&lt;/span&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;所属区域&quot; v-if=&quot;form.innerCode != null&quot;&gt;</span><br><span class="line">      &lt;div v-for=&quot;item in regionList&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">        &lt;span v-if=&quot;form.regionId == item.id&quot;&gt;&#123;&#123; item.regionName &#125;&#125;&lt;/span&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;设备地址&quot; v-if=&quot;form.innerCode != null&quot;&gt;</span><br><span class="line">        &lt;span&gt;&#123;&#123; form.addr &#125;&#125;&lt;/span&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">  &lt;/el-form&gt;</span><br><span class="line">  &lt;template #footer&gt;</span><br><span class="line">    &lt;div class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">      &lt;el-button type=&quot;primary&quot; @click=&quot;submitForm&quot;&gt;确 定&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button @click=&quot;cancel&quot;&gt;取 消&lt;/el-button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/template&gt;</span><br><span class="line">&lt;/el-dialog&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup name=&quot;Vm&quot;&gt;</span><br><span class="line">import &#123; listVmType &#125; from &quot;@/api/manage/vmType&quot;;</span><br><span class="line">import &#123; listPartner &#125; from &quot;@/api/manage/partner&quot;;</span><br><span class="line">import &#123; loadAllParams &#125; from &#x27;@/api/page&#x27;;</span><br><span class="line">import &#123; listNode &#125; from &#x27;@/api/manage/node&#x27;;</span><br><span class="line">import &#123; listRegion &#125; from &quot;@/api/manage/region&quot;;</span><br><span class="line">    </span><br><span class="line">/* 查询设备类型列表 */</span><br><span class="line">const vmTypeList = ref([]);</span><br><span class="line">function getVmTypeList() &#123;</span><br><span class="line">  listVmType(loadAllParams).then((response) =&gt; &#123;</span><br><span class="line">    vmTypeList.value = response.rows;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">/* 查询合作商列表 */</span><br><span class="line">const partnerList = ref([]);</span><br><span class="line">function getPartnerList() &#123;</span><br><span class="line">  listPartner(loadAllParams).then((response) =&gt; &#123;</span><br><span class="line">    partnerList.value = response.rows;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">/* 查询点位列表 */</span><br><span class="line">const nodeList = ref([]);</span><br><span class="line">function getNodeList() &#123;</span><br><span class="line">  listNode(loadAllParams).then((response) =&gt; &#123;</span><br><span class="line">    nodeList.value = response.rows;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">/* 查询区域列表 */</span><br><span class="line">const regionList = ref([]);</span><br><span class="line">function getRegionList() &#123;</span><br><span class="line">  listRegion(loadAllParams).then((response) =&gt; &#123;</span><br><span class="line">    regionList.value = response.rows;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">getRegionList();</span><br><span class="line">getPartnerList();</span><br><span class="line">getNodeList();</span><br><span class="line">getVmTypeList();</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h3 id="新增设备"><a href="#新增设备" class="headerlink" title="新增设备"></a>新增设备</h3><h4 id="需求-11"><a href="#需求-11" class="headerlink" title="需求"></a>需求</h4><p>新增设备时，补充设备表其他字段信息，还需要根据售货机类型创建所属货道</p>
<p><img src="image-20240630161558158.png" alt="image-20240630161558158"> <img src="image-20240710101123724.png" alt="image-20240710101123724" style="zoom: 67%;" />  </p>
<p>我们了解到在新增设备时，添加设备和货道表，还包含点位和设备类型的查询，共涉及到四张表的操作。</p>
<p>这个过程需要我们仔细处理每个字段，确保数据的一致性和完整性</p>
<p><img src="image-20240710170114925.png" alt="image-20240710170114925"></p>
<h4 id="VendingMachineServiceImpl"><a href="#VendingMachineServiceImpl" class="headerlink" title="VendingMachineServiceImpl"></a>VendingMachineServiceImpl</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> INodeService nodeService;</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> IVmTypeService vmTypeService;</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> IChannelService channelService;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 新增设备管理</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> vendingMachine 设备管理</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">insertVendingMachine</span><span class="params">(VendingMachine vendingMachine)</span> &#123;</span><br><span class="line">    <span class="comment">//1. 新增设备</span></span><br><span class="line">    <span class="comment">//1-1 生成8位编号，补充货道编号</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">innerCode</span> <span class="operator">=</span> UUIDUtils.getUUID();</span><br><span class="line">    vendingMachine.setInnerCode(innerCode); <span class="comment">// 售货机编号</span></span><br><span class="line">    <span class="comment">//1-2 查询售货机类型表，补充设备容量</span></span><br><span class="line">    <span class="type">VmType</span> <span class="variable">vmType</span> <span class="operator">=</span> vmTypeService.selectVmTypeById(vendingMachine.getVmTypeId());</span><br><span class="line">    vendingMachine.setChannelMaxCapacity(vmType.getChannelMaxCapacity());</span><br><span class="line">    <span class="comment">//1-3 查询点位表，补充 区域、点位、合作商等信息</span></span><br><span class="line">    <span class="type">Node</span> <span class="variable">node</span> <span class="operator">=</span> nodeService.selectNodeById(vendingMachine.getNodeId());</span><br><span class="line">    BeanUtil.copyProperties(node, vendingMachine, <span class="string">&quot;id&quot;</span>);</span><br><span class="line">    vendingMachine.setAddr(node.getAddress());</span><br><span class="line">    <span class="comment">//1-4 设备状态</span></span><br><span class="line">    vendingMachine.setVmStatus(DkdContants.VM_STATUS_NODEPLOY);<span class="comment">// 0-未投放（数据库有默认值，这个不写也不影响）</span></span><br><span class="line">    vendingMachine.setCreateTime(DateUtils.getNowDate());<span class="comment">// 创建时间</span></span><br><span class="line">    vendingMachine.setUpdateTime(DateUtils.getNowDate());<span class="comment">// 更新时间</span></span><br><span class="line">    <span class="comment">//1-5 保存</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> vendingMachineMapper.insertVendingMachine(vendingMachine);</span><br><span class="line">    <span class="comment">//2. 新增货道</span></span><br><span class="line">    <span class="comment">//2-1 声明货道集合</span></span><br><span class="line">    List&lt;Channel&gt; channelList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">//2-2 双层for循环</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= vmType.getVmRow(); i++) &#123; <span class="comment">// 外层行</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt;= vmType.getVmCol(); j++) &#123;<span class="comment">// 内层列</span></span><br><span class="line">            <span class="comment">//2-3 封装channel</span></span><br><span class="line">            <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Channel</span>();</span><br><span class="line">            channel.setChannelCode(i + <span class="string">&quot;-&quot;</span> + j);<span class="comment">// 货道编号</span></span><br><span class="line">            channel.setVmId(vendingMachine.getId());<span class="comment">// 售货机id</span></span><br><span class="line">            channel.setInnerCode(vendingMachine.getInnerCode());<span class="comment">// 售货机编号</span></span><br><span class="line">            channel.setMaxCapacity(vmType.getChannelMaxCapacity());<span class="comment">// 货道最大容量</span></span><br><span class="line">            channel.setCreateTime(DateUtils.getNowDate());<span class="comment">// 创建时间</span></span><br><span class="line">            channel.setUpdateTime(DateUtils.getNowDate());<span class="comment">// 更新时间</span></span><br><span class="line">            channelList.add(channel);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2-4 批量新增</span></span><br><span class="line">    channelService.batchInsertChannel(channelList);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ChannelMapper接口和xml"><a href="#ChannelMapper接口和xml" class="headerlink" title="ChannelMapper接口和xml"></a>ChannelMapper接口和xml</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 批量新增售货机货道</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> channelList</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">batchInsertChannel</span><span class="params">(List&lt;Channel&gt; channelList)</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;batchInsertChannel&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;java.util.List&quot;</span>&gt;</span></span><br><span class="line">    INSERT INTO tb_channel (</span><br><span class="line">    channel_code, vm_id, inner_code, max_capacity, last_supply_time, create_time, update_time</span><br><span class="line">    ) VALUES</span><br><span class="line">    <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;list&quot;</span> <span class="attr">item</span>=<span class="string">&quot;channel&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">        (</span><br><span class="line">        #&#123;channel.channelCode&#125;,</span><br><span class="line">        #&#123;channel.vmId&#125;,</span><br><span class="line">        #&#123;channel.innerCode&#125;,</span><br><span class="line">        #&#123;channel.maxCapacity&#125;,</span><br><span class="line">        #&#123;channel.lastSupplyTime&#125;,</span><br><span class="line">        #&#123;channel.createTime&#125;,</span><br><span class="line">        #&#123;channel.updateTime&#125;</span><br><span class="line">        )</span><br><span class="line">    <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="IChannelService"><a href="#IChannelService" class="headerlink" title="IChannelService"></a>IChannelService</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 批量新增售货机货道</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> channelList</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">batchInsertChannel</span><span class="params">(List&lt;Channel&gt; channelList)</span>;</span><br></pre></td></tr></table></figure>
<h4 id="ChannelServiceImpl"><a href="#ChannelServiceImpl" class="headerlink" title="ChannelServiceImpl"></a>ChannelServiceImpl</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 批量新增售货机货道</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> channelList</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">batchInsertChannel</span><span class="params">(List&lt;Channel&gt; channelList)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> channelMapper.batchInsertChannel(channelList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="修改设备"><a href="#修改设备" class="headerlink" title="修改设备"></a>修改设备</h3><h4 id="需求-12"><a href="#需求-12" class="headerlink" title="需求"></a>需求</h4><p>修改设备时，根据点位同步更新冗余字段信息</p>
<p><img src="image-20240710094831550.png" alt="image-20240710094831550"></p>
<p>根据前端提交的点位ID，后端需要查询点位表，来获取点位的详细信息，包括详细地址、商圈类型、区域ID和合作商ID，获取到点位信息后，我们需要更新设备表中的相关冗余字段。</p>
<p><img src="image-20240710202709375.png" alt="image-20240710202709375"></p>
<h4 id="VendingMachineServiceImpl-1"><a href="#VendingMachineServiceImpl-1" class="headerlink" title="VendingMachineServiceImpl"></a>VendingMachineServiceImpl</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 修改设备管理</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> vendingMachine 设备管理</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">updateVendingMachine</span><span class="params">(VendingMachine vendingMachine)</span> &#123;</span><br><span class="line">    <span class="comment">//查询点位表，补充 区域、点位、合作商等信息</span></span><br><span class="line">    <span class="type">Node</span> <span class="variable">node</span> <span class="operator">=</span> nodeService.selectNodeById(vendingMachine.getNodeId());</span><br><span class="line">    BeanUtil.copyProperties(node, vendingMachine, <span class="string">&quot;id&quot;</span>);<span class="comment">// 商圈类型、区域、合作商</span></span><br><span class="line">    vendingMachine.setAddr(node.getAddress());<span class="comment">// 设备地址</span></span><br><span class="line">    vendingMachine.setUpdateTime(DateUtils.getNowDate());<span class="comment">// 更新时间</span></span><br><span class="line">    <span class="keyword">return</span> vendingMachineMapper.updateVendingMachine(vendingMachine);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="设备状态改造"><a href="#设备状态改造" class="headerlink" title="设备状态改造"></a>设备状态改造</h2><h3 id="创建视图组件"><a href="#创建视图组件" class="headerlink" title="创建视图组件"></a>创建视图组件</h3><p>创建vmStatus/index.vue视图组件</p>
<p><img src="image-20240711094001513.png" alt="image-20240711094001513"></p>
<h3 id="创建二级菜单"><a href="#创建二级菜单" class="headerlink" title="创建二级菜单"></a>创建二级菜单</h3><p><img src="image-20240626173707709.png" alt="image-20240626173707709"> <img src="image-20240626172011769.png" alt="image-20240626172011769"></p>
<h3 id="改造视图组件"><a href="#改造视图组件" class="headerlink" title="改造视图组件"></a>改造视图组件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;app-container&quot;&gt;</span><br><span class="line">    &lt;el-form :model=&quot;queryParams&quot; ref=&quot;queryRef&quot; :inline=&quot;true&quot; v-show=&quot;showSearch&quot; label-width=&quot;68px&quot;&gt;</span><br><span class="line">      &lt;el-form-item label=&quot;设备编号&quot; prop=&quot;innerCode&quot;&gt;</span><br><span class="line">        &lt;el-input</span><br><span class="line">          v-model=&quot;queryParams.innerCode&quot;</span><br><span class="line">          placeholder=&quot;请输入设备编号&quot;</span><br><span class="line">          clearable</span><br><span class="line">          @keyup.enter=&quot;handleQuery&quot;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/el-form-item&gt;</span><br><span class="line">      &lt;el-form-item&gt;</span><br><span class="line">        &lt;el-button type=&quot;primary&quot; icon=&quot;Search&quot; @click=&quot;handleQuery&quot;&gt;搜索&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button icon=&quot;Refresh&quot; @click=&quot;resetQuery&quot;&gt;重置&lt;/el-button&gt;</span><br><span class="line">      &lt;/el-form-item&gt;</span><br><span class="line">    &lt;/el-form&gt;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"> &lt;!-- 列表展示 --&gt;</span><br><span class="line">    &lt;el-table v-loading=&quot;loading&quot; :data=&quot;vmList&quot; @selection-change=&quot;handleSelectionChange&quot;&gt;</span><br><span class="line">      &lt;el-table-column label=&quot;序号&quot; type=&quot;index&quot; width=&quot;55&quot; align=&quot;center&quot; /&gt;</span><br><span class="line">      &lt;el-table-column label=&quot;设备编号&quot; align=&quot;center&quot; prop=&quot;innerCode&quot; /&gt;</span><br><span class="line">      &lt;el-table-column label=&quot;设备型号&quot; align=&quot;center&quot; prop=&quot;vmTypeId&quot; &gt;</span><br><span class="line">        &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">          &lt;div v-for=&quot;item in vmTypeList&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">            &lt;span v-if=&quot;item.id==scope.row.vmTypeId&quot;&gt;&#123;&#123; item.name &#125;&#125;&lt;/span&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column label=&quot;详细地址&quot; align=&quot;left&quot; prop=&quot;addr&quot; show-overflow-tooltip=&quot;true&quot;/&gt;</span><br><span class="line">      &lt;el-table-column label=&quot;运营状态&quot; align=&quot;center&quot; prop=&quot;vmStatus&quot;&gt;</span><br><span class="line">        &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">          &lt;dict-tag :options=&quot;vm_status&quot; :value=&quot;scope.row.vmStatus&quot;/&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column label=&quot;设备状态&quot; align=&quot;center&quot; prop=&quot;vmStatus&quot;&gt;</span><br><span class="line">        &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">         &#123;&#123; scope.row.runningStatus!=null? JSON.parse(scope.row.runningStatus).status==true?&#x27;正常&#x27;:&#x27;异常&#x27; :&#x27;异常&#x27;&#125;&#125;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column label=&quot;操作&quot; align=&quot;center&quot; class-name=&quot;small-padding fixed-width&quot;&gt;</span><br><span class="line">        &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">          &lt;el-button link type=&quot;primary&quot;  @click=&quot;getVmInfo(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:vm:query&#x27;]&quot;&gt;查看详情&lt;/el-button&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">    &lt;/el-table&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;pagination</span><br><span class="line">      v-show=&quot;total&gt;0&quot;</span><br><span class="line">      :total=&quot;total&quot;</span><br><span class="line">      v-model:page=&quot;queryParams.pageNum&quot;</span><br><span class="line">      v-model:limit=&quot;queryParams.pageSize&quot;</span><br><span class="line">      @pagination=&quot;getList&quot;</span><br><span class="line">    /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 添加或修改设备管理对话框 --&gt;</span><br><span class="line">    &lt;el-dialog :title=&quot;title&quot; v-model=&quot;open&quot; width=&quot;500px&quot; append-to-body&gt;</span><br><span class="line">    &lt;/el-dialog&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup name=&quot;Vm&quot;&gt;</span><br><span class="line">import &#123; listVm, getVm, delVm, addVm, updateVm &#125; from &quot;@/api/manage/vm&quot;;</span><br><span class="line">import&#123;listVmType&#125; from &quot;@/api/manage/vmType&quot;;</span><br><span class="line">import&#123;listPartner&#125; from &quot;@/api/manage/partner&quot;;</span><br><span class="line">import&#123;loadAllParams&#125; from &quot;@/api/page&quot;;</span><br><span class="line">import&#123;listNode&#125; from &quot;@/api/manage/node&quot;;</span><br><span class="line">import&#123;listRegion&#125; from &quot;@/api/manage/region&quot;;</span><br><span class="line">import &#123; ref &#125; from &quot;vue&quot;;</span><br><span class="line"></span><br><span class="line">const &#123; proxy &#125; = getCurrentInstance();</span><br><span class="line">const &#123; vm_status &#125; = proxy.useDict(&#x27;vm_status&#x27;);</span><br><span class="line"></span><br><span class="line">const vmList = ref([]);</span><br><span class="line">const open = ref(false);</span><br><span class="line">const loading = ref(true);</span><br><span class="line">const showSearch = ref(true);</span><br><span class="line">const ids = ref([]);</span><br><span class="line">const single = ref(true);</span><br><span class="line">const multiple = ref(true);</span><br><span class="line">const total = ref(0);</span><br><span class="line">const title = ref(&quot;&quot;);</span><br><span class="line"></span><br><span class="line">const data = reactive(&#123;</span><br><span class="line">  form: &#123;&#125;,</span><br><span class="line">  queryParams: &#123;</span><br><span class="line">    pageNum: 1,</span><br><span class="line">    pageSize: 10,</span><br><span class="line">    innerCode: null,</span><br><span class="line">    nodeId: null,</span><br><span class="line">    businessType: null,</span><br><span class="line">    regionId: null,</span><br><span class="line">    partnerId: null,</span><br><span class="line">    vmTypeId: null,</span><br><span class="line">    vmStatus: null,</span><br><span class="line">    runningStatus: null,</span><br><span class="line">    policyId: null,</span><br><span class="line">  &#125;,</span><br><span class="line">  rules: &#123;</span><br><span class="line">    nodeId: [</span><br><span class="line">      &#123; required: true, message: &quot;点位Id不能为空&quot;, trigger: &quot;blur&quot; &#125;</span><br><span class="line">    ],</span><br><span class="line">    vmTypeId: [</span><br><span class="line">      &#123; required: true, message: &quot;设备型号不能为空&quot;, trigger: &quot;blur&quot; &#125;</span><br><span class="line">    ],</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const &#123; queryParams, form, rules &#125; = toRefs(data);</span><br><span class="line"></span><br><span class="line">/** 查询设备管理列表 */</span><br><span class="line">function getList() &#123;</span><br><span class="line">  loading.value = true;</span><br><span class="line">  listVm(queryParams.value).then(response =&gt; &#123;</span><br><span class="line">    vmList.value = response.rows;</span><br><span class="line">    total.value = response.total;</span><br><span class="line">    loading.value = false;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 取消按钮</span><br><span class="line">function cancel() &#123;</span><br><span class="line">  open.value = false;</span><br><span class="line">  reset();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 表单重置</span><br><span class="line">function reset() &#123;</span><br><span class="line">  form.value = &#123;</span><br><span class="line">    id: null,</span><br><span class="line">    innerCode: null,</span><br><span class="line">    channelMaxCapacity: null,</span><br><span class="line">    nodeId: null,</span><br><span class="line">    addr: null,</span><br><span class="line">    lastSupplyTime: null,</span><br><span class="line">    businessType: null,</span><br><span class="line">    regionId: null,</span><br><span class="line">    partnerId: null,</span><br><span class="line">    vmTypeId: null,</span><br><span class="line">    vmStatus: null,</span><br><span class="line">    runningStatus: null,</span><br><span class="line">    longitudes: null,</span><br><span class="line">    latitude: null,</span><br><span class="line">    clientId: null,</span><br><span class="line">    policyId: null,</span><br><span class="line">    createTime: null,</span><br><span class="line">    updateTime: null</span><br><span class="line">  &#125;;</span><br><span class="line">  proxy.resetForm(&quot;vmRef&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/** 搜索按钮操作 */</span><br><span class="line">function handleQuery() &#123;</span><br><span class="line">  queryParams.value.pageNum = 1;</span><br><span class="line">  getList();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/** 重置按钮操作 */</span><br><span class="line">function resetQuery() &#123;</span><br><span class="line">  proxy.resetForm(&quot;queryRef&quot;);</span><br><span class="line">  handleQuery();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 多选框选中数据</span><br><span class="line">function handleSelectionChange(selection) &#123;</span><br><span class="line">  ids.value = selection.map(item =&gt; item.id);</span><br><span class="line">  single.value = selection.length != 1;</span><br><span class="line">  multiple.value = !selection.length;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/** 新增按钮操作 */</span><br><span class="line">function handleAdd() &#123;</span><br><span class="line">  reset();</span><br><span class="line">  open.value = true;</span><br><span class="line">  title.value = &quot;添加设备管理&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/** 修改按钮操作 */</span><br><span class="line">function getVmInfo(row) &#123;</span><br><span class="line">  reset();</span><br><span class="line">  const _id = row.id || ids.value</span><br><span class="line">  getVm(_id).then(response =&gt; &#123;</span><br><span class="line">    form.value = response.data;</span><br><span class="line">    open.value = true;</span><br><span class="line">    title.value = &quot;设备详情&quot;;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/** 提交按钮 */</span><br><span class="line">function submitForm() &#123;</span><br><span class="line">  proxy.$refs[&quot;vmRef&quot;].validate(valid =&gt; &#123;</span><br><span class="line">    if (valid) &#123;</span><br><span class="line">      if (form.value.id != null) &#123;</span><br><span class="line">        updateVm(form.value).then(response =&gt; &#123;</span><br><span class="line">          proxy.$modal.msgSuccess(&quot;修改成功&quot;);</span><br><span class="line">          open.value = false;</span><br><span class="line">          getList();</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        addVm(form.value).then(response =&gt; &#123;</span><br><span class="line">          proxy.$modal.msgSuccess(&quot;新增成功&quot;);</span><br><span class="line">          open.value = false;</span><br><span class="line">          getList();</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/** 删除按钮操作 */</span><br><span class="line">function handleDelete(row) &#123;</span><br><span class="line">  const _ids = row.id || ids.value;</span><br><span class="line">  proxy.$modal.confirm(&#x27;是否确认删除设备管理编号为&quot;&#x27; + _ids + &#x27;&quot;的数据项？&#x27;).then(function() &#123;</span><br><span class="line">    return delVm(_ids);</span><br><span class="line">  &#125;).then(() =&gt; &#123;</span><br><span class="line">    getList();</span><br><span class="line">    proxy.$modal.msgSuccess(&quot;删除成功&quot;);</span><br><span class="line">  &#125;).catch(() =&gt; &#123;&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/** 导出按钮操作 */</span><br><span class="line">function handleExport() &#123;</span><br><span class="line">  proxy.download(&#x27;manage/vm/export&#x27;, &#123;</span><br><span class="line">    ...queryParams.value</span><br><span class="line">  &#125;, `vm_$&#123;new Date().getTime()&#125;.xlsx`)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 查询设备类型列表 */</span><br><span class="line">const vmTypeList=ref([]);</span><br><span class="line">function getVmTypeList() &#123;</span><br><span class="line">  listVmType(loadAllParams).then(response =&gt; &#123;</span><br><span class="line">    vmTypeList.value = response.rows;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 查询合作商列表 */</span><br><span class="line">const partnerList=ref([]);</span><br><span class="line">function getPartnerList() &#123;</span><br><span class="line">  listPartner(loadAllParams).then(response =&gt; &#123;</span><br><span class="line">    partnerList.value = response.rows;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 查询点位列表 */</span><br><span class="line">const nodeList=ref([]);</span><br><span class="line">function getNodeList() &#123;</span><br><span class="line">  listNode(loadAllParams).then(response =&gt; &#123;</span><br><span class="line">    nodeList.value = response.rows;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 查询区域列表 */</span><br><span class="line">const regionList=ref([]);</span><br><span class="line">function getRegionList() &#123;</span><br><span class="line">  listRegion(loadAllParams).then(response =&gt; &#123;</span><br><span class="line">    regionList.value = response.rows;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">getRegionList();</span><br><span class="line">getNodeList();</span><br><span class="line">getPartnerList();</span><br><span class="line">getVmTypeList();</span><br><span class="line">getList();</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h2 id="点位查看详情"><a href="#点位查看详情" class="headerlink" title="点位查看详情"></a>点位查看详情</h2><p>在node/index.vue视图组件中修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-button link type=&quot;primary&quot; @click=&quot;getNodeInfo(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:vm:list&#x27;]&quot;&gt;查看详情&lt;/el-button&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 点位详情对话框 --&gt;</span><br><span class="line">&lt;el-dialog title=&quot;点位详情&quot; v-model=&quot;nodeOpen&quot; width=&quot;600px&quot; append-to-body&gt;</span><br><span class="line">  &lt;el-table :data=&quot;vmList&quot;&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;序号&quot; type=&quot;index&quot; width=&quot;80&quot; align=&quot;center&quot; prop=&quot;id&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;设备编号&quot; align=&quot;center&quot; prop=&quot;innerCode&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;设备状态&quot; align=&quot;center&quot; prop=&quot;vmStatus&quot;&gt;</span><br><span class="line">      &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">        &lt;dict-tag :options=&quot;vm_status&quot; :value=&quot;scope.row.vmStatus&quot; /&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/el-table-column&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;最后一次供货时间&quot; align=&quot;center&quot; prop=&quot;lastSupplyTime&quot; width=&quot;180&quot;&gt;</span><br><span class="line">      &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">        &lt;span&gt;&#123;&#123; parseTime(scope.row.lastSupplyTime, &#x27;&#123;y&#125;-&#123;m&#125;-&#123;d&#125; &#123;h&#125;:&#123;i&#125;:&#123;s&#125;&#x27;) &#125;&#125;&lt;/span&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/el-table-column&gt;</span><br><span class="line">  &lt;/el-table&gt;</span><br><span class="line">&lt;/el-dialog&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script setup name=&quot;Node&quot;&gt;</span><br><span class="line">import &#123; listVm &#125; from &quot;@/api/manage/vm&quot;;</span><br><span class="line">/* 引入设备状态数据字典 */</span><br><span class="line">const &#123; vm_status &#125; = proxy.useDict(&#x27;vm_status&#x27;);</span><br><span class="line">    </span><br><span class="line">/* 查看详情 */</span><br><span class="line">const nodeOpen = ref(false);</span><br><span class="line">const vmList = ref([]);</span><br><span class="line">function getNodeInfo(row) &#123;</span><br><span class="line">  // 根据点位id，查询设备列表</span><br><span class="line">  loadAllParams.nodeId = row.id;</span><br><span class="line">  listVm(loadAllParams).then(response =&gt; &#123;</span><br><span class="line">    vmList.value = response.rows;</span><br><span class="line">    nodeOpen.value = true;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h1 id="策略管理"><a href="#策略管理" class="headerlink" title="策略管理"></a>策略管理</h1><h2 id="需求说明-3"><a href="#需求说明-3" class="headerlink" title="需求说明"></a>需求说明</h2><p>策略管理主要涉及到二个功能模块，业务流程如下：</p>
<ol>
<li><strong>新增策略</strong>: 允许管理员定义新的策略，包括策略的具体内容和参数（如折扣率）</li>
<li><strong>策略分配</strong>: 将策略分配给一个或多个售货机。</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">    A[登录系统] </span><br><span class="line">    A --&gt; B[新增策略]</span><br><span class="line">    B --&gt; C[策略分配]</span><br></pre></td></tr></table></figure>
<p>对于策略和其他管理数据，下面是示意图：</p>
<ul>
<li>关系字段：policy_id</li>
</ul>
<p><img src="image-20240630100722719.png" alt="image-20240630100722719"></p>
<h2 id="生成基础代码-3"><a href="#生成基础代码-3" class="headerlink" title="生成基础代码"></a>生成基础代码</h2><h3 id="需求-13"><a href="#需求-13" class="headerlink" title="需求"></a>需求</h3><p>使用若依代码生成器，生成策略管理前后端基础代码，并导入到项目中：</p>
<p><img src="image-20240630102454674.png" alt="image-20240630102454674"></p>
<h3 id="步骤-3"><a href="#步骤-3" class="headerlink" title="步骤"></a>步骤</h3><h4 id="①创建目录菜单-3"><a href="#①创建目录菜单-3" class="headerlink" title="①创建目录菜单"></a>①创建目录菜单</h4><p>创建策略管理目录菜单</p>
<p><img src="image-20240630100852212.png" alt="image-20240630100852212">  </p>
<h4 id="②配置代码生成信息"><a href="#②配置代码生成信息" class="headerlink" title="②配置代码生成信息"></a>②配置代码生成信息</h4><p>导入策略表</p>
<p><img src="image-20240630101015020.png" alt="image-20240630101015020">  </p>
<p>配置策略表（参考原型）</p>
<p><img src="image-20240630101043469.png" alt="image-20240630101043469">  </p>
<p><img src="image-20240630103023330.png" alt="image-20240630103023330"></p>
<p><img src="image-20240630101224680.png" alt="image-20240630101224680"></p>
<h4 id="③下载代码并导入项目"><a href="#③下载代码并导入项目" class="headerlink" title="③下载代码并导入项目"></a>③下载代码并导入项目</h4><p>选中策略表生成下载</p>
<p> <img src="image-20240630102002000.png" alt="image-20240630102002000"></p>
<p>解压<code>ruoyi.zip</code>得到前后端代码和动态菜单sql</p>
<p><img src="image-20240630102039555.png" alt="image-20240630102039555">  </p>
<p>代码导入</p>
<p> <img src="image-20240630102317850.png" alt="image-20240630102317850"> <img src="image-20240630102423801.png" alt="image-20240630102423801"></p>
<h2 id="策略管理改造"><a href="#策略管理改造" class="headerlink" title="策略管理改造"></a>策略管理改造</h2><h3 id="基础页面-6"><a href="#基础页面-6" class="headerlink" title="基础页面"></a>基础页面</h3><h4 id="需求-14"><a href="#需求-14" class="headerlink" title="需求"></a>需求</h4><p>参考页面原型，完成基础布局展示改造</p>
<p><img src="image-20240630102546807.png" alt="image-20240630102546807"></p>
<h4 id="代码实现-6"><a href="#代码实现-6" class="headerlink" title="代码实现"></a>代码实现</h4><p>在policy/index.vue视图组件中修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 列表展示 --&gt;</span><br><span class="line">&lt;el-table v-loading=&quot;loading&quot; :data=&quot;policyList&quot; @selection-change=&quot;handleSelectionChange&quot;&gt;</span><br><span class="line">  &lt;el-table-column type=&quot;selection&quot; width=&quot;55&quot; align=&quot;center&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;序号&quot; type=&quot;index&quot; width=&quot;50&quot; align=&quot;center&quot; prop=&quot;policyId&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;策略名称&quot; align=&quot;center&quot; prop=&quot;policyName&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;策略方案&quot; align=&quot;center&quot; prop=&quot;discount&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;创建时间&quot; align=&quot;center&quot; prop=&quot;createTime&quot; width=&quot;180&quot;&gt;</span><br><span class="line">    &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">      &lt;span&gt;&#123;&#123; parseTime(scope.row.createTime, &#x27;&#123;y&#125;-&#123;m&#125;-&#123;d&#125; &#123;h&#125;:&#123;i&#125;:&#123;s&#125;&#x27;) &#125;&#125;&lt;/span&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/el-table-column&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;操作&quot; align=&quot;center&quot; class-name=&quot;small-padding fixed-width&quot;&gt;</span><br><span class="line">    &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">      &lt;el-button link type=&quot;primary&quot;  @click=&quot;handleUpdate(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:policy:edit&#x27;]&quot;&gt;修改&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button link type=&quot;primary&quot;  @click=&quot;handleDelete(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:policy:remove&#x27;]&quot;&gt;删除&lt;/el-button&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/el-table-column&gt;</span><br><span class="line">&lt;/el-table&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;!-- 添加或修改策略管理对话框 --&gt;</span><br><span class="line">&lt;el-dialog :title=&quot;title&quot; v-model=&quot;open&quot; width=&quot;500px&quot; append-to-body&gt;</span><br><span class="line">  &lt;el-form ref=&quot;policyRef&quot; :model=&quot;form&quot; :rules=&quot;rules&quot; label-width=&quot;80px&quot;&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;策略名称&quot; prop=&quot;policyName&quot;&gt;</span><br><span class="line">      &lt;el-input v-model=&quot;form.policyName&quot; placeholder=&quot;请输入策略名称&quot; /&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;策略方案&quot; prop=&quot;discount&quot;&gt;</span><br><span class="line">     &lt;el-input-number :min=&quot;1&quot; :max=&quot;100&quot; :precision=&quot;0&quot; v-model=&quot;form.discount&quot; placeholder=&quot;请输入策略&quot; /&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">  &lt;/el-form&gt;</span><br><span class="line">  &lt;template #footer&gt;</span><br><span class="line">    &lt;div class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">      &lt;el-button type=&quot;primary&quot; @click=&quot;submitForm&quot;&gt;确 定&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button @click=&quot;cancel&quot;&gt;取 消&lt;/el-button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/template&gt;</span><br><span class="line">&lt;/el-dialog&gt;</span><br></pre></td></tr></table></figure>
<h3 id="查看详情-1"><a href="#查看详情-1" class="headerlink" title="查看详情"></a>查看详情</h3><h4 id="需求-15"><a href="#需求-15" class="headerlink" title="需求"></a>需求</h4><p>点击查看详情，展示策略名称和该策略下的设备列表</p>
<p><img src="image-20240630103824304.png" alt="image-20240630103824304"></p>
<h4 id="代码实现-7"><a href="#代码实现-7" class="headerlink" title="代码实现"></a>代码实现</h4><p>在policy/index.vue视图组件中修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-button link type=&quot;primary&quot;  @click=&quot;getPolicyInfo(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:vm:list&#x27;]&quot;&gt;查看详情&lt;/el-button&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 策略详情对话框 --&gt;</span><br><span class="line">&lt;el-dialog v-model=&quot;policyOpen&quot; title=&quot;策略详情&quot; width=&quot;500px&quot;&gt;</span><br><span class="line">  &lt;el-form-item label=&quot;策略名称&quot; prop=&quot;policyName&quot;&gt;</span><br><span class="line">    &lt;el-input v-model=&quot;form.policyName&quot; placeholder=&quot;请输入策略名称&quot; disabled /&gt;</span><br><span class="line">  &lt;/el-form-item&gt;</span><br><span class="line">  &lt;label&gt;包含设备：&lt;/label&gt;</span><br><span class="line">  &lt;el-table :data=&quot;vmList&quot;&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;序号&quot; type=&quot;index&quot; width=&quot;80&quot; align=&quot;center&quot; prop=&quot;id&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;点位地址&quot; align=&quot;left&quot; prop=&quot;addr&quot; show-overflow-tooltip /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;设备编号&quot; align=&quot;center&quot; prop=&quot;innerCode&quot; /&gt;</span><br><span class="line">  &lt;/el-table&gt;</span><br><span class="line">&lt;/el-dialog&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup name=&quot;Policy&quot;&gt;</span><br><span class="line">import &#123; listVm &#125; from &quot;@/api/manage/vm&quot;;</span><br><span class="line">import &#123; loadAllParams &#125; from &quot;@/api/page&quot;;</span><br><span class="line">    </span><br><span class="line">/* 查看策略详情 */</span><br><span class="line">const policyOpen = ref(false);</span><br><span class="line">const vmList = ref([]);</span><br><span class="line">function getPolicyInfo(row) &#123;</span><br><span class="line">  //1. 获取策略信息</span><br><span class="line">  form.value = row;</span><br><span class="line">  //2. 根据策略id，查询设备列表</span><br><span class="line">  loadAllParams.policyId = row.policyId;</span><br><span class="line">  listVm(loadAllParams).then(response =&gt; &#123;</span><br><span class="line">    vmList.value = response.rows;</span><br><span class="line">    policyOpen.value = true;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h2 id="设备策略分配"><a href="#设备策略分配" class="headerlink" title="设备策略分配"></a>设备策略分配</h2><h3 id="需求-16"><a href="#需求-16" class="headerlink" title="需求"></a>需求</h3><p>在设备管理页面中点击策略，对设备设置一个固定折扣，用于营销作用</p>
<p><img src="image-20240630104801234.png" alt="image-20240630104801234"></p>
<h3 id="代码实现-8"><a href="#代码实现-8" class="headerlink" title="代码实现"></a>代码实现</h3><p>在vm/index.vue视图组件中修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-button link type=&quot;primary&quot; @click=&quot;handleUpdatePolicy(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:vm:edit&#x27;]&quot;&gt;策略&lt;/el-button&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 策略管理对话框 --&gt;</span><br><span class="line">&lt;el-dialog title=&quot;策略管理&quot; v-model=&quot;policyOpen&quot; width=&quot;500px&quot; append-to-body&gt;</span><br><span class="line">  &lt;el-form ref=&quot;vmRef&quot; :model=&quot;form&quot; label-width=&quot;80px&quot;&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;策略&quot; prop=&quot;policyId&quot;&gt;</span><br><span class="line">      &lt;el-select v-model=&quot;form.policyId&quot; placeholder=&quot;请选择策略&quot;&gt;</span><br><span class="line">        &lt;el-option v-for=&quot;item in policyList&quot; :key=&quot;item.policyId&quot; :label=&quot;item.policyName&quot;</span><br><span class="line">          :value=&quot;item.policyId&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">      &lt;/el-select&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">  &lt;/el-form&gt;</span><br><span class="line">  &lt;template #footer&gt;</span><br><span class="line">    &lt;div class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">      &lt;el-button type=&quot;primary&quot; @click=&quot;submitForm&quot;&gt;确 定&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button @click=&quot;cancel&quot;&gt;取 消&lt;/el-button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/template&gt;</span><br><span class="line">&lt;/el-dialog&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup name=&quot;Vm&quot;&gt;</span><br><span class="line">import &#123; listPolicy &#125; from &#x27;@/api/manage/policy&#x27;;</span><br><span class="line">    </span><br><span class="line">// 取消按钮</span><br><span class="line">function cancel() &#123;</span><br><span class="line">  open.value = false;</span><br><span class="line">  policyOpen.value=false; // 关闭策略对话框</span><br><span class="line">  reset();</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">/** 提交按钮 */</span><br><span class="line">function submitForm() &#123;</span><br><span class="line">  proxy.$refs[&quot;vmRef&quot;].validate(valid =&gt; &#123;</span><br><span class="line">    if (valid) &#123;</span><br><span class="line">      if (form.value.id != null) &#123;</span><br><span class="line">        updateVm(form.value).then(response =&gt; &#123;</span><br><span class="line">          proxy.$modal.msgSuccess(&quot;修改成功&quot;);</span><br><span class="line">          open.value = false;</span><br><span class="line">           </span><br><span class="line">          getList();</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        addVm(form.value).then(response =&gt; &#123;</span><br><span class="line">          proxy.$modal.msgSuccess(&quot;新增成功&quot;);</span><br><span class="line">          open.value = false;</span><br><span class="line">          getList();</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">/* 设备策略分配 */</span><br><span class="line">const policyList = ref([]);</span><br><span class="line">const policyOpen = ref(false);</span><br><span class="line">function handleUpdatePolicy(row) &#123;</span><br><span class="line">  //1. 为表单赋值设备id和策略id</span><br><span class="line">  form.value.id = row.id;</span><br><span class="line">  form.value.policyId = row.policyId;</span><br><span class="line">  //2. 查询策略列表</span><br><span class="line">  listPolicy(loadAllParams).then((response) =&gt; &#123;</span><br><span class="line">    policyList.value = response.rows;</span><br><span class="line">    policyOpen.value = true;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>在VendingMachineServiceImpl中修改</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 修改设备管理</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> vendingMachine 设备管理</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">updateVendingMachine</span><span class="params">(VendingMachine vendingMachine)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (vendingMachine.getNodeId()!=<span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// 查询点位表，补充：区域、点位、合作商等信息</span></span><br><span class="line">        <span class="type">Node</span> <span class="variable">node</span> <span class="operator">=</span> nodeService.selectNodeById(vendingMachine.getNodeId());</span><br><span class="line">        BeanUtil.copyProperties(node,vendingMachine,<span class="string">&quot;id&quot;</span>);<span class="comment">// 商圈类型、区域、合作商</span></span><br><span class="line">        vendingMachine.setAddr(node.getAddress());<span class="comment">// 设备地址</span></span><br><span class="line">    &#125;</span><br><span class="line">    vendingMachine.setUpdateTime(DateUtils.getNowDate());<span class="comment">// 更新时间</span></span><br><span class="line">    <span class="keyword">return</span> vendingMachineMapper.updateVendingMachine(vendingMachine);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="商品管理"><a href="#商品管理" class="headerlink" title="商品管理"></a>商品管理</h1><h2 id="需求说明-4"><a href="#需求说明-4" class="headerlink" title="需求说明"></a>需求说明</h2><p>点位管理主要涉及到三个功能模块，业务流程如下：</p>
<ol>
<li><strong>新增商品类型</strong>: 定义商品的不同分类，如饮料、零食、日用品等。</li>
<li><strong>新增商品</strong>: 添加新的商品信息，包括名称、规格、价格、类型等。</li>
<li><strong>设备货道管理</strong>: 将商品与售货机的货道关联，管理每个货道的商品信息。</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">    A[登录系统] </span><br><span class="line">    A --&gt; B[新增商品类型]</span><br><span class="line">    B --&gt; C[新增商品]</span><br><span class="line">    C --&gt; D[货道关联商品]</span><br></pre></td></tr></table></figure>
<p>对于商品和其他管理数据，下面是示意图：</p>
<ul>
<li>关系字段：class_id、sku_id、vm_id</li>
</ul>
<p><img src="image-20240630110417850.png" alt="image-20240630110417850"></p>
<h2 id="生成基础代码-4"><a href="#生成基础代码-4" class="headerlink" title="生成基础代码"></a>生成基础代码</h2><h3 id="需求-17"><a href="#需求-17" class="headerlink" title="需求"></a>需求</h3><p>使用若依代码生成器，生成商品类型、商品管理前后端基础代码，并导入到项目中： <img src="image-20240630122651738.png" alt="image-20240630122651738"></p>
<h3 id="步骤-4"><a href="#步骤-4" class="headerlink" title="步骤"></a>步骤</h3><h4 id="①创建目录菜单-4"><a href="#①创建目录菜单-4" class="headerlink" title="①创建目录菜单"></a>①创建目录菜单</h4><p>创建商品管理目录菜单</p>
<p><img src="image-20240630121056783.png" alt="image-20240630121056783"></p>
<h4 id="②配置代码生成信息-1"><a href="#②配置代码生成信息-1" class="headerlink" title="②配置代码生成信息"></a>②配置代码生成信息</h4><p>导入二张表</p>
<p><img src="image-20240630121143428.png" alt="image-20240630121143428"></p>
<p>配置商品类型表（参考原型）</p>
<p><img src="image-20240630121215844.png" alt="image-20240630121215844"></p>
<p><img src="image-20240630121329378.png" alt="image-20240630121329378"></p>
<p><img src="image-20240630121558343.png" alt="image-20240630121558343"></p>
<p>配置商品表（参考原型）</p>
<p><img src="image-20240630121430008.png" alt="image-20240630121430008"></p>
<p><img src="image-20240630122047727.png" alt="image-20240630122047727"></p>
<p><img src="image-20240630122122679.png" alt="image-20240630122122679"></p>
<h4 id="③下载代码并导入项目-1"><a href="#③下载代码并导入项目-1" class="headerlink" title="③下载代码并导入项目"></a>③下载代码并导入项目</h4><p>选中商品表和商品类型表生成下载</p>
<p><img src="image-20240630122221412.png" alt="image-20240630122221412">  </p>
<p>解压<code>ruoyi.zip</code>得到前后端代码和动态菜单sql</p>
<p><img src="image-20240630122248478.png" alt="image-20240630122248478"></p>
<p>代码导入</p>
<p>  <img src="image-20240630122353216.png" alt="image-20240630122353216"> <img src="image-20240630122424605.png" alt="image-20240630122424605"> <img src="image-20240630122616266.png" alt="image-20240630122616266"></p>
<h2 id="商品类型改造"><a href="#商品类型改造" class="headerlink" title="商品类型改造"></a>商品类型改造</h2><h3 id="基础页面-7"><a href="#基础页面-7" class="headerlink" title="基础页面"></a>基础页面</h3><h4 id="需求-18"><a href="#需求-18" class="headerlink" title="需求"></a>需求</h4><p>参考页面原型，完成基础布局展示改造</p>
<p><img src="image-20240630122749105.png" alt="image-20240630122749105"></p>
<h4 id="代码实现-9"><a href="#代码实现-9" class="headerlink" title="代码实现"></a>代码实现</h4><p>在skuClass/index.vue视图组件中修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 列表展示 --&gt;</span><br><span class="line">&lt;el-table v-loading=&quot;loading&quot; :data=&quot;skuClassList&quot; @selection-change=&quot;handleSelectionChange&quot;&gt;</span><br><span class="line">  &lt;el-table-column type=&quot;selection&quot; width=&quot;55&quot; align=&quot;center&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;序号&quot; type=&quot;index&quot; width=&quot;50&quot; align=&quot;center&quot; prop=&quot;classId&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;商品类型&quot; align=&quot;center&quot; prop=&quot;className&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;操作&quot; align=&quot;center&quot; class-name=&quot;small-padding fixed-width&quot;&gt;</span><br><span class="line">    &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">      &lt;el-button link type=&quot;primary&quot;  @click=&quot;handleUpdate(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:skuClass:edit&#x27;]&quot;&gt;修改&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button link type=&quot;primary&quot;  @click=&quot;handleDelete(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:skuClass:remove&#x27;]&quot;&gt;删除&lt;/el-button&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/el-table-column&gt;</span><br><span class="line">&lt;/el-table&gt;</span><br></pre></td></tr></table></figure>
<p>修改全局异常处理器，添加以下内容</p>
<p><img src="image-20240526220314397.png" alt="image-20240526220314397"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 数据完整性异常</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@ExceptionHandler(DataIntegrityViolationException.class)</span></span><br><span class="line"><span class="keyword">public</span> AjaxResult <span class="title function_">handelDataIntegrityViolationException</span><span class="params">(DataIntegrityViolationException e)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (e.getMessage().contains(<span class="string">&quot;foreign&quot;</span>)) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> AjaxResult.error(<span class="string">&quot;无法删除，有其他数据引用&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(e.getMessage().contains(<span class="string">&quot;Duplicate&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">return</span> AjaxResult.error(<span class="string">&quot;无法保存，名称已存在&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> AjaxResult.error(<span class="string">&quot;数据完整性异常，请联系管理员&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="商品管理改造"><a href="#商品管理改造" class="headerlink" title="商品管理改造"></a>商品管理改造</h2><h3 id="基础页面-8"><a href="#基础页面-8" class="headerlink" title="基础页面"></a>基础页面</h3><h4 id="需求-19"><a href="#需求-19" class="headerlink" title="需求"></a>需求</h4><p>参考页面原型，完成基础布局展示改造</p>
<p><img src="image-20240630125831347.png" alt="image-20240630125831347"></p>
<h4 id="代码实现-10"><a href="#代码实现-10" class="headerlink" title="代码实现"></a>代码实现</h4><p>在sku/index.vue视图组件中修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 查询条件 --&gt;</span><br><span class="line">&lt;el-form :model=&quot;queryParams&quot; ref=&quot;queryRef&quot; :inline=&quot;true&quot; v-show=&quot;showSearch&quot; label-width=&quot;68px&quot;&gt;</span><br><span class="line">  &lt;el-form-item label=&quot;商品名称&quot; prop=&quot;skuName&quot;&gt;</span><br><span class="line">    &lt;el-input v-model=&quot;queryParams.skuName&quot; placeholder=&quot;请输入商品名称&quot; clearable @keyup.enter=&quot;handleQuery&quot; /&gt;</span><br><span class="line">  &lt;/el-form-item&gt;</span><br><span class="line">  &lt;el-form-item&gt;</span><br><span class="line">    &lt;el-button type=&quot;primary&quot; icon=&quot;Search&quot; @click=&quot;handleQuery&quot;&gt;搜索&lt;/el-button&gt;</span><br><span class="line">    &lt;el-button icon=&quot;Refresh&quot; @click=&quot;resetQuery&quot;&gt;重置&lt;/el-button&gt;</span><br><span class="line">  &lt;/el-form-item&gt;</span><br><span class="line">&lt;/el-form&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 列表展示 --&gt;</span><br><span class="line">&lt;el-table v-loading=&quot;loading&quot; :data=&quot;skuList&quot; @selection-change=&quot;handleSelectionChange&quot;&gt;</span><br><span class="line">  &lt;el-table-column type=&quot;selection&quot; width=&quot;55&quot; align=&quot;center&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;序号&quot; type=&quot;index&quot; width=&quot;50&quot; align=&quot;center&quot; prop=&quot;skuId&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;商品名称&quot; align=&quot;center&quot; prop=&quot;skuName&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;商品图片&quot; align=&quot;center&quot; prop=&quot;skuImage&quot; width=&quot;100&quot;&gt;</span><br><span class="line">    &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">      &lt;image-preview :src=&quot;scope.row.skuImage&quot; :width=&quot;50&quot; :height=&quot;50&quot; /&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/el-table-column&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;品牌&quot; align=&quot;center&quot; prop=&quot;brandName&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;规格&quot; align=&quot;center&quot; prop=&quot;unit&quot; /&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;商品价格&quot; align=&quot;center&quot; prop=&quot;price&quot; &gt;</span><br><span class="line">    &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">          &lt;el-tag&gt;&#123;&#123; scope.row.price / 100 &#125;&#125;元&lt;/el-tag&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/el-table-column&gt; </span><br><span class="line">  &lt;el-table-column label=&quot;商品类型&quot; align=&quot;center&quot; prop=&quot;classId&quot;&gt;</span><br><span class="line">    &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">      &lt;div v-for=&quot;item in skuClassList&quot; :key=&quot;item.classI&quot;&gt;</span><br><span class="line">        &lt;span v-if=&quot;item.classId == scope.row.classId&quot;&gt;&#123;&#123; item.className &#125;&#125;&lt;/span&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/el-table-column&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;创建时间&quot; align=&quot;center&quot; prop=&quot;createTime&quot; width=&quot;180&quot;&gt;</span><br><span class="line">    &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">      &lt;span&gt;&#123;&#123; parseTime(scope.row.createTime, &#x27;&#123;y&#125;-&#123;m&#125;-&#123;d&#125; &#123;h&#125;:&#123;i&#125;:&#123;s&#125;&#x27;) &#125;&#125;&lt;/span&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/el-table-column&gt;</span><br><span class="line">  &lt;el-table-column label=&quot;操作&quot; align=&quot;center&quot; class-name=&quot;small-padding fixed-width&quot;&gt;</span><br><span class="line">    &lt;template #default=&quot;scope&quot;&gt;</span><br><span class="line">      &lt;el-button link type=&quot;primary&quot; @click=&quot;handleUpdate(scope.row)&quot;</span><br><span class="line">        v-hasPermi=&quot;[&#x27;manage:sku:edit&#x27;]&quot;&gt;修改&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button link type=&quot;primary&quot; @click=&quot;handleDelete(scope.row)&quot;</span><br><span class="line">        v-hasPermi=&quot;[&#x27;manage:sku:remove&#x27;]&quot;&gt;删除&lt;/el-button&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/el-table-column&gt;</span><br><span class="line">&lt;/el-table&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 添加或修改商品管理对话框 --&gt;</span><br><span class="line">&lt;el-dialog :title=&quot;title&quot; v-model=&quot;open&quot; width=&quot;500px&quot; append-to-body&gt;</span><br><span class="line">  &lt;el-form ref=&quot;skuRef&quot; :model=&quot;form&quot; :rules=&quot;rules&quot; label-width=&quot;80px&quot;&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;商品名称&quot; prop=&quot;skuName&quot;&gt;</span><br><span class="line">      &lt;el-input v-model=&quot;form.skuName&quot; placeholder=&quot;请输入商品名称&quot; /&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;品牌&quot; prop=&quot;brandName&quot;&gt;</span><br><span class="line">      &lt;el-input v-model=&quot;form.brandName&quot; placeholder=&quot;请输入品牌&quot; /&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;商品价格&quot; prop=&quot;price&quot;&gt;</span><br><span class="line">      &lt;el-input-number :min=&quot;0.01&quot; :max=&quot;999.99&quot; :precision=&quot;2&quot; :step=&quot;0.5&quot;   v-model=&quot;form.price&quot; placeholder=&quot;请输入&quot; /&gt;元</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;商品类型&quot; prop=&quot;classId&quot;&gt;</span><br><span class="line">      &lt;!-- &lt;el-input v-model=&quot;form.classId&quot; placeholder=&quot;请输入商品类型Id&quot; /&gt; --&gt;</span><br><span class="line">      &lt;el-select v-model=&quot;form.classId&quot; placeholder=&quot;请选择商品类型&quot;&gt;</span><br><span class="line">        &lt;el-option</span><br><span class="line">          v-for=&quot;item in skuClassList&quot;</span><br><span class="line">          :key=&quot;item.classId&quot;</span><br><span class="line">          :label=&quot;item.className&quot;</span><br><span class="line">          :value=&quot;item.classId&quot;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/el-select&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;规格&quot; prop=&quot;unit&quot;&gt;</span><br><span class="line">      &lt;el-input v-model=&quot;form.unit&quot; placeholder=&quot;请输入规格&quot; /&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;商品图片&quot; prop=&quot;skuImage&quot;&gt;</span><br><span class="line">      &lt;image-upload v-model=&quot;form.skuImage&quot; /&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">  &lt;/el-form&gt;</span><br><span class="line">  &lt;template #footer&gt;</span><br><span class="line">    &lt;div class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">      &lt;el-button type=&quot;primary&quot; @click=&quot;submitForm&quot;&gt;确 定&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button @click=&quot;cancel&quot;&gt;取 消&lt;/el-button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/template&gt;</span><br><span class="line">&lt;/el-dialog&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup name=&quot;Sku&quot;&gt;</span><br><span class="line">import &#123; listSkuClass &#125; from &quot;@/api/manage/skuClass&quot;;</span><br><span class="line">import &#123; loadAllParams &#125; from &quot;@/api/page&quot;;</span><br><span class="line">/** 修改按钮操作 */</span><br><span class="line">function handleUpdate(row) &#123;</span><br><span class="line">  reset();</span><br><span class="line">  const _skuId = row.skuId || ids.value</span><br><span class="line">  getSku(_skuId).then(response =&gt; &#123;</span><br><span class="line">    form.value = response.data;</span><br><span class="line">    form.value.price/=100;</span><br><span class="line">    open.value = true;</span><br><span class="line">    title.value = &quot;修改商品管理&quot;;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">/** 提交按钮 */</span><br><span class="line">function submitForm() &#123;</span><br><span class="line">  proxy.$refs[&quot;skuRef&quot;].validate(valid =&gt; &#123;</span><br><span class="line">    if (valid) &#123;</span><br><span class="line">      // 将价格单位从元转换回分</span><br><span class="line">      form.value.price*=100;</span><br><span class="line">      if (form.value.skuId != null) &#123;</span><br><span class="line">        updateSku(form.value).then(response =&gt; &#123;</span><br><span class="line">          proxy.$modal.msgSuccess(&quot;修改成功&quot;);</span><br><span class="line">          open.value = false;</span><br><span class="line">          getList();</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        addSku(form.value).then(response =&gt; &#123;</span><br><span class="line">          proxy.$modal.msgSuccess(&quot;新增成功&quot;);</span><br><span class="line">          open.value = false;</span><br><span class="line">          getList();</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">/* 查询商品类型列表 */</span><br><span class="line">const skuClassList = ref([]);</span><br><span class="line">function getSkuClassList() &#123;</span><br><span class="line">  listSkuClass(loadAllParams).then(response =&gt; &#123;</span><br><span class="line">    skuClassList.value = response.rows;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">getSkuClassList();</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h3 id="商品删除"><a href="#商品删除" class="headerlink" title="商品删除"></a>商品删除</h3><h4 id="需求-20"><a href="#需求-20" class="headerlink" title="需求"></a>需求</h4><p>在删除商品时，需要判断此商品是否被售货机的货道关联，如果关联则无法删除</p>
<ul>
<li><p>物理外键约束：通过在子表中添加一个外键列和约束，该列与父表的主键列相关联，由数据库维护数据的一致性和完整性</p>
</li>
<li><p>逻辑外键约束：在不使用数据库外键约束的情况下，通常在应用程序中通过代码来检查和维护数据的一致性和完整性</p>
</li>
</ul>
<p>使用逻辑外键约束的原因：我们在新增售货机货道记录时暂不指定商品，货道表中的SKU_ID有默认值0，而这个值在商品表中并不存在，那么物理外键约束会阻止货道表的插入，因为0并不指向任何有效的商品记录</p>
<p><img src="image-20240716214223061.png" alt="image-20240716214223061">  <img src="image-20240716214154124.png" alt="image-20240716214154124"></p>
<h4 id="SkuServiceImpl"><a href="#SkuServiceImpl" class="headerlink" title="SkuServiceImpl"></a>SkuServiceImpl</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> IChannelService channelService;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 批量删除商品管理</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> skuIds 需要删除的商品管理主键</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">deleteSkuBySkuIds</span><span class="params">(Long[] skuIds)</span></span><br><span class="line">&#123;   <span class="comment">//1. 判断商品的id集合是否有关联货道</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> channelService.countChannelBySkuIds(skuIds);</span><br><span class="line">    <span class="keyword">if</span>(count&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ServiceException</span>(<span class="string">&quot;此商品被货道关联，无法删除&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2. 没有关联货道才能删除</span></span><br><span class="line">    <span class="keyword">return</span> skuMapper.deleteSkuBySkuIds(skuIds);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="IChannelService-1"><a href="#IChannelService-1" class="headerlink" title="IChannelService"></a>IChannelService</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据商品id集合统计货道数量</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> skuIds</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 统计结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">countChannelBySkuIds</span><span class="params">(Long[] skuIds)</span>;</span><br></pre></td></tr></table></figure>
<h4 id="ChannelServiceImpl-1"><a href="#ChannelServiceImpl-1" class="headerlink" title="ChannelServiceImpl"></a>ChannelServiceImpl</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据商品id集合统计货道数量</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> skuIds</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 统计结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">countChannelBySkuIds</span><span class="params">(Long[] skuIds)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> channelMapper.countChannelBySkuIds(skuIds);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ChannelMapper接口和xml-1"><a href="#ChannelMapper接口和xml-1" class="headerlink" title="ChannelMapper接口和xml"></a>ChannelMapper接口和xml</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据商品id集合统计货道数量</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> skuIds</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 统计结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">countChannelBySkuIds</span><span class="params">(Long[] skuIds)</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;countChannelBySkuIds&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;java.lang.Integer&quot;</span>&gt;</span></span><br><span class="line">    select count(1) from tb_channel where sku_id in</span><br><span class="line">    <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">item</span>=<span class="string">&quot;id&quot;</span> <span class="attr">collection</span>=<span class="string">&quot;array&quot;</span> <span class="attr">open</span>=<span class="string">&quot;(&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span>&gt;</span></span><br><span class="line">        #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="批量导入"><a href="#批量导入" class="headerlink" title="批量导入"></a>批量导入</h2><h3 id="需求-21"><a href="#需求-21" class="headerlink" title="需求"></a>需求</h3><p>点击导入数据弹出导入数据弹窗，实现商品的批量导入</p>
<p><img src="image-20240630155543194.png" alt="image-20240630155543194"></p>
<h3 id="前端"><a href="#前端" class="headerlink" title="前端"></a>前端</h3><p>在sku/index.vue视图组件中修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--  导入按钮--&gt;</span><br><span class="line">&lt;el-col :span=&quot;1.5&quot;&gt;</span><br><span class="line">    &lt;el-button type=&quot;warning&quot; plain icon=&quot;Upload&quot; @click=&quot;handleExcelImport&quot; v-hasPermi=&quot;[&#x27;manage:sku:add&#x27;]&quot;&gt;导入&lt;/el-button&gt;</span><br><span class="line">&lt;/el-col&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 数据导入对话框 --&gt;</span><br><span class="line">&lt;el-dialog title=&quot;数据导入&quot; v-model=&quot;excelOpen&quot; width=&quot;400px&quot; append-to-body&gt;</span><br><span class="line">  &lt;el-upload ref=&quot;uploadRef&quot; class=&quot;upload-demo&quot;</span><br><span class="line">    :action=&quot;uploadExcelUrl&quot;</span><br><span class="line">    :headers=&quot;headers&quot;</span><br><span class="line">    :on-success=&quot;handleUploadSuccess&quot;</span><br><span class="line">    :on-error=&quot;handleUploadError&quot;</span><br><span class="line">    :before-upload=&quot;handleBeforeUpload&quot;         </span><br><span class="line">    :limit=&quot;1&quot;</span><br><span class="line">    :auto-upload=&quot;false&quot;&gt;</span><br><span class="line">    &lt;template #trigger&gt;</span><br><span class="line">      &lt;el-button type=&quot;primary&quot;&gt;上传文件&lt;/el-button&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">    &lt;el-button class=&quot;ml-3&quot; type=&quot;success&quot; @click=&quot;submitUpload&quot;&gt;</span><br><span class="line">      上传</span><br><span class="line">    &lt;/el-button&gt;</span><br><span class="line">    &lt;template #tip&gt;</span><br><span class="line">      &lt;div class=&quot;el-upload__tip&quot;&gt;</span><br><span class="line">        上传文件仅支持，xls/xlsx格式，文件大小不得超过1M</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/el-upload&gt;</span><br><span class="line">&lt;/el-dialog&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup name=&quot;Sku&quot;&gt;</span><br><span class="line">import &#123; getToken &#125; from &quot;@/utils/auth&quot;;</span><br><span class="line">    </span><br><span class="line">/* 打开数据导入对话框 */</span><br><span class="line">const excelOpen = ref(false);</span><br><span class="line">function handleExcelImport() &#123;</span><br><span class="line">  excelOpen.value = true;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 上传地址 */</span><br><span class="line">const uploadExcelUrl = ref(import.meta.env.VITE_APP_BASE_API + &quot;/manage/sku/import&quot;); // 上传excel文件地址</span><br><span class="line">/* 上传请求头 */</span><br><span class="line">const headers = ref(&#123; Authorization: &quot;Bearer &quot; + getToken() &#125;);</span><br><span class="line"></span><br><span class="line">/* 上传excel */</span><br><span class="line">const uploadRef = ref(&#123;&#125;);</span><br><span class="line">function submitUpload() &#123;</span><br><span class="line">  uploadRef.value.submit()</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">const props = defineProps(&#123;</span><br><span class="line">  modelValue: [String, Object, Array],</span><br><span class="line">  // 大小限制(MB)</span><br><span class="line">  fileSize: &#123;</span><br><span class="line">    type: Number,</span><br><span class="line">    default: 1,</span><br><span class="line">  &#125;,</span><br><span class="line">  // 文件类型, 例如[&quot;xls&quot;, &quot;xlsx&quot;]</span><br><span class="line">  fileType: &#123;</span><br><span class="line">    type: Array,</span><br><span class="line">    default: () =&gt; [&quot;xls&quot;, &quot;xlsx&quot;],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 上传前loading加载</span><br><span class="line">function handleBeforeUpload(file) &#123;</span><br><span class="line">  let isExcel = false;</span><br><span class="line">  if (props.fileType.length) &#123;</span><br><span class="line">    let fileExtension = &quot;&quot;;</span><br><span class="line">    if (file.name.lastIndexOf(&quot;.&quot;) &gt; -1) &#123;</span><br><span class="line">      fileExtension = file.name.slice(file.name.lastIndexOf(&quot;.&quot;) + 1);</span><br><span class="line">    &#125;</span><br><span class="line">    isExcel = props.fileType.some(type =&gt; &#123;</span><br><span class="line">      if (file.type.indexOf(type) &gt; -1) return true;</span><br><span class="line">      if (fileExtension &amp;&amp; fileExtension.indexOf(type) &gt; -1) return true;</span><br><span class="line">      return false;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125; </span><br><span class="line">  if (!isExcel) &#123;</span><br><span class="line">    proxy.$modal.msgError(</span><br><span class="line">      `文件格式不正确, 请上传$&#123;props.fileType.join(&quot;/&quot;)&#125;格式文件!`</span><br><span class="line">    );</span><br><span class="line">    return false;</span><br><span class="line">  &#125;</span><br><span class="line">  if (props.fileSize) &#123;</span><br><span class="line">    const isLt = file.size / 1024 / 1024 &lt; props.fileSize;</span><br><span class="line">    if (!isLt) &#123;</span><br><span class="line">      proxy.$modal.msgError(`上传excel大小不能超过 $&#123;props.fileSize&#125; MB!`);</span><br><span class="line">      return false;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  proxy.$modal.loading(&quot;正在上传excel，请稍候...&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 上传失败</span><br><span class="line">function handleUploadError() &#123;</span><br><span class="line">  proxy.$modal.msgError(&quot;上传excel失败&quot;);</span><br><span class="line">  uploadRef.value.clearFiles();</span><br><span class="line">  proxy.$modal.closeLoading();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 上传成功回调</span><br><span class="line">function handleUploadSuccess(res, file) &#123;</span><br><span class="line">  if (res.code === 200) &#123;</span><br><span class="line">    proxy.$modal.msgSuccess(&quot;上传excel成功&quot;);</span><br><span class="line">    excelOpen.value = false;</span><br><span class="line">    getList();</span><br><span class="line">  &#125;else&#123;</span><br><span class="line">    proxy.$modal.msgError(&quot;res.msg);</span><br><span class="line">  &#125; </span><br><span class="line">  uploadRef.value.clearFiles();</span><br><span class="line">  proxy.$modal.closeLoading();</span><br><span class="line">&#125;    </span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h3 id="后端"><a href="#后端" class="headerlink" title="后端"></a>后端</h3><h4 id="SkuController"><a href="#SkuController" class="headerlink" title="SkuController"></a>SkuController</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 导入商品管理列表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PreAuthorize(&quot;@ss.hasPermi(&#x27;manage:sku:add&#x27;)&quot;)</span></span><br><span class="line"><span class="meta">@Log(title = &quot;商品管理&quot;, businessType = BusinessType.IMPORT)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/import&quot;)</span></span><br><span class="line"><span class="keyword">public</span> AjaxResult <span class="title function_">excelImport</span><span class="params">(MultipartFile file)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    ExcelUtil&lt;Sku&gt; util = <span class="keyword">new</span> <span class="title class_">ExcelUtil</span>&lt;Sku&gt;(Sku.class);</span><br><span class="line">    List&lt;Sku&gt; skuList = util.importExcel(file.getInputStream());</span><br><span class="line">    <span class="keyword">return</span> toAjax(skuService.insertSkus(skuList));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="SKuMapper"><a href="#SKuMapper" class="headerlink" title="SKuMapper"></a>SKuMapper</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 批量新增商品管理</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> skuList</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">insertSkus</span><span class="params">(List&lt;Sku&gt; skuList)</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertSkus&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;java.util.List&quot;</span> <span class="attr">useGeneratedKeys</span>=<span class="string">&quot;true&quot;</span> <span class="attr">keyProperty</span>=<span class="string">&quot;skuId&quot;</span>&gt;</span></span><br><span class="line">    insert into tb_sku (sku_name, sku_image, brand_Name, unit, price, class_id)</span><br><span class="line">    values</span><br><span class="line">    <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">item</span>=<span class="string">&quot;item&quot;</span> <span class="attr">index</span>=<span class="string">&quot;index&quot;</span> <span class="attr">collection</span>=<span class="string">&quot;list&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">        (#&#123;item.skuName&#125;, #&#123;item.skuImage&#125;, #&#123;item.brandName&#125;, #&#123;item.unit&#125;, #&#123;item.price&#125;, #&#123;item.classId&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="ISkuService"><a href="#ISkuService" class="headerlink" title="ISkuService"></a>ISkuService</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 批量新增商品管理</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> skuList</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">insertSkus</span><span class="params">(List&lt;Sku&gt; skuList)</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 批量新增商品管理</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> skuList</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">insertSkus</span><span class="params">(List&lt;Sku&gt; skuList)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> skuMapper.insertSkus(skuList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="EasyExcel"><a href="#EasyExcel" class="headerlink" title="EasyExcel"></a>EasyExcel</h2><h3 id="介绍-2"><a href="#介绍-2" class="headerlink" title="介绍"></a>介绍</h3><p><img src="image-20240630142240399.png" alt="image-20240630142240399"></p>
<p>官方地址：<a target="_blank" rel="noopener" href="https://easyexcel.alibaba.com/">https://easyexcel.alibaba.com/</a></p>
<p>Java解析、生成Excel比较有名的框架有Apache poi、jxl。但他们都存在一个严重的问题就是非常的耗内存，poi有一套SAX模式的API可以一定程度的解决一些内存溢出的问题，但POI还是有一些缺陷，比如07版Excel解压缩以及解压后存储都是在内存中完成的，内存消耗依然很大。<br>easyexcel重写了poi对07版Excel的解析，一个3M的excel用POI sax解析依然需要100M左右内存，改用easyexcel可以降低到几M，并且再大的excel也不会出现内存溢出；03版依赖POI的sax模式，在上层做了模型转换的封装，让使用者更加简单方便</p>
<h3 id="项目集成"><a href="#项目集成" class="headerlink" title="项目集成"></a>项目集成</h3><p><a target="_blank" rel="noopener" href="https://doc.ruoyi.vip/ruoyi-vue/document/cjjc.html#%E9%9B%86%E6%88%90easyexcel%E5%AE%9E%E7%8E%B0excel%E8%A1%A8%E6%A0%BC%E5%A2%9E%E5%BC%BA">文档地址</a></p>
<p>1、<code>dkd-common\pom.xml</code>模块添加整合依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--  excel处理工具--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>easyexcel<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>2、在<code>dkd-common\</code>模块的<code>ExcelUtil.java</code>新增<code>easyexcel</code>导出导入方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 对excel表单默认第一个索引名转换成list（EasyExcel）</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> is 输入流</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 转换后集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> List&lt;T&gt; <span class="title function_">importEasyExcel</span><span class="params">(InputStream is)</span> <span class="keyword">throws</span> Exception</span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">return</span> EasyExcel.read(is).head(clazz).sheet().doReadSync();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 对list数据源将其里面的数据导入到excel表单（EasyExcel）</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> list 导出数据集合</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> sheetName 工作表的名称</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">exportEasyExcel</span><span class="params">(HttpServletResponse response, List&lt;T&gt; list, String sheetName)</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">try</span></span><br><span class="line"> &#123;</span><br><span class="line">  EasyExcel.write(response.getOutputStream(), clazz).sheet(sheetName).doWrite(list);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">catch</span> (IOException e)</span><br><span class="line"> &#123;</span><br><span class="line">  log.error(<span class="string">&quot;导出EasyExcel异常&#123;&#125;&quot;</span>, e.getMessage());</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3、<strong>Sku.java</strong>修改为<code>@ExcelProperty</code>注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dkd.manage.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.annotation.ExcelIgnoreUnannotated;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.annotation.ExcelProperty;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.annotation.write.style.ColumnWidth;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.annotation.write.style.HeadFontStyle;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.annotation.write.style.HeadRowHeight;</span><br><span class="line"><span class="keyword">import</span> com.dkd.common.annotation.Excel;</span><br><span class="line"><span class="keyword">import</span> com.dkd.common.core.domain.BaseEntity;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.builder.ToStringBuilder;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.builder.ToStringStyle;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 商品管理对象 tb_sku</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> itheima</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2024-07-15</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@ExcelIgnoreUnannotated</span><span class="comment">// 注解表示在导出Excel时，忽略没有被任何注解标记的字段</span></span><br><span class="line"><span class="meta">@ColumnWidth(16)</span><span class="comment">// 注解用于设置列的宽度</span></span><br><span class="line"><span class="meta">@HeadRowHeight(14)</span><span class="comment">// 注解用于设置表头行的高度</span></span><br><span class="line"><span class="meta">@HeadFontStyle(fontHeightInPoints = 11)</span><span class="comment">// 注解用于设置表头的字体样式</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Sku</span> <span class="keyword">extends</span> <span class="title class_">BaseEntity</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** 主键 */</span></span><br><span class="line">    <span class="keyword">private</span> Long skuId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** 商品名称 */</span></span><br><span class="line">    <span class="meta">@Excel(name = &quot;商品名称&quot;)</span></span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;商品名称&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String skuName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** 商品图片 */</span></span><br><span class="line">    <span class="meta">@Excel(name = &quot;商品图片&quot;)</span></span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;商品图片&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String skuImage;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** 品牌 */</span></span><br><span class="line">    <span class="meta">@Excel(name = &quot;品牌&quot;)</span></span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;品牌&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String brandName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** 规格(净含量) */</span></span><br><span class="line">    <span class="meta">@Excel(name = &quot;规格(净含量)&quot;)</span></span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;规格(净含量)&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String unit;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** 商品价格 */</span></span><br><span class="line">    <span class="meta">@Excel(name = &quot;商品价格&quot;)</span></span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;商品价格&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long price;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** 商品类型Id */</span></span><br><span class="line">    <span class="meta">@Excel(name = &quot;商品类型Id&quot;)</span></span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;商品类型Id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long classId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** 是否打折促销 */</span></span><br><span class="line">    <span class="keyword">private</span> Integer isDiscount;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 其他略...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4、<strong>SkuController.java</strong>改为<code>importEasyExcel</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 导入商品管理列表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PreAuthorize(&quot;@ss.hasPermi(&#x27;manage:sku:add&#x27;)&quot;)</span></span><br><span class="line"><span class="meta">@Log(title = &quot;商品管理&quot;, businessType = BusinessType.IMPORT)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/import&quot;)</span></span><br><span class="line"><span class="keyword">public</span> AjaxResult <span class="title function_">excelImport</span><span class="params">(MultipartFile file)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    ExcelUtil&lt;Sku&gt; util = <span class="keyword">new</span> <span class="title class_">ExcelUtil</span>&lt;Sku&gt;(Sku.class);</span><br><span class="line">    List&lt;Sku&gt; skuList = util.importEasyExcel(file.getInputStream());</span><br><span class="line">    <span class="keyword">return</span> toAjax(skuService.insertSkus(skuList));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>5、<strong>SkuController.java</strong>改为<code>exportEasyExcel</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 导出商品管理列表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PreAuthorize(&quot;@ss.hasPermi(&#x27;manage:sku:export&#x27;)&quot;)</span></span><br><span class="line"><span class="meta">@Log(title = &quot;商品管理&quot;, businessType = BusinessType.EXPORT)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/export&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">export</span><span class="params">(HttpServletResponse response, Sku sku)</span> &#123;</span><br><span class="line">    List&lt;Sku&gt; list = skuService.selectSkuList(sku);</span><br><span class="line">    ExcelUtil&lt;Sku&gt; util = <span class="keyword">new</span> <span class="title class_">ExcelUtil</span>&lt;Sku&gt;(Sku.class);</span><br><span class="line">    util.exportEasyExcel(response, list, <span class="string">&quot;商品管理数据&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="货道关联商品"><a href="#货道关联商品" class="headerlink" title="货道关联商品"></a>货道关联商品</h2><h3 id="需求-22"><a href="#需求-22" class="headerlink" title="需求"></a>需求</h3><p>对智能售货机内部的货道进行商品摆放的管理</p>
<p><img src="image-20240719160225644.png" alt="image-20240719160225644"></p>
<p><img src="image-20240719160337360.png" alt="image-20240719160337360" style="zoom:57%;" /></p>
<p>此功能涉及四个后端接口</p>
<ul>
<li>查询设备类型（已完成）</li>
<li>查询货道列表（待完成）</li>
<li>查询商品列表（已完成）</li>
<li>货道关联商品（待完成）</li>
</ul>
<h3 id="货道对话框"><a href="#货道对话框" class="headerlink" title="货道对话框"></a>货道对话框</h3><p>① 从资料中复制货道api请求js文件到api/manage目录下</p>
<p><img src="image-20240719162954927.png" alt="image-20240719162954927"></p>
<p>② 从资料中复制货道的视图组件到views/manage/vm目录下</p>
<p><img src="image-20240719163117366.png" alt="image-20240719163117366"></p>
<p>③ 修改设备index.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-button link type=&quot;primary&quot; @click=&quot;handleGoods(scope.row)&quot; v-hasPermi=&quot;[&#x27;manage:vm:edit&#x27;]&quot;&gt;货道&lt;/el-button&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 货道组件 --&gt;</span><br><span class="line">&lt;ChannelDialog :goodVisible=&quot;goodVisible&quot; :goodData=&quot;goodData&quot; @handleCloseGood=&quot;handleCloseGood&quot;&gt;&lt;/ChannelDialog&gt;</span><br><span class="line">&lt;!-- end --&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup name=&quot;Vm&quot;&gt;</span><br><span class="line">    // ********************货道********************</span><br><span class="line">    // 货道组件</span><br><span class="line">    import ChannelDialog from &#x27;./components/ChannelDialog.vue&#x27;;</span><br><span class="line">    const goodVisible = ref(false); //货道弹层显示隐藏</span><br><span class="line">    const goodData = ref(&#123;&#125;); //货道信息用来拿取 vmTypeId和innerCode</span><br><span class="line">    // 打开货道弹层</span><br><span class="line">    const handleGoods = (row) =&gt; &#123;</span><br><span class="line">        goodVisible.value = true;</span><br><span class="line">        goodData.value = row;</span><br><span class="line">    &#125;;</span><br><span class="line">    // 关闭货道弹层</span><br><span class="line">    const handleCloseGood = () =&gt; &#123;</span><br><span class="line">        goodVisible.value = false;</span><br><span class="line">    &#125;;</span><br><span class="line">    // ********************货道end********************</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped src=&quot;./index.scss&quot;&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<h3 id="查询货道列表"><a href="#查询货道列表" class="headerlink" title="查询货道列表"></a>查询货道列表</h3><h4 id="ChannelVo"><a href="#ChannelVo" class="headerlink" title="ChannelVo"></a>ChannelVo</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChannelVo</span> <span class="keyword">extends</span> <span class="title class_">Channel</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 商品</span></span><br><span class="line">    <span class="keyword">private</span> Sku sku;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ChannelMapper和xml"><a href="#ChannelMapper和xml" class="headerlink" title="ChannelMapper和xml"></a>ChannelMapper和xml</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据售货机编号查询货道列表</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> innerCode</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> ChannelVo集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">List&lt;ChannelVo&gt; <span class="title function_">selectChannelVoListByInnerCode</span><span class="params">(String innerCode)</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;ChannelVo&quot;</span> <span class="attr">id</span>=<span class="string">&quot;ChannelVoResult&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>    <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;channelCode&quot;</span>    <span class="attr">column</span>=<span class="string">&quot;channel_code&quot;</span>    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;skuId&quot;</span>    <span class="attr">column</span>=<span class="string">&quot;sku_id&quot;</span>    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;vmId&quot;</span>    <span class="attr">column</span>=<span class="string">&quot;vm_id&quot;</span>    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;innerCode&quot;</span>    <span class="attr">column</span>=<span class="string">&quot;inner_code&quot;</span>    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;maxCapacity&quot;</span>    <span class="attr">column</span>=<span class="string">&quot;max_capacity&quot;</span>    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;currentCapacity&quot;</span>    <span class="attr">column</span>=<span class="string">&quot;current_capacity&quot;</span>    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;lastSupplyTime&quot;</span>    <span class="attr">column</span>=<span class="string">&quot;last_supply_time&quot;</span>    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;createTime&quot;</span>    <span class="attr">column</span>=<span class="string">&quot;create_time&quot;</span>    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;updateTime&quot;</span>    <span class="attr">column</span>=<span class="string">&quot;update_time&quot;</span>    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;sku&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;Sku&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sku_id&quot;</span> <span class="attr">select</span>=<span class="string">&quot;com.dkd.manage.mapper.SkuMapper.selectSkuBySkuId&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectChannelVoListByInnerCode&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;ChannelVoResult&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;selectChannelVo&quot;</span>/&gt;</span></span><br><span class="line">    where inner_code = #&#123;innerCode&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="IChannelService接口和实现"><a href="#IChannelService接口和实现" class="headerlink" title="IChannelService接口和实现"></a>IChannelService接口和实现</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据售货机编号查询货道列表</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> innerCode</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> ChannelVo集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">List&lt;ChannelVo&gt; <span class="title function_">selectChannelVoListByInnerCode</span><span class="params">(String innerCode)</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据售货机编号查询货道列表</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> innerCode</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> ChannelVo集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;ChannelVo&gt; <span class="title function_">selectChannelVoListByInnerCode</span><span class="params">(String innerCode)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> channelMapper.selectChannelVoListByInnerCode(innerCode);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ChannelController"><a href="#ChannelController" class="headerlink" title="ChannelController"></a>ChannelController</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据售货机编号查询货道列表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PreAuthorize(&quot;@ss.hasPermi(&#x27;manage:channel:list&#x27;)&quot;)</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/list/&#123;innerCode&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> AjaxResult <span class="title function_">lisetByInnerCode</span><span class="params">(<span class="meta">@PathVariable(&quot;innerCode&quot;)</span> String innerCode)</span> &#123;</span><br><span class="line">    List&lt;ChannelVo&gt; voList = channelService.selectChannelVoListByInnerCode(innerCode);</span><br><span class="line">    <span class="keyword">return</span> success(voList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="货道关联商品-1"><a href="#货道关联商品-1" class="headerlink" title="货道关联商品"></a>货道关联商品</h3><h4 id="ChannelSkuDto"><a href="#ChannelSkuDto" class="headerlink" title="ChannelSkuDto"></a>ChannelSkuDto</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 某个货道对应的sku信息</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChannelSkuDto</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String innerCode;</span><br><span class="line">    <span class="keyword">private</span> String channelCode;</span><br><span class="line">    <span class="keyword">private</span> Long skuId;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ChannelConfigDto"><a href="#ChannelConfigDto" class="headerlink" title="ChannelConfigDto"></a>ChannelConfigDto</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 售货机货道配置</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChannelConfigDto</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 售货机编号</span></span><br><span class="line">    <span class="keyword">private</span> String innerCode;</span><br><span class="line">    <span class="comment">// 货道配置</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;ChannelSkuDto&gt; channelList;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ChannelMapper和xml-1"><a href="#ChannelMapper和xml-1" class="headerlink" title="ChannelMapper和xml"></a>ChannelMapper和xml</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据售货机编号和货道编号查询货道信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> innerCode</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> channelCode</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 售货机货道</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Select(&quot;select * from tb_channel where inner_code =#&#123;innerCode&#125; and channel_code=#&#123;channelCode&#125;&quot;)</span></span><br><span class="line">Channel <span class="title function_">getChannelInfo</span><span class="params">(<span class="meta">@Param(&quot;innerCode&quot;)</span> String innerCode, <span class="meta">@Param(&quot;channelCode&quot;)</span> String channelCode)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 批量修改货道</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> list</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">batchUpdateChannel</span><span class="params">(List&lt;Channel&gt; list)</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;batchUpdateChannel&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;java.util.List&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">item</span>=<span class="string">&quot;channel&quot;</span> <span class="attr">collection</span>=<span class="string">&quot;list&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;;&quot;</span>&gt;</span></span><br><span class="line">        UPDATE tb_channel</span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;channel.channelCode != null and channel.channelCode != &#x27;&#x27;&quot;</span>&gt;</span>channel_code = #&#123;channel.channelCode&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;channel.skuId != null&quot;</span>&gt;</span>sku_id = #&#123;channel.skuId&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;channel.vmId != null&quot;</span>&gt;</span>vm_id = #&#123;channel.vmId&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;channel.innerCode != null and channel.innerCode != &#x27;&#x27;&quot;</span>&gt;</span>inner_code = #&#123;channel.innerCode&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;channel.maxCapacity != null&quot;</span>&gt;</span>max_capacity = #&#123;channel.maxCapacity&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;channel.currentCapacity != null&quot;</span>&gt;</span>current_capacity = #&#123;channel.currentCapacity&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;channel.lastSupplyTime != null&quot;</span>&gt;</span>last_supply_time = #&#123;channel.lastSupplyTime&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;channel.createTime != null&quot;</span>&gt;</span>create_time = #&#123;channel.createTime&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;channel.updateTime != null&quot;</span>&gt;</span>update_time = #&#123;channel.updateTime&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">        WHERE id = #&#123;channel.id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="application-druid-yml"><a href="#application-druid-yml" class="headerlink" title="application-druid.yml"></a>application-druid.yml</h4><p>允许mybatis框架在单个请求中发送多个sql语句</p>
<p><img src="image-20240719165325959.png" alt="image-20240719165325959"></p>
<h4 id="IChannelService接口和实现-1"><a href="#IChannelService接口和实现-1" class="headerlink" title="IChannelService接口和实现"></a>IChannelService接口和实现</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 货道关联商品</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> channelConfigDto</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">setChannel</span><span class="params">(ChannelConfigDto channelConfigDto)</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 货道关联商品</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> channelConfigDto</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">setChannel</span><span class="params">(ChannelConfigDto channelConfigDto)</span> &#123;</span><br><span class="line">    <span class="comment">//1. dto转po</span></span><br><span class="line">    List&lt;Channel&gt; list = channelConfigDto.getChannelList().stream().map(c -&gt; &#123;</span><br><span class="line">        <span class="comment">// 根据售货机编号和货道编号查询货道</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> channelMapper.getChannelInfo(c.getInnerCode(), c.getChannelCode());</span><br><span class="line">        <span class="keyword">if</span> (channel != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// 货道更新skuId</span></span><br><span class="line">            channel.setSkuId(c.getSkuId());</span><br><span class="line">            <span class="comment">// 货道更新时间</span></span><br><span class="line">            channel.setUpdateTime(DateUtils.getNowDate());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> channel;</span><br><span class="line">    &#125;).collect(Collectors.toList());</span><br><span class="line">    <span class="comment">//2. 批量修改货道</span></span><br><span class="line">    <span class="keyword">return</span> channelMapper.batchUpdateChannel(list);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ChannelController-1"><a href="#ChannelController-1" class="headerlink" title="ChannelController"></a>ChannelController</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 货道关联商品</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PreAuthorize(&quot;@ss.hasPermi(&#x27;manage:channel:edit&#x27;)&quot;)</span></span><br><span class="line"><span class="meta">@Log(title = &quot;售货机货道&quot;, businessType = BusinessType.UPDATE)</span></span><br><span class="line"><span class="meta">@PutMapping(&quot;/config&quot;)</span></span><br><span class="line"><span class="keyword">public</span> AjaxResult <span class="title function_">setChannel</span><span class="params">(<span class="meta">@RequestBody</span> ChannelConfigDto channelConfigDto)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> toAjax(channelService.setChannel(channelConfigDto));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="工单管理"><a href="#工单管理" class="headerlink" title="工单管理"></a>工单管理</h1><h2 id="需求说明-5"><a href="#需求说明-5" class="headerlink" title="需求说明"></a>需求说明</h2><p>工单是一种专业名词，是指用于<code>记录、处理、跟踪</code>一项工作的完成情况。</p>
<ul>
<li>管理人员登录后台系统选择创建工单，在工单类型里选择合适的工单类型，在设备编号里输入正确的设备编号。</li>
<li>工作人员在运营管理App可以看到分配给自己的工单，根据实际情况选择接收工单并完成，或者拒绝/取消工单。</li>
</ul>
<p><strong>立可得工单分为两大类 ：</strong></p>
<ul>
<li><p>运营工单：运营人员来维护售货机<code>商品</code>，即补货工单。</p>
</li>
<li><p>运维工单：运维人员来维护售货机<code>设备</code>，即投放工单、撤机工单、维修工单。</p>
</li>
</ul>
<p><strong>工单有四种状态：</strong>  </p>
<p>1 待处理  2 进行中  3 已取消  4 已完成</p>
<p><img src="10-3.png" alt=""></p>
<p><strong>对于工单和其他管理数据，下面是示意图：</strong></p>
<ul>
<li>关系字段：task_id、 product_type_id、inner_code、user_id、assignor_id、region_id</li>
<li>数据字典：task_status（1待办、2进行、3取消、4完成）</li>
<li>数据字典：create_type（0自动、1手动）</li>
<li>PS：运营的工单包含补货信息，运维工单没有，所以运营工单需要单独创建补货工单</li>
</ul>
<p><img src="image-20240722162323740.png" alt="image-20240722162323740">  </p>
<p><strong>创建所有工单，都会在工单表和工单明细表插入记录吗？</strong></p>
<p>创建运维类工单只会在工单表插入数据。</p>
<p>创建运营类工单（补货工单）会在工单表和工单明细表插入数据。</p>
<p><strong>task_code和task_id有什么区别？</strong></p>
<p>task_code是工单编号，具有业务规则 ，格式为年月日+当日序号。</p>
<p>task_id 为工单表数据唯一标识。</p>
<p><strong>工单表的user_id和assignor_id分别是做什么的？</strong></p>
<p>user_id是工单执行人的id（运维或运营）</p>
<p>assignor_id是工单指派人的id（创建工单的人）</p>
<h2 id="基础代码生成"><a href="#基础代码生成" class="headerlink" title="基础代码生成"></a>基础代码生成</h2><h3 id="需求-23"><a href="#需求-23" class="headerlink" title="需求"></a>需求</h3><p>使用若依代码生成器，生成工管理前后端基础代码，并导入到项目中：</p>
<p><img src="image-20240722154846604.png" alt="image-20240722154846604"></p>
<h3 id="步骤-5"><a href="#步骤-5" class="headerlink" title="步骤"></a>步骤</h3><h4 id="①创建目录菜单-5"><a href="#①创建目录菜单-5" class="headerlink" title="①创建目录菜单"></a>①创建目录菜单</h4><p>创建点位管理目录菜单</p>
<p><img src="image-20240722155046847.png" alt="image-20240722155046847">   <img src="image-20240722203758387.png" alt="image-20240722203758387"></p>
<h4 id="②添加数据字典-3"><a href="#②添加数据字典-3" class="headerlink" title="②添加数据字典"></a>②添加数据字典</h4><p>先创建<code>工单状态</code>的字典类型</p>
<p> <img src="image-20240722204652594.png" alt="image-20240722204652594"></p>
<p><img src="image-20240722204737663.png" alt="image-20240722204737663">  </p>
<p>再创建<code>工单状态</code>的字典数据</p>
<p><img src="image-20240722204956956.png" alt="image-20240722204956956"></p>
<p> <img src="image-20240722205033489.png" alt="image-20240722205033489">  </p>
<p>先创建<code>工单创建类型</code>的字典类型</p>
<p><img src="image-20240722205105502.png" alt="image-20240722205105502"></p>
<p><img src="image-20240722205128155.png" alt="image-20240722205128155"></p>
<p>再创建<code>工单创建类型</code>的字典数据</p>
<p><img src="image-20240722160506242.png" alt="image-20240722160506242"></p>
<p><img src="image-20240722205158812.png" alt="image-20240722205158812">  </p>
<h4 id="③配置代码生成信息-3"><a href="#③配置代码生成信息-3" class="headerlink" title="③配置代码生成信息"></a>③配置代码生成信息</h4><p>导入四张表</p>
<p><img src="image-20240722162617583.png" alt="image-20240722162617583"></p>
<p>配置工单表（运维、运营）</p>
<p><img src="image-20240722161206343.png" alt="image-20240722161206343">  </p>
<p><img src="image-20240722161237298.png" alt="image-20240722161237298"></p>
<p><img src="image-20240722205625960.png" alt="image-20240722205625960"></p>
<p>配置工单类型表（工单原型）</p>
<p><img src="image-20240722161701699.png" alt="image-20240722161701699">  </p>
<p><img src="image-20240722161727464.png" alt="image-20240722161727464"></p>
<p><img src="image-20240722161835563.png" alt="image-20240722161835563"></p>
<p>配置工单详情表（工单原型）</p>
<p><img src="image-20240722161908247.png" alt="image-20240722161908247">  </p>
<p><img src="image-20240722162850400.png" alt="image-20240722162850400"></p>
<p><img src="image-20240722162906011.png" alt="image-20240722162906011">  </p>
<p>创建自动补货任务表（工单原型）</p>
<p><img src="image-20240722163046710.png" alt="image-20240722163046710"></p>
<p><img src="image-20240722163056885.png" alt="image-20240722163056885"></p>
<p><img src="image-20240722163112340.png" alt="image-20240722163112340"></p>
<h4 id="④下载代码并导入项目-3"><a href="#④下载代码并导入项目-3" class="headerlink" title="④下载代码并导入项目"></a>④下载代码并导入项目</h4><p>选中四张表生成下载</p>
<p><img src="image-20240722163159812.png" alt="image-20240722163159812">  </p>
<p>解压<code>ruoyi.zip</code>得到前后端代码和动态菜单sql</p>
<blockquote>
<p>注意：工单管理只需要后端代码，前端使用资料中的</p>
</blockquote>
<p><img src="image-20240722163438233.png" alt="image-20240722163438233"></p>
<p>代码导入</p>
<p><img src="image-20240722163548428.png" alt="image-20240722163548428"></p>
<h4 id="⑤配置工单前端代码"><a href="#⑤配置工单前端代码" class="headerlink" title="⑤配置工单前端代码"></a>⑤配置工单前端代码</h4><p>1）从资料中复制工单api请求js文件到api/manage目录下</p>
<p> <img src="image-20240722164320618.png" alt="image-20240722164320618"></p>
<p>4）从资料中复制货道的视图组件到views/manage目录下</p>
<p><img src="image-20240722164423267.png" alt="image-20240722164423267">  </p>
<p>3）创建运营工单二级菜单</p>
<p><img src="image-20240722210725885.png" alt="image-20240722210725885">  </p>
<p>4）创建运维工单二级菜单</p>
<p><img src="image-20240722210902394.png" alt="image-20240722210902394">  </p>
<h3 id="修复bug"><a href="#修复bug" class="headerlink" title="修复bug"></a>修复bug</h3><p>在工单表中，有一个<code>desc</code>备注字段，这个<code>desc</code>是一个数据库关键字，所以我们在执行查询时，报了语法错误所以要给所有的<code>desc</code>增加反引号表示一个普通的sql字段</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">&quot;selectTaskVo&quot;</span>&gt;</span></span><br><span class="line">    select task_id, task_code, task_status, create_type, inner_code, user_id, user_name, region_id, `desc`, product_type_id, assignor_id, addr, create_time, update_time from tb_task</span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="查询工单列表"><a href="#查询工单列表" class="headerlink" title="查询工单列表"></a>查询工单列表</h2><h3 id="需求-24"><a href="#需求-24" class="headerlink" title="需求"></a>需求</h3><p>运营和运营工单共享一套后端接口，通过特定的查询条件区分工单类型，并在返回结果中包含工单类型的详细信息</p>
<p><img src="image-20240722170521551.png" alt="image-20240722170521551" style="zoom:79%;" /></p>
<p><img src="image-20240722170554207.png" alt="image-20240722170554207" style="zoom:80%;" /></p>
<h3 id="TaskVo"><a href="#TaskVo" class="headerlink" title="TaskVo"></a>TaskVo</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TaskVo</span> <span class="keyword">extends</span> <span class="title class_">Task</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 工单类型</span></span><br><span class="line">    <span class="keyword">private</span> TaskType taskType;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="TaskMapper"><a href="#TaskMapper" class="headerlink" title="TaskMapper"></a>TaskMapper</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询运维工单列表</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> task 运维工单</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> TaskVo集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">List&lt;TaskVo&gt; <span class="title function_">selectTaskVoList</span><span class="params">(Task task)</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;taskVo&quot;</span> <span class="attr">id</span>=<span class="string">&quot;TaskVoResult&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;taskId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;task_id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;taskCode&quot;</span> <span class="attr">column</span>=<span class="string">&quot;task_code&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;taskStatus&quot;</span> <span class="attr">column</span>=<span class="string">&quot;task_status&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;createType&quot;</span> <span class="attr">column</span>=<span class="string">&quot;create_type&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;innerCode&quot;</span> <span class="attr">column</span>=<span class="string">&quot;inner_code&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;userId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;user_id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;userName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;user_name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;regionId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;region_id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;desc&quot;</span> <span class="attr">column</span>=<span class="string">&quot;desc&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;productTypeId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;product_type_id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;assignorId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;assignor_id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;addr&quot;</span> <span class="attr">column</span>=<span class="string">&quot;addr&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;createTime&quot;</span> <span class="attr">column</span>=<span class="string">&quot;create_time&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;updateTime&quot;</span> <span class="attr">column</span>=<span class="string">&quot;update_time&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;taskType&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;TaskType&quot;</span> <span class="attr">column</span>=<span class="string">&quot;product_type_id&quot;</span> </span></span><br><span class="line"><span class="tag">                 <span class="attr">select</span>=<span class="string">&quot;com.dkd.manage.mapper.TaskTypeMapper.selectTaskTypeByTypeId&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectTaskVoList&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;TaskVoResult&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;selectTaskVo&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;taskCode != null  and taskCode != &#x27;&#x27;&quot;</span>&gt;</span>and task_code = #&#123;taskCode&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;taskStatus != null &quot;</span>&gt;</span>and task_status = #&#123;taskStatus&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;createType != null &quot;</span>&gt;</span>and create_type = #&#123;createType&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;innerCode != null  and innerCode != &#x27;&#x27;&quot;</span>&gt;</span>and inner_code = #&#123;innerCode&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;userId != null &quot;</span>&gt;</span>and user_id = #&#123;userId&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;userName != null  and userName != &#x27;&#x27;&quot;</span>&gt;</span>and user_name like concat(&#x27;%&#x27;, #&#123;userName&#125;, &#x27;%&#x27;)<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;regionId != null &quot;</span>&gt;</span>and region_id = #&#123;regionId&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;desc != null  and desc != &#x27;&#x27;&quot;</span>&gt;</span>and `desc` = #&#123;desc&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;productTypeId != null &quot;</span>&gt;</span>and product_type_id = #&#123;productTypeId&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;assignorId != null &quot;</span>&gt;</span>and assignor_id = #&#123;assignorId&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;addr != null  and addr != &#x27;&#x27;&quot;</span>&gt;</span>and addr = #&#123;addr&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;params.isRepair != null and params.isRepair==&#x27;true&#x27;&quot;</span>&gt;</span></span><br><span class="line">            and product_type_id in (1,3,4)</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;params.isRepair != null and params.isRepair==&#x27;false&#x27;&quot;</span>&gt;</span></span><br><span class="line">            and product_type_id =2</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        order by create_time desc</span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="ITaskService"><a href="#ITaskService" class="headerlink" title="ITaskService"></a>ITaskService</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询运维工单列表</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> task</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> TaskVo集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">List&lt;TaskVo&gt; <span class="title function_">selectTaskVoList</span><span class="params">(Task task)</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询运维工单列表</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> task</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> TaskVo集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;TaskVo&gt; <span class="title function_">selectTaskVoList</span><span class="params">(Task task)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> taskMapper.selectTaskVoList(task);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="TaskController"><a href="#TaskController" class="headerlink" title="TaskController"></a>TaskController</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询工单列表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PreAuthorize(&quot;@ss.hasPermi(&#x27;manage:task:list&#x27;)&quot;)</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/list&quot;)</span></span><br><span class="line"><span class="keyword">public</span> TableDataInfo <span class="title function_">list</span><span class="params">(Task task)</span></span><br><span class="line">&#123;</span><br><span class="line">    startPage();</span><br><span class="line">    List&lt;TaskVo&gt; voList = taskService.selectTaskVoList(task);</span><br><span class="line">    <span class="keyword">return</span> getDataTable(voList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="获取运营人员列表"><a href="#获取运营人员列表" class="headerlink" title="获取运营人员列表"></a>获取运营人员列表</h2><h3 id="需求-25"><a href="#需求-25" class="headerlink" title="需求"></a>需求</h3><p>根据售货机编号获取负责当前区域下的运营人员列表</p>
<p><img src="image-20240722172059458.png" alt="image-20240722172059458">  </p>
<h3 id="VendingMachineMapper"><a href="#VendingMachineMapper" class="headerlink" title="VendingMachineMapper"></a>VendingMachineMapper</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据设备编号查询设备信息</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> innerCode</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> VendingMachine</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Select(&quot;select * from tb_vending_machine where inner_code=#&#123;innerCode&#125;&quot;)</span></span><br><span class="line">VendingMachine <span class="title function_">selectVendingMachineByInnerCode</span><span class="params">(String innerCode)</span>;</span><br></pre></td></tr></table></figure>
<h3 id="IVendingMachineService"><a href="#IVendingMachineService" class="headerlink" title="IVendingMachineService"></a>IVendingMachineService</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据设备编号查询设备信息</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> innerCode</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> VendingMachine</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">VendingMachine <span class="title function_">selectVendingMachineByInnerCode</span><span class="params">(String innerCode)</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据设备编号查询设备信息</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> innerCode</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> VendingMachine</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> VendingMachine <span class="title function_">selectVendingMachineByInnerCode</span><span class="params">(String innerCode)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> vendingMachineMapper.selectVendingMachineByInnerCode(innerCode);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="DkdContants"><a href="#DkdContants" class="headerlink" title="DkdContants"></a>DkdContants</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 员工启用</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Long</span> <span class="variable">EMP_STATUS_NORMAL</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 员工禁用</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Long</span> <span class="variable">EMP_STATUS_DISABLE</span> <span class="operator">=</span> <span class="number">0L</span>;</span><br></pre></td></tr></table></figure>
<h3 id="EmpController"><a href="#EmpController" class="headerlink" title="EmpController"></a>EmpController</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> IVendingMachineService vendingMachineService;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据售货机获取运营人员列表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PreAuthorize(&quot;@ss.hasPermi(&#x27;manage:emp:list&#x27;)&quot;)</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/businessList/&#123;innerCode&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> AjaxResult <span class="title function_">businessList</span><span class="params">(<span class="meta">@PathVariable(&quot;innerCode&quot;)</span> String innerCode)</span> &#123;</span><br><span class="line">    <span class="comment">// 1.查询售货机信息</span></span><br><span class="line">    <span class="type">VendingMachine</span> <span class="variable">vm</span> <span class="operator">=</span> vendingMachineService.selectVendingMachineByInnerCode(innerCode);</span><br><span class="line">    <span class="keyword">if</span> (vm == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> error();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 2.根据区域id、角色编号、员工状态查询运营人员列表</span></span><br><span class="line">    <span class="type">Emp</span> <span class="variable">empParam</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Emp</span>();</span><br><span class="line">    empParam.setRegionId(vm.getRegionId());<span class="comment">// 设备所属区域</span></span><br><span class="line">    empParam.setStatus(DkdContants.EMP_STATUS_NORMAL);<span class="comment">// 员工启用</span></span><br><span class="line">    empParam.setRoleCode(DkdContants.ROLE_CODE_BUSINESS);<span class="comment">// 角色编码：运营员</span></span><br><span class="line">    <span class="keyword">return</span> success(empService.selectEmpList(empParam));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="获取运维人员列表"><a href="#获取运维人员列表" class="headerlink" title="获取运维人员列表"></a>获取运维人员列表</h2><h3 id="需求-26"><a href="#需求-26" class="headerlink" title="需求"></a>需求</h3><p>根据售货机编号获取负责当前区域下的运维人员列表</p>
<p><img src="image-20240722172113957.png" alt="image-20240722172113957"></p>
<h3 id="EmpController-1"><a href="#EmpController-1" class="headerlink" title="EmpController"></a>EmpController</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据售货机获取运维人员列表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PreAuthorize(&quot;@ss.hasPermi(&#x27;manage:emp:list&#x27;)&quot;)</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/operationList/&#123;innerCode&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> AjaxResult <span class="title function_">getOperationList</span><span class="params">(<span class="meta">@PathVariable(&quot;innerCode&quot;)</span> String innerCode)</span> &#123;</span><br><span class="line">    <span class="comment">// 1.查询售货机信息</span></span><br><span class="line">    <span class="type">VendingMachine</span> <span class="variable">vm</span> <span class="operator">=</span> vendingMachineService.selectVendingMachineByInnerCode(innerCode);</span><br><span class="line">    <span class="keyword">if</span> (vm == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> error(<span class="string">&quot;售货机不存在&quot;</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 2.根据区域id、角色编号、状态查询运维人员列表</span></span><br><span class="line">    <span class="type">Emp</span> <span class="variable">empParam</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Emp</span>();</span><br><span class="line">    empParam.setRegionId(vm.getRegionId());<span class="comment">// 设备所属区域</span></span><br><span class="line">    empParam.setStatus(DkdContants.EMP_STATUS_NORMAL);<span class="comment">// 员工启用</span></span><br><span class="line">    empParam.setRoleCode(DkdContants.ROLE_CODE_OPERATOR);<span class="comment">// 角色编码：维修员</span></span><br><span class="line">    <span class="keyword">return</span> success(empService.selectEmpList(empParam));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="新增工单"><a href="#新增工单" class="headerlink" title="新增工单"></a>新增工单</h2><h3 id="需求-27"><a href="#需求-27" class="headerlink" title="需求"></a>需求</h3><p>本系统中有两类工单需要创建，分别是：</p>
<ul>
<li><strong>运维工单</strong>：运维工单主要是对售货机的操作，又可以细分为投放工单、撤机工单、维修工单</li>
<li><strong>运营工单</strong>：运营工单主要是对货物的操作，只有一种就是补货工单</li>
</ul>
<p><img src="image-20240722172059458.png" alt="image-20240722172059458">  <img src="image-20240722172113957.png" alt="image-20240722172113957"></p>
<h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>新增工单时序图</p>
<p><img src="1681295827753.png" alt="1681295827753"></p>
<p>  新增工单业务流程图</p>
<p><img src="image-20240726100352426.png" alt="image-20240726100352426"></p>
<h3 id="TaskDetailsDto"><a href="#TaskDetailsDto" class="headerlink" title="TaskDetailsDto"></a>TaskDetailsDto</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TaskDetailsDto</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String channelCode;<span class="comment">// 货道编号</span></span><br><span class="line">    <span class="keyword">private</span> Long expectCapacity;<span class="comment">// 期望补货数量</span></span><br><span class="line">    <span class="keyword">private</span> Long skuId;<span class="comment">// 商品Id</span></span><br><span class="line">    <span class="keyword">private</span> String skuName;<span class="comment">// 商品名称</span></span><br><span class="line">    <span class="keyword">private</span> String skuImage;<span class="comment">// 商品图片</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="TaskDto"><a href="#TaskDto" class="headerlink" title="TaskDto"></a>TaskDto</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TaskDto</span> &#123;</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">private</span> Long createType;<span class="comment">// 创建类型</span></span><br><span class="line">    <span class="keyword">private</span> String innerCode;<span class="comment">// 关联设备编号</span></span><br><span class="line">    <span class="keyword">private</span> Long userId;<span class="comment">// 任务执行人Id</span></span><br><span class="line">    <span class="keyword">private</span> Long assignorId;<span class="comment">// 用户创建人id</span></span><br><span class="line">    <span class="keyword">private</span> Long productTypeId;<span class="comment">// 工单类型</span></span><br><span class="line">    <span class="keyword">private</span> String desc;<span class="comment">// 描述信息</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;TaskDetailsDto&gt; details;<span class="comment">// 工单详情(只有补货工单才涉及)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="TaskDetailsMapper"><a href="#TaskDetailsMapper" class="headerlink" title="TaskDetailsMapper"></a>TaskDetailsMapper</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 批量新增工单详情</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> taskDetailsList</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">batchInsertTaskDetails</span><span class="params">(List&lt;TaskDetails&gt; taskDetailsList)</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;batchInsertTaskDetails&quot;</span>&gt;</span></span><br><span class="line">    INSERT INTO tb_task_details(task_id, channel_code, expect_capacity, sku_id, sku_name, sku_image)</span><br><span class="line">    VALUES</span><br><span class="line">    <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">item</span>=<span class="string">&quot;item&quot;</span> <span class="attr">collection</span>=<span class="string">&quot;list&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">        (#&#123;item.taskId&#125;, #&#123;item.channelCode&#125;, #&#123;item.expectCapacity&#125;, #&#123;item.skuId&#125;, #&#123;item.skuName&#125;, #&#123;item.skuImage&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="ITaskDetailsService"><a href="#ITaskDetailsService" class="headerlink" title="ITaskDetailsService"></a>ITaskDetailsService</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 批量新增工单详情</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> taskDetailsList</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">batchInsertTaskDetails</span><span class="params">(List&lt;TaskDetails&gt; taskDetailsList)</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 批量新增工单详情</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> taskDetailsList</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">batchInsertTaskDetails</span><span class="params">(List&lt;TaskDetails&gt; taskDetailsList)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> taskDetailsMapper.batchInsertTaskDetails(taskDetailsList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ITaskService-1"><a href="#ITaskService-1" class="headerlink" title="ITaskService"></a>ITaskService</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 新增运营、运维工单</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> taskDto</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">insertTaskDto</span><span class="params">(TaskDto taskDto)</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> IVendingMachineService vendingMachineService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> IEmpService empService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> ITaskDetailsService taskDetailsService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> RedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 新增运营、运维工单</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> taskDto</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">insertTaskDto</span><span class="params">(TaskDto taskDto)</span> &#123;</span><br><span class="line">    <span class="comment">//1. 查询售货机是否存在</span></span><br><span class="line">    <span class="type">VendingMachine</span> <span class="variable">vm</span> <span class="operator">=</span> vendingMachineService.selectVendingMachineByInnerCode(taskDto.getInnerCode());</span><br><span class="line">    <span class="keyword">if</span> (vm == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ServiceException</span>(<span class="string">&quot;设备不存在&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2. 校验售货机状态与工单类型是否相符</span></span><br><span class="line">    checkCreateTask(vm.getVmStatus(), taskDto.getProductTypeId());</span><br><span class="line">    <span class="comment">//3. 检查设备是否有未完成的同类型工单</span></span><br><span class="line">    hasTask(taskDto);</span><br><span class="line">    <span class="comment">//4. 查询并校验员工是否存在</span></span><br><span class="line">    <span class="type">Emp</span> <span class="variable">emp</span> <span class="operator">=</span> empService.selectEmpById(taskDto.getUserId());</span><br><span class="line">    <span class="keyword">if</span> (emp == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ServiceException</span>(<span class="string">&quot;员工不存在&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//5. 校验员工区域是否匹配</span></span><br><span class="line">    <span class="keyword">if</span> (!emp.getRegionId().equals(vm.getRegionId())) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ServiceException</span>(<span class="string">&quot;员工区域与设备区域不一致，无法处理此工单&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//6. 将dto转为po并补充属性，保存工单</span></span><br><span class="line">    <span class="type">Task</span> <span class="variable">task</span> <span class="operator">=</span> BeanUtil.copyProperties(taskDto, Task.class);<span class="comment">// 属性复制</span></span><br><span class="line">    task.setTaskStatus(DkdContants.TASK_STATUS_CREATE);<span class="comment">// 创建工单</span></span><br><span class="line">    task.setUserName(emp.getUserName());<span class="comment">// 执行人名称</span></span><br><span class="line">    task.setRegionId(vm.getRegionId());<span class="comment">// 所属区域id</span></span><br><span class="line">    task.setAddr(vm.getAddr());<span class="comment">// 地址</span></span><br><span class="line">    task.setCreateTime(DateUtils.getNowDate());<span class="comment">// 创建时间</span></span><br><span class="line">    task.setTaskCode(generateTaskCode());<span class="comment">// 工单编号</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">taskResult</span> <span class="operator">=</span> taskMapper.insertTask(task);</span><br><span class="line">    <span class="comment">//7. 判断是否为补货工单</span></span><br><span class="line">    <span class="keyword">if</span> (taskDto.getProductTypeId().equals(DkdContants.TASK_TYPE_SUPPLY)) &#123;</span><br><span class="line">        <span class="comment">// 8.保存工单详情</span></span><br><span class="line">        List&lt;TaskDetailsDto&gt; details = taskDto.getDetails();</span><br><span class="line">        <span class="keyword">if</span> (CollUtil.isEmpty(details)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ServiceException</span>(<span class="string">&quot;补货工单详情不能为空&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 将dto转为po补充属性</span></span><br><span class="line">        List&lt;TaskDetails&gt; taskDetailsList = details.stream().map(dto -&gt; &#123;</span><br><span class="line">            <span class="type">TaskDetails</span> <span class="variable">taskDetails</span> <span class="operator">=</span> BeanUtil.copyProperties(dto, TaskDetails.class);</span><br><span class="line">            taskDetails.setTaskId(task.getTaskId());</span><br><span class="line">            <span class="keyword">return</span> taskDetails;</span><br><span class="line">        &#125;).collect(Collectors.toList());</span><br><span class="line">        <span class="comment">// 批量新增</span></span><br><span class="line">        taskDetailsService.batchInsertTaskDetails(taskDetailsList);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> taskResult;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 生成并获取当天任务代码的唯一标识。</span></span><br><span class="line"><span class="comment"> * 该方法首先尝试从Redis中获取当天的任务代码计数，如果不存在，则初始化为1并返回&quot;日期0001&quot;格式的字符串。</span></span><br><span class="line"><span class="comment"> * 如果存在，则对计数加1并返回更新后的任务代码。</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 返回当天任务代码的唯一标识，格式为&quot;日期XXXX&quot;，其中XXXX是四位数字的计数。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">generateTaskCode</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 获取当前日期并格式化为&quot;yyyyMMdd&quot;</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">dateStr</span> <span class="operator">=</span> DateUtils.getDate().replaceAll(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="comment">// 根据日期生成redis的键</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="string">&quot;dkd.task.code.&quot;</span> + dateStr;</span><br><span class="line">    <span class="comment">// 判断key是否存在</span></span><br><span class="line">    <span class="keyword">if</span> (!redisTemplate.hasKey(key)) &#123;</span><br><span class="line">        <span class="comment">// 如果key不存在，设置初始值为1，并指定过期时间为1天</span></span><br><span class="line">        redisTemplate.opsForValue().set(key, <span class="number">1</span>, Duration.ofDays(<span class="number">1</span>));</span><br><span class="line">        <span class="comment">// 返回工单编号（日期+0001）</span></span><br><span class="line">        <span class="keyword">return</span> dateStr + <span class="string">&quot;0001&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 如果key存在，计数器+1（0002），确保字符串长度为4位</span></span><br><span class="line">    <span class="keyword">return</span> dateStr+StrUtil.padPre(redisTemplate.opsForValue().increment(key).toString(),<span class="number">4</span>,<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 检查设备是否已有未完成的同类型工单。</span></span><br><span class="line"><span class="comment"> * 本方法用于在创建新工单前，验证指定设备是否已经有处于进行中的同类型工单。</span></span><br><span class="line"><span class="comment"> * 如果存在未完成的同类型工单，则抛出服务异常，阻止新工单的创建。</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> innerCode     设备的内部编码，用于唯一标识设备。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> productTypeId 任务的类型，决定任务的性质（投放、维修、补货、撤机）。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">hasTask</span><span class="params">(String innerCode, Long productTypeId)</span> &#123;</span><br><span class="line">    <span class="comment">// 创建Task对象，并设置设备编号和工单类型ID，以及任务状态为进行中</span></span><br><span class="line">    <span class="type">Task</span> <span class="variable">taskParam</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Task</span>();</span><br><span class="line">    taskParam.setInnerCode(innerCode);</span><br><span class="line">    taskParam.setProductTypeId(productTypeId);</span><br><span class="line">    taskParam.setTaskStatus(DkdContants.TASK_STATUS_PROGRESS);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 查询数据库中符合指定条件的工单列表</span></span><br><span class="line">    List&lt;Task&gt; taskList = taskMapper.selectTaskList(taskParam);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果存在未完成的同类型工单，则抛出服务异常</span></span><br><span class="line">    <span class="keyword">if</span> (CollUtil.isNotEmpty(taskList)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ServiceException</span>(<span class="string">&quot;该设备有未完成的同类型工单，不能重复创建&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据设备的状态和任务类型，验证是否可以创建相应的任务。</span></span><br><span class="line"><span class="comment"> * 如果条件不满足，抛出服务异常。</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> vmStatus      设备的状态，表示设备是否在运行。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> productTypeId 任务的类型，决定任务的性质（投放、维修、补货、撤机）。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">checkCreateTask</span><span class="params">(Long vmStatus, Long productTypeId)</span> &#123;</span><br><span class="line">    <span class="comment">// 如果是投放工单，且设备状态为运行中，则抛出异常，因为设备已在运营中无法进行投放</span></span><br><span class="line">    <span class="keyword">if</span> (productTypeId == DkdContants.TASK_TYPE_DEPLOY &amp;&amp; vmStatus == DkdContants.VM_STATUS_RUNNING) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ServiceException</span>(<span class="string">&quot;该设备状态为运行中，无法进行投放&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果是维修工单，且设备状态不是运行中，则抛出异常，因为设备不在运营中无法进行维修</span></span><br><span class="line">    <span class="keyword">if</span> (productTypeId == DkdContants.TASK_TYPE_REPAIR &amp;&amp; vmStatus != DkdContants.VM_STATUS_RUNNING) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ServiceException</span>(<span class="string">&quot;该设备状态不是运行中，无法进行维修&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果是补货工单，且设备状态不是运行中，则抛出异常，因为设备不在运营状态无法进行补货</span></span><br><span class="line">    <span class="keyword">if</span> (productTypeId == DkdContants.TASK_TYPE_SUPPLY &amp;&amp; vmStatus != DkdContants.VM_STATUS_RUNNING) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ServiceException</span>(<span class="string">&quot;该设备状态不是运行中，无法进行补货&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果是撤机工单，且设备状态不是运行中，则抛出异常，因为设备不在运营状态无法进行撤机</span></span><br><span class="line">    <span class="keyword">if</span> (productTypeId == DkdContants.TASK_TYPE_REVOKE &amp;&amp; vmStatus != DkdContants.VM_STATUS_RUNNING) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ServiceException</span>(<span class="string">&quot;该设备状态不是运行中，无法进行撤机&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="TaskController-1"><a href="#TaskController-1" class="headerlink" title="TaskController"></a>TaskController</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 新增工单</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PreAuthorize(&quot;@ss.hasPermi(&#x27;manage:task:add&#x27;)&quot;)</span></span><br><span class="line"><span class="meta">@Log(title = &quot;工单&quot;, businessType = BusinessType.INSERT)</span></span><br><span class="line"><span class="meta">@PostMapping</span></span><br><span class="line"><span class="keyword">public</span> AjaxResult <span class="title function_">add</span><span class="params">(<span class="meta">@RequestBody</span> TaskDto taskDto)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 设置指派人（登录用户）id</span></span><br><span class="line">    taskDto.setAssignorId(getUserId());</span><br><span class="line">    <span class="keyword">return</span> toAjax(taskService.insertTaskDto(taskDto));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="取消工单"><a href="#取消工单" class="headerlink" title="取消工单"></a>取消工单</h2><h3 id="需求-28"><a href="#需求-28" class="headerlink" title="需求"></a>需求</h3><p>对于未完成的工单，管理员可以进行取消操作</p>
<p><img src="image-20240722200308660.png" alt="image-20240722200308660"></p>
<h3 id="TaskController-2"><a href="#TaskController-2" class="headerlink" title="TaskController"></a>TaskController</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 取消工单</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PreAuthorize(&quot;@ss.hasPermi(&#x27;manage:task:edit&#x27;)&quot;)</span></span><br><span class="line"><span class="meta">@Log(title = &quot;工单&quot;, businessType = BusinessType.UPDATE)</span></span><br><span class="line"><span class="meta">@PutMapping(&quot;/cancel&quot;)</span></span><br><span class="line"><span class="keyword">public</span> AjaxResult <span class="title function_">cancelTask</span><span class="params">(<span class="meta">@RequestBody</span> Task task)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> toAjax(taskService.cancelTask(task));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ITaskService-2"><a href="#ITaskService-2" class="headerlink" title="ITaskService"></a>ITaskService</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 取消工单</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> task</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">cancelTask</span><span class="params">(Task task)</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 取消工单</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> task</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">cancelTask</span><span class="params">(Task task)</span> &#123;</span><br><span class="line">    <span class="comment">//1. 判断工单状态是否可以取消</span></span><br><span class="line">    <span class="comment">// 先根据工单id查询数据库</span></span><br><span class="line">    <span class="type">Task</span> <span class="variable">taskDb</span> <span class="operator">=</span> taskMapper.selectTaskByTaskId(task.getTaskId());</span><br><span class="line">    <span class="comment">// 判断工单状态是否为已取消，如果是，则抛出异常</span></span><br><span class="line">    <span class="keyword">if</span> (taskDb.getTaskStatus().equals(DkdContants.TASK_STATUS_CANCEL)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ServiceException</span>(<span class="string">&quot;该工单已取消了，不能再次取消&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 判断工单状态是否为已完成，如果是，则抛出异常</span></span><br><span class="line">    <span class="keyword">if</span> (taskDb.getTaskStatus().equals(DkdContants.TASK_STATUS_FINISH)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ServiceException</span>(<span class="string">&quot;该工单已完成了，不能取消&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2. 设置更新字段</span></span><br><span class="line">    task.setTaskStatus(DkdContants.TASK_STATUS_CANCEL);<span class="comment">// 工单状态：取消</span></span><br><span class="line">    task.setUpdateTime(DateUtils.getNowDate());<span class="comment">// 更新时间</span></span><br><span class="line">    <span class="comment">//3. 更新工单</span></span><br><span class="line">    <span class="keyword">return</span> taskMapper.updateTask(task);<span class="comment">// 注意别传错了，这里是前端task参数</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="查询补货详情"><a href="#查询补货详情" class="headerlink" title="查询补货详情"></a>查询补货详情</h2><h3 id="需求-29"><a href="#需求-29" class="headerlink" title="需求"></a>需求</h3><p>运营工单页面可以查看补货详情</p>
<p><img src="image-20240727142355125.png" alt="image-20240727142355125"> <img src="image-20240722202046114.png" alt="image-20240722202046114"></p>
<h3 id="TaskDetailsController"><a href="#TaskDetailsController" class="headerlink" title="TaskDetailsController"></a>TaskDetailsController</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查看工单补货详情</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PreAuthorize(&quot;@ss.hasPermi(&#x27;manage:taskDetails:list&#x27;)&quot;)</span></span><br><span class="line"><span class="meta">@GetMapping(value = &quot;/byTaskId/&#123;taskId&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> AjaxResult <span class="title function_">byTaskId</span><span class="params">(<span class="meta">@PathVariable(&quot;taskId&quot;)</span> Long taskId)</span> &#123;</span><br><span class="line">    <span class="type">TaskDetails</span> <span class="variable">taskDetailsParam</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TaskDetails</span>();</span><br><span class="line">    taskDetailsParam.setTaskId(taskId);</span><br><span class="line">    <span class="keyword">return</span> success(taskDetailsService.selectTaskDetailsList(taskDetailsParam));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Knife4j"><a href="#Knife4j" class="headerlink" title="Knife4j"></a>Knife4j</h2><p>如果不习惯使用<code>swagger</code>可以使用<code>前端UI</code>的增强解决方案<code>knife4j</code>，对比<code>swagger</code>相比有以下优势，友好界面，离线文档，接口排序，安全控制，在线调试，文档清晰，注解增强，容易上手。</p>
<p>1、<code>ruoyi-common\pom.xml</code>模块添加整合依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- knife4j --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.xiaoymin<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>knife4j-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>2、<code>views/tool/swagger/index.vue</code>修改跳转访问地址（已完成）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> url = <span class="title function_">ref</span>(<span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">VITE_APP_BASE_API</span> + <span class="string">&quot;/doc.html&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>3、登录系统，访问菜单系统工具/系统接口，出现如下图表示成功。</p>
<p><img src="image-20240729151833677.png" alt="image-20240729151833677"></p>
<p>4、TaskDetailsController添加swagger注解</p>
<ul>
<li><code>@Api</code>: 用于类级别，描述API的标签和描述。</li>
<li><code>@ApiOperation</code>: 用于方法级别，描述一个HTTP操作。</li>
<li><code>@ApiParam</code>: 用于参数级别，描述请求参数。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 工单详情Controller</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> itheima</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2024-07-22</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/manage/taskDetails&quot;)</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;工单详情&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TaskDetailsController</span> <span class="keyword">extends</span> <span class="title class_">BaseController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查看工单补货详情</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;根据工单id查看工单补货详情&quot;)</span></span><br><span class="line">    <span class="meta">@PreAuthorize(&quot;@ss.hasPermi(&#x27;manage:taskDetails:query&#x27;)&quot;)</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/byTaskId/&#123;taskId&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> R&lt;List&lt;TaskDetails&gt;&gt; <span class="title function_">byTaskId</span><span class="params">(</span></span><br><span class="line"><span class="params">        <span class="meta">@ApiParam(value = &quot;工单ID&quot;, required = true)</span> <span class="meta">@PathVariable</span> Long taskId)</span> &#123;</span><br><span class="line">        <span class="type">TaskDetails</span> <span class="variable">taskDetailsParam</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TaskDetails</span>();</span><br><span class="line">        taskDetailsParam.setTaskId(taskId);</span><br><span class="line">        <span class="keyword">return</span> R.ok(taskDetailsService.selectTaskDetailsList(taskDetailsParam));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：若依框架的AjaxResult由于继承自HashMap导致与Swagger和knife4j不兼容的问题，选择替换返回值类型为R以解决Swagger解析问题，减少整体改动量。</p>
</blockquote>
<p>5、TaskDetails实体类添加swagger注解</p>
<ul>
<li><code>@ApiModelProperty</code>注解来描述每个字段的意义</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 工单详情对象 tb_task_details</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> itheima</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2024-07-22</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@ApiModel(description = &quot;任务详情对象&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TaskDetails</span> <span class="keyword">extends</span> <span class="title class_">BaseEntity</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** $column.columnComment */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;任务详情ID&quot;, hidden = true)</span></span><br><span class="line">    <span class="keyword">private</span> Long detailsId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** 工单Id */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;工单Id&quot;)</span></span><br><span class="line">    <span class="meta">@Excel(name = &quot;工单Id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long taskId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** 货道编号 */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;货道编号&quot;)</span></span><br><span class="line">    <span class="meta">@Excel(name = &quot;货道编号&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String channelCode;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** 补货期望容量 */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;补货期望容量&quot;)</span></span><br><span class="line">    <span class="meta">@Excel(name = &quot;补货期望容量&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long expectCapacity;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** 商品Id */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;商品Id&quot;)</span></span><br><span class="line">    <span class="meta">@Excel(name = &quot;商品Id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long skuId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** $column.columnComment */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;商品名称&quot;)</span></span><br><span class="line">    <span class="meta">@Excel(name = &quot;$&#123;comment&#125;&quot;, readConverterExp = &quot;$column.readConverterExp()&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String skuName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** $column.columnComment */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;商品图片&quot;)</span></span><br><span class="line">    <span class="meta">@Excel(name = &quot;$&#123;comment&#125;&quot;, readConverterExp = &quot;$column.readConverterExp()&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String skuImage;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>6、接口测试</p>
<p><img src="image-20240729161029907.png" alt="image-20240729161029907"></p>
<p>7、设置文档信息</p>
<p><img src="image-20240730105638809.png" alt="image-20240730105638809"></p>
<h1 id="运营管理App"><a href="#运营管理App" class="headerlink" title="运营管理App"></a>运营管理App</h1><h2 id="Android模拟器"><a href="#Android模拟器" class="headerlink" title="Android模拟器"></a>Android模拟器</h2><p>本项目的App客户端部分已经由前端团队进行开发完成，并且以apk的方式提供出来，供我们测试使用，如果要运行apk，需要先安装安卓的模拟器。</p>
<p>可以选择国内的安卓模拟器产品，比如：网易mumu、雷电、夜神等。课程中使用网易mumu模拟器，官网地址：<a target="_blank" rel="noopener" href="http://mumu.172.com/。">http://mumu.172.com/。</a></p>
<p>资料中提供了mumu安装包，大家安装到非中文路径即可。</p>
<p><img src="image-20240729103454163.png" alt="image-20240729103454163"></p>
<p>资料中提供了运营管理App端安装包</p>
<p><img src="image-20240729104324699.png" alt="image-20240729104324699"></p>
<p>需要让模拟器中的App能够连接我们自己本地代码，需要修改下URL地址:</p>
<p><img src="image-20230524223644828.png" alt="image-20230524223644828"></p>
<h2 id="Java后端"><a href="#Java后端" class="headerlink" title="Java后端"></a>Java后端</h2><p>本项目运营管理App的java后端已开发完成，在资料中已提供源码，导入idea中即可</p>
<p><img src="image-20240729110127325.png" alt="image-20240729110127325"></p>
<p>本项目连接的也是dkd数据库，如果密码不是root可以进行修改</p>
<p><img src="image-20240729110248889.png" alt="image-20240729110248889"></p>
<h2 id="功能测试"><a href="#功能测试" class="headerlink" title="功能测试"></a>功能测试</h2><h3 id="投放工单"><a href="#投放工单" class="headerlink" title="投放工单"></a>投放工单</h3><p>帝可得管理端，创建新设备</p>
<p><img src="image-20240729112910697.png" alt="image-20240729112910697"></p>
<p><img src="image-20240729111817519.png" alt="image-20240729111817519"></p>
<p>帝可得管理端，创建投放工单</p>
<p><img src="image-20240729112854709.png" alt="image-20240729112854709"></p>
<p><img src="image-20240729111836202.png" alt="image-20240729111836202"></p>
<p>运营管理App端登录负责此工单员工，即可查看待办工单，可以选择拒绝、接受</p>
<p><img src="image-20240729112052191.png" alt="image-20240729112052191"> <img src="image-20240729112117934.png" alt="image-20240729112117934"></p>
<p>如果点击接受，帝可得管理端工单状态改为进行</p>
<p><img src="image-20240729112211068.png" alt="image-20240729112211068"></p>
<p>在进行工单界面，可以点击查看详情，选择取消、完成</p>
<p><img src="image-20240729112418567.png" alt="image-20240729112418567"> <img src="image-20240729112340223.png" alt="image-20240729112340223"></p>
<p>如果点击完成工单，帝可得管理端工单状态改为完成</p>
<p><img src="image-20240729112501205.png" alt="image-20240729112501205"></p>
<p>帝可得管理端设备状态改为运营，表示设备投放成功</p>
<p><img src="image-20240729112529929.png" alt="image-20240729112529929"></p>
<h3 id="补货工单"><a href="#补货工单" class="headerlink" title="补货工单"></a>补货工单</h3><p>帝可得管理端，货道关联商品（大家练习时，可以全部关联）</p>
<p><img src="image-20240729112634816.png" alt="image-20240729112634816"></p>
<p>帝可得管理端，创建补货工单</p>
<p><img src="image-20240729112954052.png" alt="image-20240729112954052"></p>
<p><img src="image-20240729113007035.png" alt="image-20240729113007035"></p>
<p>运营管理App端登录负责此工单员工，即可查看待办工单，可以选择拒绝、接受</p>
<p><img src="image-20240729113050603.png" alt="image-20240729113050603"> <img src="image-20240729113059353.png" alt="image-20240729113059353"></p>
<p>如果点击接受，帝可得管理端工单状态改为进行</p>
<p><img src="image-20240729113149947.png" alt="image-20240729113149947"></p>
<p>在进行工单界面，可以点击查看详情，选择取消、完成</p>
<p><img src="image-20240729113246006.png" alt="image-20240729113246006"> <img src="image-20240729113259266.png" alt="image-20240729113259266"></p>
<p>如果点击完成工单，帝可得管理端工单状态改为完成</p>
<p><img src="image-20240729113804130.png" alt="image-20240729113804130"></p>
<p>数据库货道表的库存已同步更新</p>
<p><img src="image-20240729113930117.png" alt="image-20240729113930117"></p>
<h2 id="源码介绍"><a href="#源码介绍" class="headerlink" title="源码介绍"></a>源码介绍</h2><p>运营管理App的java后端技术栈：SpringBoot+MybatisPlus+阿里云短信</p>
<p><img src="image-20240729114254099.png" alt="image-20240729114254099"></p>
<h1 id="设备屏幕端"><a href="#设备屏幕端" class="headerlink" title="设备屏幕端"></a>设备屏幕端</h1><p>商品列表—选择支付方式—显示支付二维码—用户扫码完成支付</p>
<p><img src="image-20240729143120206.png" alt="image-20240729143120206"></p>
<h2 id="设备屏幕"><a href="#设备屏幕" class="headerlink" title="设备屏幕"></a>设备屏幕</h2><p>本项目的设备屏幕客户端部分已经由前端团队进行开发完成，在资料中已提供源码，双击打开<code>index.html</code>即可</p>
<p><img src="image-20240729141233202.png" alt="image-20240729141233202"></p>
<h2 id="Java后端-1"><a href="#Java后端-1" class="headerlink" title="Java后端"></a>Java后端</h2><p>本项目设备屏幕端的java后端已开发完成，在资料中已提供源码，导入idea中即可</p>
<p><img src="image-20240729141617690.png" alt="image-20240729141617690"></p>
<h2 id="功能测试-1"><a href="#功能测试-1" class="headerlink" title="功能测试"></a>功能测试</h2><p>在设备屏幕端加上<code>innerCode=设备编号</code>，即可显示当前设备货道信息</p>
<p><img src="image-20240729142202566.png" alt="image-20240729142202566"></p>
<p>帝可得管理端，设备策略分配，设置折扣信息</p>
<p><img src="image-20240729142628648.png" alt="image-20240729142628648"></p>
<p>再次访问设备屏幕端，价格就是折扣的了</p>
<p><img src="image-20240729142715034.png" alt="image-20240729142715034"></p>
<h2 id="支付出货流程"><a href="#支付出货流程" class="headerlink" title="支付出货流程"></a>支付出货流程</h2><p>我们能够从屏幕上看到支付二维码，其实是经历了“长途跋涉” ，屏幕端实际上是一个H5页面，向后端发起支付请求，订单服务首先会创建订单，然后调用第三方支付来获得用于生成支付二维码的链接。</p>
<p>然后订单微服务将二维码链接返回给屏幕端，屏幕端生成二维码图片展示。</p>
<p><img src="image-20240729143443094.png" alt="image-20240729143443094"></p>
<p>用户看到二维码后，拿出手机扫码支付，此时第三方支付平台确认用户支付成功后会回调订单服务。订单服务收到回调信息后修改订单状态，并通知设备发货。</p>
<p><img src="image-20240729143602326.png" alt="image-20240729143602326"></p>
<h2 id="源码介绍-1"><a href="#源码介绍-1" class="headerlink" title="源码介绍"></a>源码介绍</h2><p>设备屏幕端的java后端技术栈：SpringBoot+MybatisPlus</p>
<p><img src="image-20240729143843296.png" alt="image-20240729143843296"></p>
<h1 id="订单管理（作业）"><a href="#订单管理（作业）" class="headerlink" title="订单管理（作业）"></a>订单管理（作业）</h1><h2 id="业务说明"><a href="#业务说明" class="headerlink" title="业务说明"></a>业务说明</h2><p>后台管理人员可以查看订单信息</p>
<p><img src="image-20240729174725280.png" alt="image-20240729174725280"></p>
<p>对于订单数据模型，下面是示意图：</p>
<p><img src="image-20240729143804299.png" alt="image-20240729143804299"></p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/" rel="tag"># 项目实战</a>
              <a href="/tags/%E8%8B%A5%E4%BE%9D/" rel="tag"># 若依</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2025/01/25/Nginx%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/" rel="prev" title="Nginx快速入门">
      <i class="fa fa-chevron-left"></i> Nginx快速入门
    </a></div>
      <div class="post-nav-item">
    <a href="/2025/01/27/%E8%8B%A5%E4%BE%9D%E6%8B%94%E9%AB%98%E5%8E%9F%E7%90%86%E7%AF%87/" rel="next" title="若依拔高原理篇">
      若依拔高原理篇 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.</span> <span class="nav-text">项目介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%94%AE%E8%B4%A7%E6%9C%BA%E7%AE%80%E4%BB%8B"><span class="nav-number">1.1.</span> <span class="nav-text">售货机简介</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%89%A9%E8%81%94%E7%BD%91"><span class="nav-number">1.1.1.</span> <span class="nav-text">物联网</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%94%AE%E8%B4%A7%E6%9C%BA"><span class="nav-number">1.1.2.</span> <span class="nav-text">售货机</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%94%AE%E8%B4%A7%E6%9C%BA%E6%9C%AF%E8%AF%AD"><span class="nav-number">1.2.</span> <span class="nav-text">售货机术语</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%92%E8%89%B2%E4%B8%8E%E5%8A%9F%E8%83%BD"><span class="nav-number">1.3.</span> <span class="nav-text">角色与功能</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%9A%E5%8A%A1%E6%B5%81%E7%A8%8B"><span class="nav-number">1.4.</span> <span class="nav-text">业务流程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B9%B3%E5%8F%B0%E7%AE%A1%E7%90%86%E5%91%98"><span class="nav-number">1.4.1.</span> <span class="nav-text">平台管理员</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%90%E7%BB%B4%E4%BA%BA%E5%91%98"><span class="nav-number">1.4.2.</span> <span class="nav-text">运维人员</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%90%E8%90%A5%E4%BA%BA%E5%91%98"><span class="nav-number">1.4.3.</span> <span class="nav-text">运营人员</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B6%88%E8%B4%B9%E8%80%85"><span class="nav-number">1.4.4.</span> <span class="nav-text">消费者</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%A7%E5%93%81%E5%8E%9F%E5%9E%8B"><span class="nav-number">1.5.</span> <span class="nav-text">产品原型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BA%93%E8%A1%A8%E8%AE%BE%E8%AE%A1"><span class="nav-number">1.6.</span> <span class="nav-text">库表设计</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%9D%E5%A7%8BAI"><span class="nav-number">2.</span> <span class="nav-text">初始AI</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#AIGC"><span class="nav-number">2.1.</span> <span class="nav-text">AIGC</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8F%90%E7%A4%BA%E5%B7%A5%E7%A8%8B"><span class="nav-number">2.2.</span> <span class="nav-text">提示工程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFPrompt"><span class="nav-number">2.2.1.</span> <span class="nav-text">什么是Prompt?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E5%AD%A6%EF%BC%9F"><span class="nav-number">2.2.2.</span> <span class="nav-text">为什么学？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E6%8F%90%E7%A4%BA%E5%B7%A5%E7%A8%8B%EF%BC%9F"><span class="nav-number">2.2.3.</span> <span class="nav-text">什么是提示工程？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Prompt%E7%9A%84%E7%BB%84%E6%88%90"><span class="nav-number">2.2.4.</span> <span class="nav-text">Prompt的组成</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E7%BC%96%E7%A8%8B%E7%9B%B8%E5%85%B3%E7%9A%84Prompt"><span class="nav-number">2.2.5.</span> <span class="nav-text">常见的编程相关的Prompt</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A1%A8%E7%BB%93%E6%9E%84"><span class="nav-number">2.2.5.1.</span> <span class="nav-text">表结构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3"><span class="nav-number">2.2.5.2.</span> <span class="nav-text">生成数据库说明文档</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E4%BB%A3%E7%A0%81"><span class="nav-number">2.2.5.3.</span> <span class="nav-text">生成代码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E4%BB%A3%E7%A0%81%E6%B5%81%E7%A8%8B%E5%9B%BE"><span class="nav-number">2.2.5.4.</span> <span class="nav-text">生成代码流程图</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA"><span class="nav-number">3.</span> <span class="nav-text">项目搭建</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%90%AD%E5%BB%BA%E5%90%8E%E7%AB%AF%E9%A1%B9%E7%9B%AE"><span class="nav-number">3.1.</span> <span class="nav-text">搭建后端项目</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E9%A1%B9%E7%9B%AE"><span class="nav-number">3.1.1.</span> <span class="nav-text">初始化项目</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Git%E4%B8%8B%E8%BD%BD"><span class="nav-number">3.1.1.1.</span> <span class="nav-text">Git下载</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Maven%E6%9E%84%E5%BB%BA"><span class="nav-number">3.1.1.2.</span> <span class="nav-text">Maven构建</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQL%E7%9B%B8%E5%85%B3"><span class="nav-number">3.1.2.</span> <span class="nav-text">MySQL相关</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AF%BC%E5%85%A5sql"><span class="nav-number">3.1.2.1.</span> <span class="nav-text">导入sql</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF"><span class="nav-number">3.1.2.2.</span> <span class="nav-text">配置信息</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Redis%E7%9B%B8%E5%85%B3"><span class="nav-number">3.1.3.</span> <span class="nav-text">Redis相关</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8"><span class="nav-number">3.1.3.1.</span> <span class="nav-text">启动</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF-1"><span class="nav-number">3.1.3.2.</span> <span class="nav-text">配置信息</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E8%BF%90%E8%A1%8C"><span class="nav-number">3.1.4.</span> <span class="nav-text">项目运行</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%90%AD%E5%BB%BA%E5%89%8D%E7%AB%AF%E9%A1%B9%E7%9B%AE"><span class="nav-number">3.2.</span> <span class="nav-text">搭建前端项目</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E9%A1%B9%E7%9B%AE-1"><span class="nav-number">3.2.1.</span> <span class="nav-text">初始化项目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96"><span class="nav-number">3.2.2.</span> <span class="nav-text">安装依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E8%BF%90%E8%A1%8C-1"><span class="nav-number">3.2.3.</span> <span class="nav-text">项目运行</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%82%B9%E4%BD%8D%E7%AE%A1%E7%90%86"><span class="nav-number">4.</span> <span class="nav-text">点位管理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9C%80%E6%B1%82%E8%AF%B4%E6%98%8E"><span class="nav-number">4.1.</span> <span class="nav-text">需求说明</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BA%93%E8%A1%A8%E8%AE%BE%E8%AE%A1-1"><span class="nav-number">4.2.</span> <span class="nav-text">库表设计</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E5%9F%BA%E7%A1%80%E4%BB%A3%E7%A0%81"><span class="nav-number">4.3.</span> <span class="nav-text">生成基础代码</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9C%80%E6%B1%82"><span class="nav-number">4.3.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4"><span class="nav-number">4.3.2.</span> <span class="nav-text">步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%91%A0%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95%E8%8F%9C%E5%8D%95"><span class="nav-number">4.3.2.1.</span> <span class="nav-text">①创建目录菜单</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%91%A1%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8"><span class="nav-number">4.3.2.2.</span> <span class="nav-text">②添加数据字典</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%91%A2%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90%E4%BF%A1%E6%81%AF"><span class="nav-number">4.3.2.3.</span> <span class="nav-text">③配置代码生成信息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%91%A3%E4%B8%8B%E8%BD%BD%E4%BB%A3%E7%A0%81%E5%B9%B6%E5%AF%BC%E5%85%A5%E9%A1%B9%E7%9B%AE"><span class="nav-number">4.3.2.4.</span> <span class="nav-text">④下载代码并导入项目</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8C%BA%E5%9F%9F%E7%AE%A1%E7%90%86%E6%94%B9%E9%80%A0"><span class="nav-number">4.4.</span> <span class="nav-text">区域管理改造</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E9%A1%B5%E9%9D%A2"><span class="nav-number">4.4.1.</span> <span class="nav-text">基础页面</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-1"><span class="nav-number">4.4.1.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="nav-number">4.4.1.2.</span> <span class="nav-text">代码实现</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8C%BA%E5%9F%9F%E5%88%97%E8%A1%A8"><span class="nav-number">4.4.2.</span> <span class="nav-text">区域列表</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-2"><span class="nav-number">4.4.2.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E6%80%9D%E8%B7%AF"><span class="nav-number">4.4.2.2.</span> <span class="nav-text">实现思路</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SQL"><span class="nav-number">4.4.2.3.</span> <span class="nav-text">SQL</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RegionVo"><span class="nav-number">4.4.2.4.</span> <span class="nav-text">RegionVo</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RegionMapper"><span class="nav-number">4.4.2.5.</span> <span class="nav-text">RegionMapper</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RegionMapper-xml"><span class="nav-number">4.4.2.6.</span> <span class="nav-text">RegionMapper.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#mybatis-config-xml"><span class="nav-number">4.4.2.7.</span> <span class="nav-text">mybatis-config.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#IRegionService"><span class="nav-number">4.4.2.8.</span> <span class="nav-text">IRegionService</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RegionServiceImpl"><span class="nav-number">4.4.2.9.</span> <span class="nav-text">RegionServiceImpl</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RegionController"><span class="nav-number">4.4.2.10.</span> <span class="nav-text">RegionController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#region-index-vue"><span class="nav-number">4.4.2.11.</span> <span class="nav-text">region&#x2F;index.vue</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%88%E4%BD%9C%E5%95%86%E7%AE%A1%E7%90%86%E6%94%B9%E9%80%A0"><span class="nav-number">4.5.</span> <span class="nav-text">合作商管理改造</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E9%A1%B5%E9%9D%A2-1"><span class="nav-number">4.5.1.</span> <span class="nav-text">基础页面</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-3"><span class="nav-number">4.5.1.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-1"><span class="nav-number">4.5.1.2.</span> <span class="nav-text">代码实现</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E8%AF%A6%E6%83%85"><span class="nav-number">4.5.2.</span> <span class="nav-text">查看详情</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%88%E4%BD%9C%E5%95%86%E5%88%97%E8%A1%A8"><span class="nav-number">4.5.3.</span> <span class="nav-text">合作商列表</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E6%80%9D%E8%B7%AF-1"><span class="nav-number">4.5.3.1.</span> <span class="nav-text">实现思路</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SQL-1"><span class="nav-number">4.5.3.2.</span> <span class="nav-text">SQL</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PartnerVo"><span class="nav-number">4.5.3.3.</span> <span class="nav-text">PartnerVo</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PartnerMapper"><span class="nav-number">4.5.3.4.</span> <span class="nav-text">PartnerMapper</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PartnerMapper-xml"><span class="nav-number">4.5.3.5.</span> <span class="nav-text">PartnerMapper.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#IPartnerService"><span class="nav-number">4.5.3.6.</span> <span class="nav-text">IPartnerService</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PartnerServiceImpl"><span class="nav-number">4.5.3.7.</span> <span class="nav-text">PartnerServiceImpl</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PartnerController"><span class="nav-number">4.5.3.8.</span> <span class="nav-text">PartnerController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#region-index-vue-1"><span class="nav-number">4.5.3.9.</span> <span class="nav-text">region&#x2F;index.vue</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81"><span class="nav-number">4.5.4.</span> <span class="nav-text">重置密码</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%8E%E7%AB%AF%E9%83%A8%E5%88%86"><span class="nav-number">4.5.4.1.</span> <span class="nav-text">后端部分</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%AB%AF%E9%83%A8%E5%88%86"><span class="nav-number">4.5.4.2.</span> <span class="nav-text">前端部分</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%82%B9%E4%BD%8D%E7%AE%A1%E7%90%86%E6%94%B9%E9%80%A0"><span class="nav-number">4.6.</span> <span class="nav-text">点位管理改造</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E9%A1%B5%E9%9D%A2-2"><span class="nav-number">4.6.1.</span> <span class="nav-text">基础页面</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-4"><span class="nav-number">4.6.1.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-2"><span class="nav-number">4.6.1.2.</span> <span class="nav-text">代码实现</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%82%B9%E4%BD%8D%E5%88%97%E8%A1%A8"><span class="nav-number">4.6.2.</span> <span class="nav-text">点位列表</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-5"><span class="nav-number">4.6.2.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E6%80%9D%E8%B7%AF-2"><span class="nav-number">4.6.2.2.</span> <span class="nav-text">实现思路</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SQL-2"><span class="nav-number">4.6.2.3.</span> <span class="nav-text">SQL</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#NodeVo"><span class="nav-number">4.6.2.4.</span> <span class="nav-text">NodeVo</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#NodeMapper"><span class="nav-number">4.6.2.5.</span> <span class="nav-text">NodeMapper</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#NodeMapper-xml"><span class="nav-number">4.6.2.6.</span> <span class="nav-text">NodeMapper.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#NodeService"><span class="nav-number">4.6.2.7.</span> <span class="nav-text">NodeService</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#NodeServiceImpl"><span class="nav-number">4.6.2.8.</span> <span class="nav-text">NodeServiceImpl</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#NodeController"><span class="nav-number">4.6.2.9.</span> <span class="nav-text">NodeController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#node-index-vue"><span class="nav-number">4.6.2.10.</span> <span class="nav-text">node&#x2F;index.vue</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8C%BA%E5%9F%9F%E6%9F%A5%E7%9C%8B%E8%AF%A6%E6%83%85"><span class="nav-number">4.7.</span> <span class="nav-text">区域查看详情</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7"><span class="nav-number">4.8.</span> <span class="nav-text">数据完整性</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%BA%E5%91%98%E7%AE%A1%E7%90%86"><span class="nav-number">5.</span> <span class="nav-text">人员管理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9C%80%E6%B1%82%E8%AF%B4%E6%98%8E-1"><span class="nav-number">5.1.</span> <span class="nav-text">需求说明</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E5%9F%BA%E7%A1%80%E4%BB%A3%E7%A0%81-1"><span class="nav-number">5.2.</span> <span class="nav-text">生成基础代码</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-6"><span class="nav-number">5.2.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-1"><span class="nav-number">5.2.2.</span> <span class="nav-text">步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%91%A0%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95%E8%8F%9C%E5%8D%95-1"><span class="nav-number">5.2.2.1.</span> <span class="nav-text">①创建目录菜单</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%91%A1%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8-1"><span class="nav-number">5.2.2.2.</span> <span class="nav-text">②添加数据字典</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%91%A2%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90%E4%BF%A1%E6%81%AF-1"><span class="nav-number">5.2.2.3.</span> <span class="nav-text">③配置代码生成信息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%91%A3%E4%B8%8B%E8%BD%BD%E4%BB%A3%E7%A0%81%E5%B9%B6%E5%AF%BC%E5%85%A5%E9%A1%B9%E7%9B%AE-1"><span class="nav-number">5.2.2.4.</span> <span class="nav-text">④下载代码并导入项目</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%BA%E5%91%98%E5%88%97%E8%A1%A8%E6%94%B9%E9%80%A0"><span class="nav-number">5.3.</span> <span class="nav-text">人员列表改造</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E9%A1%B5%E9%9D%A2-3"><span class="nav-number">5.3.1.</span> <span class="nav-text">基础页面</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-7"><span class="nav-number">5.3.1.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-3"><span class="nav-number">5.3.1.2.</span> <span class="nav-text">代码实现</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%8C%E6%AD%A5%E5%AD%98%E5%82%A8"><span class="nav-number">5.3.2.</span> <span class="nav-text">同步存储</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E6%80%9D%E8%B7%AF-3"><span class="nav-number">5.3.2.1.</span> <span class="nav-text">实现思路</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sql"><span class="nav-number">5.3.2.2.</span> <span class="nav-text">sql</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#EmpMapper"><span class="nav-number">5.3.2.3.</span> <span class="nav-text">EmpMapper</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RegionServiceImpl-1"><span class="nav-number">5.3.2.4.</span> <span class="nav-text">RegionServiceImpl</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8"><span class="nav-number">5.4.</span> <span class="nav-text">文件存储</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%AC%E5%9C%B0%E5%AD%98%E5%82%A8"><span class="nav-number">5.4.1.</span> <span class="nav-text">本地存储</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%98%BF%E9%87%8C%E4%BA%91OSS"><span class="nav-number">5.4.2.</span> <span class="nav-text">阿里云OSS</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%8B%E7%BB%8D"><span class="nav-number">5.4.2.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B4%A6%E5%8F%B7%E5%87%86%E5%A4%87"><span class="nav-number">5.4.2.2.</span> <span class="nav-text">账号准备</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%80%E9%80%9AOSS%E4%BA%91%E6%9C%8D%E5%8A%A1"><span class="nav-number">5.4.2.3.</span> <span class="nav-text">开通OSS云服务</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AEAK-amp-SK"><span class="nav-number">5.4.2.4.</span> <span class="nav-text">配置AK &amp; SK</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%A5%E9%97%A8"><span class="nav-number">5.4.2.5.</span> <span class="nav-text">入门</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#x-file-storage"><span class="nav-number">5.4.3.</span> <span class="nav-text">x-file-storage</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%8B%E7%BB%8D-1"><span class="nav-number">5.4.3.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9B%86%E6%88%90"><span class="nav-number">5.4.3.2.</span> <span class="nav-text">集成</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86"><span class="nav-number">6.</span> <span class="nav-text">设备管理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9C%80%E6%B1%82%E8%AF%B4%E6%98%8E-2"><span class="nav-number">6.1.</span> <span class="nav-text">需求说明</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E5%9F%BA%E7%A1%80%E4%BB%A3%E7%A0%81-2"><span class="nav-number">6.2.</span> <span class="nav-text">生成基础代码</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-8"><span class="nav-number">6.2.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-2"><span class="nav-number">6.2.2.</span> <span class="nav-text">步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%91%A0%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95%E8%8F%9C%E5%8D%95-2"><span class="nav-number">6.2.2.1.</span> <span class="nav-text">①创建目录菜单</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%91%A1%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8-2"><span class="nav-number">6.2.2.2.</span> <span class="nav-text">②添加数据字典</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%91%A2%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90%E4%BF%A1%E6%81%AF-2"><span class="nav-number">6.2.2.3.</span> <span class="nav-text">③配置代码生成信息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%91%A3%E4%B8%8B%E8%BD%BD%E4%BB%A3%E7%A0%81%E5%B9%B6%E5%AF%BC%E5%85%A5%E9%A1%B9%E7%9B%AE-2"><span class="nav-number">6.2.2.4.</span> <span class="nav-text">④下载代码并导入项目</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E7%B1%BB%E5%9E%8B%E6%94%B9%E9%80%A0"><span class="nav-number">6.3.</span> <span class="nav-text">设备类型改造</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E9%A1%B5%E9%9D%A2-4"><span class="nav-number">6.3.1.</span> <span class="nav-text">基础页面</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-9"><span class="nav-number">6.3.1.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-4"><span class="nav-number">6.3.1.2.</span> <span class="nav-text">代码实现</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86%E6%94%B9%E9%80%A0"><span class="nav-number">6.4.</span> <span class="nav-text">设备管理改造</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E9%A1%B5%E9%9D%A2-5"><span class="nav-number">6.4.1.</span> <span class="nav-text">基础页面</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-10"><span class="nav-number">6.4.1.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-5"><span class="nav-number">6.4.1.2.</span> <span class="nav-text">代码实现</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B0%E5%A2%9E%E8%AE%BE%E5%A4%87"><span class="nav-number">6.4.2.</span> <span class="nav-text">新增设备</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-11"><span class="nav-number">6.4.2.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#VendingMachineServiceImpl"><span class="nav-number">6.4.2.2.</span> <span class="nav-text">VendingMachineServiceImpl</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ChannelMapper%E6%8E%A5%E5%8F%A3%E5%92%8Cxml"><span class="nav-number">6.4.2.3.</span> <span class="nav-text">ChannelMapper接口和xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#IChannelService"><span class="nav-number">6.4.2.4.</span> <span class="nav-text">IChannelService</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ChannelServiceImpl"><span class="nav-number">6.4.2.5.</span> <span class="nav-text">ChannelServiceImpl</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E8%AE%BE%E5%A4%87"><span class="nav-number">6.4.3.</span> <span class="nav-text">修改设备</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-12"><span class="nav-number">6.4.3.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#VendingMachineServiceImpl-1"><span class="nav-number">6.4.3.2.</span> <span class="nav-text">VendingMachineServiceImpl</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E7%8A%B6%E6%80%81%E6%94%B9%E9%80%A0"><span class="nav-number">6.5.</span> <span class="nav-text">设备状态改造</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E8%A7%86%E5%9B%BE%E7%BB%84%E4%BB%B6"><span class="nav-number">6.5.1.</span> <span class="nav-text">创建视图组件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E4%BA%8C%E7%BA%A7%E8%8F%9C%E5%8D%95"><span class="nav-number">6.5.2.</span> <span class="nav-text">创建二级菜单</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%B9%E9%80%A0%E8%A7%86%E5%9B%BE%E7%BB%84%E4%BB%B6"><span class="nav-number">6.5.3.</span> <span class="nav-text">改造视图组件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%82%B9%E4%BD%8D%E6%9F%A5%E7%9C%8B%E8%AF%A6%E6%83%85"><span class="nav-number">6.6.</span> <span class="nav-text">点位查看详情</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AD%96%E7%95%A5%E7%AE%A1%E7%90%86"><span class="nav-number">7.</span> <span class="nav-text">策略管理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9C%80%E6%B1%82%E8%AF%B4%E6%98%8E-3"><span class="nav-number">7.1.</span> <span class="nav-text">需求说明</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E5%9F%BA%E7%A1%80%E4%BB%A3%E7%A0%81-3"><span class="nav-number">7.2.</span> <span class="nav-text">生成基础代码</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-13"><span class="nav-number">7.2.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-3"><span class="nav-number">7.2.2.</span> <span class="nav-text">步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%91%A0%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95%E8%8F%9C%E5%8D%95-3"><span class="nav-number">7.2.2.1.</span> <span class="nav-text">①创建目录菜单</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%91%A1%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90%E4%BF%A1%E6%81%AF"><span class="nav-number">7.2.2.2.</span> <span class="nav-text">②配置代码生成信息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%91%A2%E4%B8%8B%E8%BD%BD%E4%BB%A3%E7%A0%81%E5%B9%B6%E5%AF%BC%E5%85%A5%E9%A1%B9%E7%9B%AE"><span class="nav-number">7.2.2.3.</span> <span class="nav-text">③下载代码并导入项目</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AD%96%E7%95%A5%E7%AE%A1%E7%90%86%E6%94%B9%E9%80%A0"><span class="nav-number">7.3.</span> <span class="nav-text">策略管理改造</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E9%A1%B5%E9%9D%A2-6"><span class="nav-number">7.3.1.</span> <span class="nav-text">基础页面</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-14"><span class="nav-number">7.3.1.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-6"><span class="nav-number">7.3.1.2.</span> <span class="nav-text">代码实现</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E8%AF%A6%E6%83%85-1"><span class="nav-number">7.3.2.</span> <span class="nav-text">查看详情</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-15"><span class="nav-number">7.3.2.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-7"><span class="nav-number">7.3.2.2.</span> <span class="nav-text">代码实现</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E7%AD%96%E7%95%A5%E5%88%86%E9%85%8D"><span class="nav-number">7.4.</span> <span class="nav-text">设备策略分配</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-16"><span class="nav-number">7.4.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-8"><span class="nav-number">7.4.2.</span> <span class="nav-text">代码实现</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%95%86%E5%93%81%E7%AE%A1%E7%90%86"><span class="nav-number">8.</span> <span class="nav-text">商品管理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9C%80%E6%B1%82%E8%AF%B4%E6%98%8E-4"><span class="nav-number">8.1.</span> <span class="nav-text">需求说明</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E5%9F%BA%E7%A1%80%E4%BB%A3%E7%A0%81-4"><span class="nav-number">8.2.</span> <span class="nav-text">生成基础代码</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-17"><span class="nav-number">8.2.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-4"><span class="nav-number">8.2.2.</span> <span class="nav-text">步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%91%A0%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95%E8%8F%9C%E5%8D%95-4"><span class="nav-number">8.2.2.1.</span> <span class="nav-text">①创建目录菜单</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%91%A1%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90%E4%BF%A1%E6%81%AF-1"><span class="nav-number">8.2.2.2.</span> <span class="nav-text">②配置代码生成信息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%91%A2%E4%B8%8B%E8%BD%BD%E4%BB%A3%E7%A0%81%E5%B9%B6%E5%AF%BC%E5%85%A5%E9%A1%B9%E7%9B%AE-1"><span class="nav-number">8.2.2.3.</span> <span class="nav-text">③下载代码并导入项目</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%95%86%E5%93%81%E7%B1%BB%E5%9E%8B%E6%94%B9%E9%80%A0"><span class="nav-number">8.3.</span> <span class="nav-text">商品类型改造</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E9%A1%B5%E9%9D%A2-7"><span class="nav-number">8.3.1.</span> <span class="nav-text">基础页面</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-18"><span class="nav-number">8.3.1.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-9"><span class="nav-number">8.3.1.2.</span> <span class="nav-text">代码实现</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%95%86%E5%93%81%E7%AE%A1%E7%90%86%E6%94%B9%E9%80%A0"><span class="nav-number">8.4.</span> <span class="nav-text">商品管理改造</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E9%A1%B5%E9%9D%A2-8"><span class="nav-number">8.4.1.</span> <span class="nav-text">基础页面</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-19"><span class="nav-number">8.4.1.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-10"><span class="nav-number">8.4.1.2.</span> <span class="nav-text">代码实现</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%95%86%E5%93%81%E5%88%A0%E9%99%A4"><span class="nav-number">8.4.2.</span> <span class="nav-text">商品删除</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-20"><span class="nav-number">8.4.2.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SkuServiceImpl"><span class="nav-number">8.4.2.2.</span> <span class="nav-text">SkuServiceImpl</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#IChannelService-1"><span class="nav-number">8.4.2.3.</span> <span class="nav-text">IChannelService</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ChannelServiceImpl-1"><span class="nav-number">8.4.2.4.</span> <span class="nav-text">ChannelServiceImpl</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ChannelMapper%E6%8E%A5%E5%8F%A3%E5%92%8Cxml-1"><span class="nav-number">8.4.2.5.</span> <span class="nav-text">ChannelMapper接口和xml</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%B9%E9%87%8F%E5%AF%BC%E5%85%A5"><span class="nav-number">8.5.</span> <span class="nav-text">批量导入</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-21"><span class="nav-number">8.5.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%89%8D%E7%AB%AF"><span class="nav-number">8.5.2.</span> <span class="nav-text">前端</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%8E%E7%AB%AF"><span class="nav-number">8.5.3.</span> <span class="nav-text">后端</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#SkuController"><span class="nav-number">8.5.3.1.</span> <span class="nav-text">SkuController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SKuMapper"><span class="nav-number">8.5.3.2.</span> <span class="nav-text">SKuMapper</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ISkuService"><span class="nav-number">8.5.3.3.</span> <span class="nav-text">ISkuService</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#EasyExcel"><span class="nav-number">8.6.</span> <span class="nav-text">EasyExcel</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%8B%E7%BB%8D-2"><span class="nav-number">8.6.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E9%9B%86%E6%88%90"><span class="nav-number">8.6.2.</span> <span class="nav-text">项目集成</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B4%A7%E9%81%93%E5%85%B3%E8%81%94%E5%95%86%E5%93%81"><span class="nav-number">8.7.</span> <span class="nav-text">货道关联商品</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-22"><span class="nav-number">8.7.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B4%A7%E9%81%93%E5%AF%B9%E8%AF%9D%E6%A1%86"><span class="nav-number">8.7.2.</span> <span class="nav-text">货道对话框</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2%E8%B4%A7%E9%81%93%E5%88%97%E8%A1%A8"><span class="nav-number">8.7.3.</span> <span class="nav-text">查询货道列表</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ChannelVo"><span class="nav-number">8.7.3.1.</span> <span class="nav-text">ChannelVo</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ChannelMapper%E5%92%8Cxml"><span class="nav-number">8.7.3.2.</span> <span class="nav-text">ChannelMapper和xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#IChannelService%E6%8E%A5%E5%8F%A3%E5%92%8C%E5%AE%9E%E7%8E%B0"><span class="nav-number">8.7.3.3.</span> <span class="nav-text">IChannelService接口和实现</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ChannelController"><span class="nav-number">8.7.3.4.</span> <span class="nav-text">ChannelController</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B4%A7%E9%81%93%E5%85%B3%E8%81%94%E5%95%86%E5%93%81-1"><span class="nav-number">8.7.4.</span> <span class="nav-text">货道关联商品</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ChannelSkuDto"><span class="nav-number">8.7.4.1.</span> <span class="nav-text">ChannelSkuDto</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ChannelConfigDto"><span class="nav-number">8.7.4.2.</span> <span class="nav-text">ChannelConfigDto</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ChannelMapper%E5%92%8Cxml-1"><span class="nav-number">8.7.4.3.</span> <span class="nav-text">ChannelMapper和xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#application-druid-yml"><span class="nav-number">8.7.4.4.</span> <span class="nav-text">application-druid.yml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#IChannelService%E6%8E%A5%E5%8F%A3%E5%92%8C%E5%AE%9E%E7%8E%B0-1"><span class="nav-number">8.7.4.5.</span> <span class="nav-text">IChannelService接口和实现</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ChannelController-1"><span class="nav-number">8.7.4.6.</span> <span class="nav-text">ChannelController</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B7%A5%E5%8D%95%E7%AE%A1%E7%90%86"><span class="nav-number">9.</span> <span class="nav-text">工单管理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9C%80%E6%B1%82%E8%AF%B4%E6%98%8E-5"><span class="nav-number">9.1.</span> <span class="nav-text">需求说明</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90"><span class="nav-number">9.2.</span> <span class="nav-text">基础代码生成</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-23"><span class="nav-number">9.2.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-5"><span class="nav-number">9.2.2.</span> <span class="nav-text">步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%91%A0%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95%E8%8F%9C%E5%8D%95-5"><span class="nav-number">9.2.2.1.</span> <span class="nav-text">①创建目录菜单</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%91%A1%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8-3"><span class="nav-number">9.2.2.2.</span> <span class="nav-text">②添加数据字典</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%91%A2%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90%E4%BF%A1%E6%81%AF-3"><span class="nav-number">9.2.2.3.</span> <span class="nav-text">③配置代码生成信息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%91%A3%E4%B8%8B%E8%BD%BD%E4%BB%A3%E7%A0%81%E5%B9%B6%E5%AF%BC%E5%85%A5%E9%A1%B9%E7%9B%AE-3"><span class="nav-number">9.2.2.4.</span> <span class="nav-text">④下载代码并导入项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%91%A4%E9%85%8D%E7%BD%AE%E5%B7%A5%E5%8D%95%E5%89%8D%E7%AB%AF%E4%BB%A3%E7%A0%81"><span class="nav-number">9.2.2.5.</span> <span class="nav-text">⑤配置工单前端代码</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E5%A4%8Dbug"><span class="nav-number">9.2.3.</span> <span class="nav-text">修复bug</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2%E5%B7%A5%E5%8D%95%E5%88%97%E8%A1%A8"><span class="nav-number">9.3.</span> <span class="nav-text">查询工单列表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-24"><span class="nav-number">9.3.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TaskVo"><span class="nav-number">9.3.2.</span> <span class="nav-text">TaskVo</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TaskMapper"><span class="nav-number">9.3.3.</span> <span class="nav-text">TaskMapper</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ITaskService"><span class="nav-number">9.3.4.</span> <span class="nav-text">ITaskService</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TaskController"><span class="nav-number">9.3.5.</span> <span class="nav-text">TaskController</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E8%BF%90%E8%90%A5%E4%BA%BA%E5%91%98%E5%88%97%E8%A1%A8"><span class="nav-number">9.4.</span> <span class="nav-text">获取运营人员列表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-25"><span class="nav-number">9.4.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#VendingMachineMapper"><span class="nav-number">9.4.2.</span> <span class="nav-text">VendingMachineMapper</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IVendingMachineService"><span class="nav-number">9.4.3.</span> <span class="nav-text">IVendingMachineService</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DkdContants"><span class="nav-number">9.4.4.</span> <span class="nav-text">DkdContants</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EmpController"><span class="nav-number">9.4.5.</span> <span class="nav-text">EmpController</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E8%BF%90%E7%BB%B4%E4%BA%BA%E5%91%98%E5%88%97%E8%A1%A8"><span class="nav-number">9.5.</span> <span class="nav-text">获取运维人员列表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-26"><span class="nav-number">9.5.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EmpController-1"><span class="nav-number">9.5.2.</span> <span class="nav-text">EmpController</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%B0%E5%A2%9E%E5%B7%A5%E5%8D%95"><span class="nav-number">9.6.</span> <span class="nav-text">新增工单</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-27"><span class="nav-number">9.6.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%9D%E8%B7%AF"><span class="nav-number">9.6.2.</span> <span class="nav-text">思路</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TaskDetailsDto"><span class="nav-number">9.6.3.</span> <span class="nav-text">TaskDetailsDto</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TaskDto"><span class="nav-number">9.6.4.</span> <span class="nav-text">TaskDto</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TaskDetailsMapper"><span class="nav-number">9.6.5.</span> <span class="nav-text">TaskDetailsMapper</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ITaskDetailsService"><span class="nav-number">9.6.6.</span> <span class="nav-text">ITaskDetailsService</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ITaskService-1"><span class="nav-number">9.6.7.</span> <span class="nav-text">ITaskService</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TaskController-1"><span class="nav-number">9.6.8.</span> <span class="nav-text">TaskController</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%96%E6%B6%88%E5%B7%A5%E5%8D%95"><span class="nav-number">9.7.</span> <span class="nav-text">取消工单</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-28"><span class="nav-number">9.7.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TaskController-2"><span class="nav-number">9.7.2.</span> <span class="nav-text">TaskController</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ITaskService-2"><span class="nav-number">9.7.3.</span> <span class="nav-text">ITaskService</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2%E8%A1%A5%E8%B4%A7%E8%AF%A6%E6%83%85"><span class="nav-number">9.8.</span> <span class="nav-text">查询补货详情</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-29"><span class="nav-number">9.8.1.</span> <span class="nav-text">需求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TaskDetailsController"><span class="nav-number">9.8.2.</span> <span class="nav-text">TaskDetailsController</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Knife4j"><span class="nav-number">9.9.</span> <span class="nav-text">Knife4j</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%BF%90%E8%90%A5%E7%AE%A1%E7%90%86App"><span class="nav-number">10.</span> <span class="nav-text">运营管理App</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Android%E6%A8%A1%E6%8B%9F%E5%99%A8"><span class="nav-number">10.1.</span> <span class="nav-text">Android模拟器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Java%E5%90%8E%E7%AB%AF"><span class="nav-number">10.2.</span> <span class="nav-text">Java后端</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95"><span class="nav-number">10.3.</span> <span class="nav-text">功能测试</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8A%95%E6%94%BE%E5%B7%A5%E5%8D%95"><span class="nav-number">10.3.1.</span> <span class="nav-text">投放工单</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A5%E8%B4%A7%E5%B7%A5%E5%8D%95"><span class="nav-number">10.3.2.</span> <span class="nav-text">补货工单</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BA%90%E7%A0%81%E4%BB%8B%E7%BB%8D"><span class="nav-number">10.4.</span> <span class="nav-text">源码介绍</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E5%B1%8F%E5%B9%95%E7%AB%AF"><span class="nav-number">11.</span> <span class="nav-text">设备屏幕端</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E5%B1%8F%E5%B9%95"><span class="nav-number">11.1.</span> <span class="nav-text">设备屏幕</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Java%E5%90%8E%E7%AB%AF-1"><span class="nav-number">11.2.</span> <span class="nav-text">Java后端</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-1"><span class="nav-number">11.3.</span> <span class="nav-text">功能测试</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%94%AF%E4%BB%98%E5%87%BA%E8%B4%A7%E6%B5%81%E7%A8%8B"><span class="nav-number">11.4.</span> <span class="nav-text">支付出货流程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BA%90%E7%A0%81%E4%BB%8B%E7%BB%8D-1"><span class="nav-number">11.5.</span> <span class="nav-text">源码介绍</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89"><span class="nav-number">12.</span> <span class="nav-text">订单管理（作业）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%9A%E5%8A%A1%E8%AF%B4%E6%98%8E"><span class="nav-number">12.1.</span> <span class="nav-text">业务说明</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Zongqing Li"
      src="https://github.com/hqulzq/hqulzq.github.io/blob/main/images/userimg.jpg?raw=true">
  <p class="site-author-name" itemprop="name">Zongqing Li</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">42</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">31</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/hqulzq" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hqulzq" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hqulzq@163.com" title="E-Mail → mailto:hqulzq@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

      
<script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
<script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
<div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div id="myCanvasContainer" class="widget tagcloud">
        <canvas width="250" height="250" id="resCanvas" style="width=100%">
            <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Bug%E6%80%BB%E7%BB%93/" rel="tag">Bug总结</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/" rel="tag">Git</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kafka/" rel="tag">Kafka</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Knife4j/" rel="tag">Knife4j</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MinIO/" rel="tag">MinIO</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mybatis-Plus/" rel="tag">Mybatis-Plus</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nginx/" rel="tag">Nginx</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RabbitMQ/" rel="tag">RabbitMQ</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/" rel="tag">Redis</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RocketMQ/" rel="tag">RocketMQ</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/diffusion/" rel="tag">diffusion</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/" rel="tag">docker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/k8s/" rel="tag">k8s</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/latex/" rel="tag">latex</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/leetcode/" rel="tag">leetcode</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/" rel="tag">mongodb</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/" rel="tag">mysql</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BB%A3%E7%A0%81%E9%9A%8F%E6%83%B3%E5%BD%95/" rel="tag">代码随想录</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%B4%E5%87%BD%E6%95%B0/" rel="tag">头函数</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B0%9A%E5%BA%AD%E5%85%AC%E5%AF%93/" rel="tag">尚庭公寓</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/" rel="tag">异常处理</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/" rel="tag">快速入门</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF%E6%80%BB%E7%BB%93/" rel="tag">技术总结</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E7%BB%84/" rel="tag">数组</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B3%A8%E8%A7%A3/" rel="tag">注解</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%8B%A5%E4%BE%9D/" rel="tag">若依</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BA%E6%96%87/" rel="tag">论文</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%93%BE%E8%A1%A8i/" rel="tag">链表i</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/" rel="tag">项目实战</a><span class="tag-list-count">6</span></li></ul>
        </canvas>
    </div>
</div>



    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zongqing Li</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>









<script>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>




  

  

  

  
  <style>
    .copy-btn {
      display: inline-block;
      padding: 6px 12px;
      font-size: 13px;
      font-weight: 700;
      line-height: 20px;
      color: #4D4D4C;
      white-space: nowrap;
      vertical-align: middle;
      cursor: pointer;
      background-color: #F7F7F7;
      background-image: linear-gradient(#F7F7F7, #F7F7F7);
      border: 1px solid #d5d5d5;
      border-radius: 3px;
      user-select: none;
      outline: 0;
    }

    .highlight-wrap .copy-btn {
      transition: opacity .3s ease-in-out;
      opacity: 0;
      padding: 2px 6px;
      position: absolute;
      right: 4px;
      top: 8px;
    }

    .highlight-wrap:hover .copy-btn,
    .highlight-wrap .copy-btn:focus {
      opacity: 1
    }

    .highlight-wrap {
      position: relative;
    }
  </style>

  <script>
    $('.highlight').each(function (i, e) {
      var $wrap = $('<div>').addClass('highlight-wrap')
      $(e).after($wrap)
      $wrap.append($('<button>').addClass('copy-btn').append('post.copy_button').on('click', function (e) {
        var code = $(this).parent().find('.code').find('.line').map(function (i, e) {
          return $(e).text()
        }).toArray().join('\n')
        var ta = document.createElement('textarea')
        document.body.appendChild(ta)
        ta.style.position = 'absolute'
        ta.style.top = '0px'
        ta.style.left = '0px'
        ta.value = code
        ta.select()
        ta.focus()
        var result = document.execCommand('copy')
        document.body.removeChild(ta)
        
          if(result)$(this).text('post.copy_success')
          else $(this).text('post.copy_failure')
        
        $(this).blur()
      })).on('mouseleave', function (e) {
        var $b = $(this).find('.copy-btn')
        setTimeout(function () {
          $b.text('post.copy_button')
        }, 300)
      }).append(e)
    })
  </script>


<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":300,"hOffset":-15,"vOffset":-15},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body>
</html>
